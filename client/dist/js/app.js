(function(e){function t(t){for(var i,r,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&m.push(s[r][0]),s[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],i=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(i=!1)}i&&(n.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},s={app:0},n=[];function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/webclient/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"02d6":function(e,t,a){"use strict";a("5bf9")},"04e4":function(e,t,a){},"0816":function(e,t,a){},"08cb":function(e,t,a){},"09db":function(e,t,a){},"0b2c":function(e,t,a){"use strict";a("497d")},"0b5f":function(e,t,a){"use strict";a("8a72")},"0e0d":function(e,t,a){"use strict";a("de23")},"0e51":function(e,t,a){},"0e63":function(e,t,a){"use strict";a("ed21")},"0fc2":function(e,t,a){"use strict";a("15ed")},1087:function(e,t,a){},"10b1":function(e,t,a){},"154f":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAEsCAIAAABi1XKVAAAJ0ElEQVR42u3d61MTVwPA4aSbrGxYYsKSCyHKVbx89G/y720/tl5aHcda5SIMIo4hSD/kHYdXLYRkE3bheT7SNJmcpr85u3vObvHJkycFgDz4xRAAggUgWIBgAQgWgGABggUgWACCBQgWgGABCBYgWACCBSBYgGABCBaAYAGCBSBYAIIFCBaAYAEIFiBYAIIFIFiAYAEIFiBYAIIFIFiAYAEIFoBgAYIFIFgAggUIFoBgAQgWIFgAggUgWIBgAQgWgGABggUgWACCBQgWgGABCBYgWACCBSBYgGABCBYgWACCBSBYgGABCBaAYAGCBSBYAIIF3AQlQzC8x48fGwRS9+uvvxoEMyxAsAAEC0CwAMECECwAwQIEC0CwAAQLECwAwQIQLECwAAQLECwAwQIQLECwAAQLQLAAwQIQLADBAq49D1K9Gp6dmXeeqmuGBSBYgGABCBaAYAGCBSBYAIIF5JCFozdRGIZzc3PlcjkMw1Kp9PXr136/3+/3v3z5cnBwcHJyYogQLK5YHMe1Wq1arc7MzPzXa05PTz99+nRwcLC9va1cCBZXIIqipaWlarV64SuLxWIcx3Ect1qt7e3tt2/fGj0EiykJguDOnTvz8/Mj/IvtdjtJkrdv3+7u7hpJBIvJCsNwY2PjnAPAC5XL5eXl5SiK3rx5YzwRLCYljuPV1dVyuTz+WzWbzZmZmZcvXzqrxdWyrOF6iqJofX09lVoNVKvV1dVVA4tgkbIgCNbX14MgSPdtq9Xq3bt3DS+CRZpWV1fDMJzEOy8sLCRJYoQRLFKbBw2zfGFknU4n9bnbJOaYfgmCRQ50Op2Jvn+5XG61WhkfhEkcESNYpCxJkkqlMulPabVaEzrkTGuOGcfxnTt3/B4Ei0yr1+tT+JRisTjCStSpabfbg6GIoshPQrDIrtnZ2anNYrI5AlEUxXE8qOrS0pKfhGCR3enV1E7czM7OZvMk0eLi4tmqZjasCNZNNzc3N7XPKhaLGWxBGIa3b98++5dJX4JAsBj9f9dpftytW7eyNgLNZrNYLJ79S6VSsXBMsMiiUmmqO0N/+SVbP54gCH7aJpMswSKT/y2nW5CsrWxotVo/Pa1WLpc1S7C46cHKmnMO/RqNRpYXjiFYN1G/37/GH3dhrc65NUUQBCZZgkW29Hq9a/xxFx4Pnv8C60gFixs9wzo+Ps7IF6/X6xfeVdU6UsEiWz59+jS1zxo8XCcjX7zRaAzzMutIBYsM2d/fPz09nVocM3JIOHjGz5AvdiZLsMiKk5OTqc16Dg4OMvKtm83m8C+uVCqXej2CxQRN53lcp6en29vbWfi+P+7FSTdwCBaTDdYUjtSy81Dodrv93V6cYRrnwFCwyIq///57ou9/fHz8zz//ZOGb/tdenAtZRypYZMXe3t7h4eHk3v/9+/cZmV4tLi5ednr1rXSDm/whWFy9P//8c0KLpD58+LC1tZWRrznO7VWTJLGOVLDIhJOTk5cvX6a+xOHo6OjVq1cZ+Y7NZnOcx8QWi8Wzt/pDsLhKh4eHr169SvHY7ejo6K+//srOFxz/Yl+tVht+AReCxWTt7e2ldWy4v7//xx9/ZGfzYL1eT+Wsebfb9TsRLDI0z3r69Ok45+BPT0/fvXuXqblVYYitzkNyP9LcKRmC663X6z179qxery8uLl64Q/jHidWbN28ydVeGQqFQrVZTfPbi4uLidFbbIlhc4vBwb2+v2WxWq9W5ubnzVwMcHx9//PhxZ2dnossjRrawsJDiu4Vh2G63371750ciWGTL1tbW1tZWEAS1Wm12drZUKoVhOLgTfK/X6/f7vV5vf38/m50aiKKoVqulfoCZnbX7CBb/5+TkZHd3N6fHQWmdvTorCIKlpaXXr1/7bWSfk+7kxghbnYdkHalgQcoWFhYm9Lhp9yMVLEh/HjS5N3c/UsGC1LTb7XH24gzDbWcEC1I7Hpz0R1hHKliQgrT24lzIjmjBgnFNYjXDTw3WkRpwwYIRxXGc4l6cYZplzAULRmTKg2CRD1EUWW2AYJEPUzt7hWDBWIIgGOfG7QgWXCytVQgjPxeH68rdGkhzQtRqtZIkKZfLgxsHjnPzv5EfO4hgwXkGy5eSJPk2IQrDcHNzc5xmNRqNCW11RrC4oaIoarVa9Xr9x2O3QbN+//330e6NN4W9OAgWN2hW1el05ufnz3/Nw4cPR5hnJUliASeCRTqpajabjUZjmDPiYRhubGy8ePHiUs1qNBrGGcFiXO12+7IX72ZmZtbW1p4/fz7ksWG6z8XhOrGsgWHFcfzo0aNOpzPCUoNKpXL//v0hT6Lbi4NgMdYx4MrKyubm5mWfbPjdPOvevXsXNiuKIk+QR7AYUb1ef/jw4fkn14efZ62vr5/fLHtxECxGdPfu3dXV1RTXQ8VxvL6+fs5Uzl4cBItLi6Lo0aNHk1gMFcfx5ubmT/9Ru922FwfB4nKSJHnw4ME4Z6wubNbGxsZ3f7TVGcHi0trt9vLy8qRnOtVqdW1t7exf7MVBsLicbrc7tadd1Wq1s82yWBTB4hJWVlaazeY0P/Fbswb3ePCfgPNZ6c7/rK2t1Wq16X9urVZbWVmxtB3BYlidTudKajWQyiIvBIu8CsNwZmamUqmUSqWvX78WCoV+v7+/v//THcj1et1uGASLK5AkSZIks7OzP17m63a7vV7v8PDww4cPBwcH39LW7XaNG4LFVEVRtLy8fP7JoDAM5+fn5+fnj46Otre3d3d319bWnO1GsJh2rR48eDD84qlKpbK8vNztdi19Ikcsa7gOgiDY2NgYYamnWiFYTNu9e/cc1iFY5IBFTAgW+XDhYyBAsMgE66cQLPIhiqKVlRXjgGCRdSNfFgTBYtpcFkSwyAeXBREs8sFlQQSLfHBZEMEiH1wWBMHKB5cFQbByw2VBEKx8cFkQBCsfXBYEwcoHlwVBsPLBZUH4jlskZ9fnz59/++034wBmWIBgAQgWgGABggUgWIBgAQgWgGABggUgWADjsZfwanS7XYMAgpUPzWbTIIBDQkCwAAQLQLAAwQIQLADBAgQLQLAABAsQLADBAhAsQLAABAtAsADBAhAsQLAABAtAsADBAhAsgLF5LuEl7OzsGAQQrHx4/fq1QQCHhACCBQgWgGABCBYgWACCBSBYgGABCBaAYAGCBSBYgGABCBaAYAGCBSBYAIIFCBaAYAEIFiBYAIIFIFiAYAEIFoBgAYIFIFgAggUIFoBgAQgWIFgAggUgWIBgAQgWgGABggUgWIBgAQgWgGABggUgWACCBQgWgGABCBYgWACCBSBYgGABCBaAYAGCBSBYAIIFCBaAYAEIFiBYAIIFIFiAYAEIFkChUCgU/gVyaL7C4AzKhQAAAABJRU5ErkJggg=="},"15d2":function(e,t,a){},"15ed":function(e,t,a){},1669:function(e,t,a){"use strict";a("6e2a")},1815:function(e,t,a){},"19d4":function(e,t,a){"use strict";a("9041")},"1afd":function(e,t,a){},"1eb7":function(e,t,a){},"22e9":function(e,t,a){},"235b":function(e,t,a){"use strict";a("6c54")},"238b":function(e,t,a){},2416:function(e,t,a){"use strict";a("c6d1")},2475:function(e,t,a){},"25f2":function(e,t,a){},"268d":function(e,t,a){"use strict";a("756f")},"26e1":function(e,t,a){"use strict";a("2888")},2736:function(e,t,a){},2888:function(e,t,a){},"2b93":function(e,t,a){},"2f44":function(e,t,a){},3010:function(e,t,a){},"313d":function(e,t,a){"use strict";a("dbf0")},3293:function(e,t,a){"use strict";a("6f91")},3308:function(e,t,a){},"37e7":function(e,t,a){},"389c":function(e,t,a){},"3a4c":function(e,t,a){"use strict";a("04e4")},"3b5a":function(e,t,a){},"3bec":function(e,t,a){"use strict";a("e517")},"3cc7":function(e,t,a){"use strict";a("88fc")},"3cfd":function(e,t,a){"use strict";a("6ead")},"3da3":function(e,t,a){"use strict";a("c5a4")},"3e22":function(e,t,a){},"3ebb":function(e,t,a){},"3ed7":function(e,t,a){"use strict";a("2b93")},4082:function(e,t,a){},4179:function(e,t,a){e.exports=a.p+"img/logo.svg"},"42db":function(e,t,a){},"42f0":function(e,t,a){},"43fc":function(e,t,a){},4453:function(e,t,a){},4678:function(e,t,a){var i={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=n(e);return a(t)}function n(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=n,e.exports=s,s.id="4678"},4863:function(e,t,a){"use strict";a("5424")},"497d":function(e,t,a){},"4a4d":function(e,t,a){"use strict";a("ebe1")},"4b04":function(e,t,a){"use strict";a("3ebb")},"4cbf":function(e,t,a){},"4d21":function(e,t,a){},"4d37":function(e,t,a){},"4def":function(e,t,a){"use strict";a("9264")},"4e8b":function(e,t,a){},"4f3e":function(e,t,a){},"50b8":function(e,t,a){"use strict";a("fbc1")},5100:function(e,t,a){},"517e":function(e,t,a){},"52dc":function(e,t,a){"use strict";a("517e")},"52e5":function(e,t,a){},5321:function(e,t,a){},"53c4":function(e,t,a){},5424:function(e,t,a){},"55e1":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("159b"),a("b64b");var i,s=a("a026"),n=a("c1df"),r=a.n(n),o=a("f2f3"),l=a("e94a"),c=a.n(l),u=a("e37d"),d=a("9ebe"),m=a("9b3e"),p=a.n(m),h=null!==(i=Object({NODE_ENV:"production",BASE_URL:"/webclient/"}).VUE_APP_API_URL)&&void 0!==i?i:"";window.__SERVER_CONFIG__&&window.__SERVER_CONFIG__.baseUrl&&(h=window.__SERVER_CONFIG__.baseUrl);var f={baseUrl:h,api:{url:"".concat(h,"/api"),headers:{Accept:"application/json"},version:"_dev mode_"},defaultLang:"fr",currency:{symbol:"€",name:"Euro",iso:"EUR",symbol_intl:"€",decimal_digits:2,rounding:0},auth:{cookie:"Authorization",timeout:12,isCASEnabled:!1},handScanner:{inputLayout:"qwerty"},defaultPaginationLimit:100,beneficiaryTagName:"Bénéficiaire",technicianTagName:"Technicien",billingMode:"partial",degressiveRate:function(e){return.75*(e-1)+1}},v=window.__SERVER_CONFIG__||f,_=p()(v),g=a("5530"),b=(a("d3b7"),a("bc3a")),y=a.n(b),k=(a("ac1f"),a("5319"),a("a78e")),C=a.n(k),w=C.a.withConverter({write:function(e){return encodeURIComponent(e).replace(/%(23|24|26|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)},read:function(e){return e.replace(/\+/g," ").replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}}),$=w,E=y.a.create({baseURL:_.api.url,headers:_.api.headers});E.interceptors.request.use((function(e){var t=Object(g["a"])({},e),a=$.get(_.auth.cookie);return a&&(t.headers.Authorization="Bearer ".concat(a)),t}),(function(e){return Promise.reject(e)}));var x=E,D=a("2f62"),M=(a("d81d"),a("b0c0"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||0===e.length)return[];var i=e.map((function(e){var a=e.id,i=t?t(e):e.name||"N/A";return{value:a,label:i}}));return a&&i.unshift({value:"",label:a}),i}),S=M,L={namespaced:!0,state:{list:[],isFetched:!1,error:null},getters:{options:function(e,t,a){var i=a.i18n,s=i.locale,n=i.translations;return S(e.list,null,n[s]["please-choose"])}},mutations:{init:function(e,t){e.list=t,e.isFetched=!0,e.error=null},setError:function(e,t){e.error=t}},actions:{fetch:function(e){var t=e.state,a=e.commit;t.isFetched||x.get("countries").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))}}},I=a("1da1"),T=a("3835"),A=(a("96cf"),a("7db0"),{namespaced:!0,state:{list:[],isFetched:!1,error:null},getters:{options:function(e,t,a){var i=a.i18n,s=i.locale,n=i.translations;return S(e.list,null,n[s]["please-choose"])},parkName:function(e){return function(t){var a=e.list.find((function(e){return e.id===t}));return a?a.name:null}},firstPark:function(e){var t=Object(T["a"])(e.list,1),a=t[0];return a}},mutations:{init:function(e,t){e.list=t,e.isFetched=!0,e.error=null},setError:function(e,t){e.error=t},reset:function(e){e.list=[],e.isFetched=!1,e.error=null}},actions:{fetch:function(e){var t=arguments;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=e.state,s=e.commit,n=t.length>1&&void 0!==t[1]&&t[1],!i.isFetched){a.next=4;break}return a.abrupt("return",i.list);case 4:return a.prev=4,a.next=7,x.get("parks/list");case 7:r=a.sent.data,s("init",r),a.next=17;break;case 11:if(a.prev=11,a.t0=a["catch"](4),s("setError",a.t0),!n){a.next=16;break}throw a.t0;case 16:r=[];case 17:return a.abrupt("return",r);case 18:case"end":return a.stop()}}),a,null,[[4,11]])})))()},refresh:function(e){var t=e.state,a=e.commit;t.isFetched=!1,x.get("parks/list").then((function(e){var t=e.data;a("init",t)})).catch((function(e){a("setError",e)}))}}}),O={namespaced:!0,state:{list:[],isFetched:!1,error:null},getters:{options:function(e){return S(e.list)},unitStateName:function(e){return function(t){var a=e.list.find((function(e){return e.id===t}));return a?a.name:null}}},mutations:{init:function(e,t){e.list=t,e.isFetched=!0,e.error=null},setError:function(e,t){e.error=t},reset:function(e){e.list=[],e.isFetched=!1,e.error=null}},actions:{fetch:function(e){var t=arguments,a=this;return Object(I["a"])(regeneratorRuntime.mark((function i(){var s,n,r,o,l;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(s=e.state,n=e.dispatch,r=t.length>1&&void 0!==t[1]&&t[1],!s.isFetched){i.next=4;break}return i.abrupt("return",s.list);case 4:return o=!!a.ongoingFetch,o||(a.ongoingFetch=n("internalFetch",!0)),i.prev=6,i.next=9,a.ongoingFetch;case 9:l=i.sent,i.next=17;break;case 12:if(i.prev=12,i.t0=i["catch"](6),!r){i.next=16;break}throw i.t0;case 16:l=[];case 17:return i.prev=17,o||(a.ongoingFetch=null),i.finish(17);case 20:return i.abrupt("return",l);case 21:case"end":return i.stop()}}),i,null,[[6,12,17,20]])})))()},internalFetch:function(e){var t=arguments;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=e.commit,s=t.length>1&&void 0!==t[1]&&t[1],a.prev=2,a.next=5,x.get("unit-states");case 5:n=a.sent.data,i("init",n),a.next=15;break;case 9:if(a.prev=9,a.t0=a["catch"](2),i("setError",a.t0),!s){a.next=14;break}throw a.t0;case 14:n=[];case 15:return a.abrupt("return",n);case 16:case"end":return a.stop()}}),a,null,[[2,9]])})))()},refresh:function(e){var t=e.state,a=e.dispatch,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.isFetched=!1,a("internalFetch",i)}}},j={namespaced:!0,state:{list:[],isFetched:!1,error:null},getters:{options:function(e,t,a){var i=a.i18n,s=i.locale,n=i.translations;return S(e.list,null,n[s]["please-choose"])},categoryName:function(e){return function(t){var a=e.list.find((function(e){return e.id===t}));return a?a.name:null}},subCategoryName:function(e){return function(t){var a=null;return e.list.forEach((function(e){if(!a){var i=e.sub_categories.find((function(e){return e.id===t}));a=i?i.name:null}})),a}}},mutations:{init:function(e,t){e.list=t,e.isFetched=!0,e.error=null},setError:function(e,t){e.error=t}},actions:{fetch:function(e){var t=e.state,a=e.commit;t.isFetched||x.get("categories").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))},refresh:function(e){var t=e.state,a=e.commit;t.isFetched=!1,x.get("categories").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))}}},F={namespaced:!0,state:{list:[],isFetched:!1,error:null},getters:{options:function(e,t,a){var i=a.i18n,s=i.locale,n=i.translations;return S(e.list,(function(e){return e.legal_name}),n[s]["please-choose"])}},mutations:{init:function(e,t){e.list=t,e.isFetched=!0,e.error=null},setError:function(e,t){e.error=t}},actions:{fetch:function(e){var t=e.state,a=e.commit;t.isFetched||x.get("companies").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))},refresh:function(e){var t=e.state,a=e.commit;t.isFetched=!1,x.get("companies").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))}}},q=(a("4de4"),a("caad"),a("2532"),{namespaced:!0,state:{list:[],isFetched:!1,error:null,protected:[_.beneficiaryTagName.toLowerCase(),_.technicianTagName.toLowerCase()]},getters:{options:function(e,t){return S(e.list.filter((function(e){return!t.isProtected(e.name)})))},publicList:function(e,t){return e.list.filter((function(e){return!t.isProtected(e.name)}))},isProtected:function(e){return function(t){return e.protected.includes(t.toLowerCase())}},tagName:function(e){return function(t){var a=e.list.find((function(e){return e.id===t}));return a?a.name:null}}},mutations:{init:function(e,t){e.list=t,e.isFetched=!0,e.error=null},setError:function(e,t){e.error=t}},actions:{fetch:function(e){var t=e.state,a=e.commit;t.isFetched||x.get("tags").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))},refresh:function(e){var t=e.state,a=e.commit;t.isFetched=!1,x.get("tags").then((function(e){var t=e.data;a("init",t.data)})).catch((function(e){a("setError",e)}))}}}),P=function(e){return{id:e.id,groupId:e.group_id,firstName:e.first_name,lastName:e.last_name,pseudo:e.pseudo,email:e.email,locale:e.settings?e.settings.language:"en",restrictedParks:e.restricted_parks}},B=function(e){var t=_.auth,a=t.cookie,i=t.timeout,s={};if(i){var n=60*i*60*1e3,r=new Date((new Date).getTime()+n);s.expires=r}$.set(a,e,s)},R={namespaced:!0,state:{user:null},getters:{isLogged:function(e){return!!e.user},is:function(e){return function(t){if(!e.user)return!1;var a=Array.isArray(t)?t:[t];return a.includes(e.user.groupId)}}},mutations:{setUser:function(e,t){e.user=t},setUserProfile:function(e,t){e.user.firstName=t.first_name,e.user.lastName=t.last_name,e.user.pseudo=t.pseudo,e.user.email=t.email},setLocale:function(e,t){e.user.locale=t}},actions:{fetch:function(e){return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.dispatch,i=e.commit,$.get(_.auth.cookie)){t.next=4;break}return i("setUser",null),t.abrupt("return");case 4:return t.prev=4,t.next=7,x.get("/session");case 7:s=t.sent,n=s.data,i("setUser",P(n)),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](4),401===t.t0.httpCode?a("logout"):console.error("Error:",t.t0.message||t.t0.code);case 15:case"end":return t.stop()}}),t,null,[[4,12]])})))()},login:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=e.dispatch,s=e.commit,a.next=3,x.post("session",t);case 3:n=a.sent,r=n.data,s("setUser",P(r.user)),B(r.token),o=r.user.settings.language.toLowerCase(),window.localStorage.setItem("userLocale",o),i("i18n/setLocale",{locale:o},{root:!0});case 10:case"end":return a.stop()}}),a)})))()},logout:function(e){return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,i=!!_.auth.isCASEnabled,!i){t.next=6;break}return window.location.assign("".concat(_.baseUrl,"/logout")),t.next=6,new Promise((function(e,t){setTimeout(t,5e3)}));case 6:a("setUser",null),a("parks/reset",void 0,{root:!0}),$.remove(_.auth.cookie);case 9:case"end":return t.stop()}}),t)})))()}}};s["default"].use(D["a"]);var U=new D["a"].Store({state:{pageRawTitle:null,pageTitle:"",pageSubTitle:""},mutations:{setPageRawTitle:function(e,t){e.pageRawTitle=t},setPageTitle:function(e,t){e.pageTitle=t,e.pageSubTitle=""},setPageSubTitle:function(e,t){e.pageSubTitle=t}},modules:{countries:L,parks:A,unitStates:O,categories:j,companies:F,tags:q,auth:R}}),N={"hello-pseudo":"Hello {pseudo}!","your-profile":"Your profile","your-settings":"Your settings","logout-quit":"Quit Robert","action-add":"Add","action-edit":"Edit","action-view":"Display details","action-trash":"Trash bin","action-restore":"Restore","action-delete":"Delete","action-enable":"Enable","action-disable":"Disable","action-refresh":"Refresh data",yes:"Yes",no:"No",loading:"Loading...","please-confirm":"Please confirm...","yes-delete":"Yes, move in trash bin","yes-permanently-delete":"Yes, permanently delete","yes-restore":"Oui, restaurer",cancel:"Cancel",close:"Close","copy-to-clipboard":"Copy to clipboard","copied-in-clipboard":"Copied in clipboard!","almost-done":"Almost done...","refresh-page":"Refresh the page","take-control":"Take control","please-choose":"Please choose...","start-typing-to-search":"Start typing to search...","type-at-least-count-chars-to-search":["Type again, at least {count} character to search...","Type again, at least {count} characters to search..."],"empty-state":"There are no records to display at this time.","no-result-found-try-another-search":"No results. Try another search term.","create-select-item-label":"Create a {label}","add-item":"Add a {item}","remove-item":"Remove this {item}","cancel-add-item":"Cancel adding {item}","item-not-found":"{item} not found. Element may have been deleted.",locked:"locked",save:"Save","save-draft":"Save draft",add:"Add",saving:"Saving...",saved:"{entity} saved.","choose-date":"Choose this date","reset-date":"Reset date",actions:"Actions",informations:"Informations","connexion-infos":"Credentials","personnal-infos":"Personnal informations","minimal-infos":"Minimal informations","billing-infos":"Billing informations",documents:"Documents",billing:"Billing","extra-infos":"Extra informations","special-attributes":"Special attributes",pseudo:"Pseudo","email-address-or-pseudo":"E-mail address or Pseudo",password:"Password","first-name":"First name","last-name":"Last name",name:"Name",nickname:"Nickname",company:"Company","legal-name":"Legal name",contact:"Contact","contact-details":"Contact details","other-infos":"Other informations",email:"E-mail",phone:"Phone",address:"Address",street:"Street and Number","postal-code":"Postal code",city:"City",locality:"City",country:"Pays",group:"Group",admin:"Administrator",member:"Member",visitor:"Visitor",owner:"Owner","owner-key":"Owner:","opening-hours":"Opening hours",notes:"Notes",description:"Description",ref:"Ref.",reference:"Reference",park:"Park",prices:"Prices","is-unitary":"Unitary identification?","rental-price":"Rental price","replacement-price":"Replacement price","rent-price":"Rent. price","repl-price":"Repl. price","value-per-day":"{value} / day","serial-number":"Serial n°",quantity:"Stock qty",quantities:"Quantities","quantity-out-of-order":"Out of order qty","remaining-quantity":"Remaining qty",discountable:"Discountable?","is-broken":"Out of order?","is-lost":"Lost?","purchase-date":"Purchase date","material-is-discountable":'The material is "discountable": a discount amount can be applied to this material.',"hidden-on-bill":"Hidden on bill?","material-not-displayed-on-bill":"The material is not displayed on bills.","price-must-be-zero":"the rental price must be 0","all-parks":"All parks combined","all-categories":"All categories","all-sub-categories":"All sub-categories","not-limited":"not limited","open-trash-bin":"Display trash bin","display-not-deleted-items":"Display not deleted items","created-at":"Created at:","updated-at":"Updated at:",units:"Units",state:"State","add-a-picture":"Add a picture","change-the-picture":"Change the picture","remove-the-picture":"Remove the picture","event-details":"Event's details",title:"Title","start-date":"Start Date","end-date":"End Date",location:"Location",duration:"Duration","duration-days":["Duration {duration} day","Duration {duration} days"],confirmed:"Confirmed","not-confirmed":"Not confirmed","is-billable":"Is billable?","event-is-now-billable":"This event is now billable.","is-not-billable-help":'"Loan" Mode: no billing.',"is-billable-help":'"Rent" Mode: billing possible.',"event-not-billable":'This event is defined as "not billable".',"enable-billable-event":"Enable billing for this event","confirm-event":"Confirm event","unconfirm-event":"Set event back on hold","archive-event":"Archive event","unarchive-event":"Unarchive event","delete-event":"Delete event","duplicate-event":"Duplicate event","duplicate-the-event":'Duplicate event "{title}"',"dates-of-duplicated-event":"Dates of new event",print:"Print","print-summary":"Print this summary",open:"Open",in:"In","open-in-openstreetmap":"Search in OpenStreetMap","on-date":"On {date}","from-date-to-date":"from {from} to {to}",or:"or",for:"For",with:"With",into:"into","in-progress":"in progress","show-materials-details":"Show detailed materials list","hide-materials-details":"Hide materials list",bill:"Bill",estimate:"Estimate",estimates:"Estimates","no-bill-help":"No bill for this event yet.","no-estimate-help":"No estimate for this event yet.","warning-no-estimate-before-billing":"Warning, this event does not have any estimate!","warning-event-has-bill":"Warning, this event already have a bill!","estimate-item-help":"Estimate of {date} at {hour}","missing-beneficiary":"Missing beneficiary","position-held":"Position held","not-billable-help":"You can't create a bill (or estimate) for an event without at least one beneficiary.","click-edit-to-create-one":'Click on "Edit" button to add one.',"bill-number-generated-at":"Bill n° {number}, generated on {date}","with-amount-of":"for an amount of {amount}","create-bill-help":"You can create a new bill for the first beneficiary in the list, and give it a discount rate or amount:","create-estimate-help":"You can create an estimate for the first beneficiary in the list, and give it a discount rate or amount:","contact-someone-to-create-bill":"If needed, contact a member of the team and ask them to edit the invoice.","contact-someone-to-create-estimate":"If needed, contact a member of the team and ask them to create an estimate.","previous-bills":"Previous bills",discount:"Discount","without-discount":"Without discount","discount-rate":"{rate} % off","wanted-rate":"Rate in %","wanted-amount":"Wanted amount","create-bill":"Create bill","create-estimate":"Create estimate",download:"Download","download-pdf":"Download PDF file","regenerate-bill-help":"You can regenerate the bill to change discount, or if the event has been modified.","create-new-estimate-help":"You can create another estimate, if the event has changed, or if you want another discount rate.","click-here-to-regenerate-bill":"Click here to regenerate the bill.","create-new-estimate":"Create a new estimate","estimate-created":"Estimate created.","estimate-deleted":"The estimate has been deleted.","bill-created":"Bill created.",total:"Total","total-discountable":"Total discountable","items-count":["{count} item","{count} items"],"used-count":["{count} used","{count} used"],"no-items":"No items","stock-items-count":"{count} in stock","out-of-order-items-count":"{count} out of order","sub-total":"Sub-total","total-amount":"Total amount","total-amount-with-discount":"Total with discount","replacement-total":"Total replacement price",calculate:"Calculate",day:"day","days-count":["{duration} day","{duration} days"],ratio:"ratio","ratio-long":"Ratio",tags:"Tags","add-tags":"Add tags","choose-tags-below":"Choose tags below:","entity-name-tags":'Tags of "{entityName}"',"remove-all-tags":"Remove all tags","remaining-count":"{count} remaining","return-inventory":"Return inventory","grouped-by":"Display grouped by:","not-grouped":"Not grouped","awaited-quantity":"Awaited qty:","actual-quantity":"Actual qty","return-scheduled-on":"Return scheduled on","back-to-calendar":"Back to calendar",inventories:"Inventories","terminate-inventory":"Terminate inventory","warning-terminate-inventory":"Beware, once this inventory terminated, it will no longer be modifiable.","inventory-validation-error":"Some quantities are not valid. Please double-check the list.",event:"Event",user:"User",beneficiary:"Beneficiary",material:"Material",category:"Category","sub-category":"Sub-category",categories:"Categories",parks:"Parks",technician:"Technicien",settings:"Settings","this-feature-is-coming-soon":"This feature implementation is in progress.",french:"Français",english:"English"},V=(a("a15b"),{"page-login":{title:"Login",welcome:"Hello! Who are you?",connexion:"Enter Robert","login-with-cas":"Login with CAS","please-wait":"Authentication, please wait...",bye:"See you !",footer:'Robert2 "Premium" is a non-free version of the free software Robert2. Copying and redistribution of this version is forbidden.',"official-website":"Official website","community-forum":"Community Forum",error:{"bad-infos":"Given infos ar not correct. Please give your e-mail address or pseudo, and your password.","expired-session":"Your session has expired. Please log back in!","not-allowed":"You tried to visit a page with restricted access. Please log in with an account who can access this page."}},"page-profile":{title:"Your profile",help:"If you change your email, pseudo or password, do not forget them before logging-out!","you-are-group":"You are: {group}.","edit-password":"Change your password","password-confirmation":"Password confirmation","password-confirmation-must-match":"Password and its confirmation must be identical.","password-modified":"Your password was modified.",saved:"Your profile was saved."},"page-user-settings":{title:"Your settings",help:'The "duration of a session" is the time allowed before you\'re automatically logged out.',"auth-token-validity-duration":"Max. duration of a session",interface:"Interface",language:"Language",hours:"hours",saved:"Settings saved."},"page-calendar":{title:"Calendar",help:"Click and drag to move timeline.\n      Use mouse wheel to zoom in / out.\n      Hover an event with your mouse to display details about it.\n      Double-click on an empty column to create an event with start date pre-filled.","help-center-view-on-today":"Center calendar on today","help-add-event":"Create a new event","add-event":"New event","confirm-delete":"Move this event in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this event?","confirm-restore":"Do you really want to restore this event?","event-deleted":"The event was deleted.","event-saved":"The event was saved.","loading-event":"Loading event...","help-timeline-event-operations":"Click once to select the event, in order to move, resize or delete it.\n      Double-click on an event to open its preview, and modify its details.","center-on-today":"Center on today","center-on":"Center on","this-event-is-past":"This event is past.","this-event-is-currently-running":"This event is currently running.","this-event-is-confirmed":"This event is confirmed.","this-event-is-not-confirmed":"This event is not confirmed yet!","this-event-is-archived":"This event is archived.","this-event-is-locked":"This event is locked because it's confirmed or its return inventory is done.","this-event-has-missing-materials":"This event has missing materials.","this-event-needs-its-return-inventory":"It's necessary to make the return inventory of this event!","this-event-has-not-returned-materials":"This event has some not-returned materials.","all-events":"All events","event-with-missing-material-only":"Events with missing material only?","display-all-parks":"All parks",caption:{title:"Caption:",archived:"Archived","past-and-ok":"Past, inventory done and OK","past-material-not-returned":"Material not returned!","past-no-inventory":"Past without inventory","past-not-confirmed":"Past and not confirmed","current-confirmed":"Current and confirmed","current-not-confirmed":"Current not confirmed","future-confirmed":"Future and confirmed","future-not-confirmed":"Future not confirmed"}},"page-events":{"help-edit":"","back-to-calendar":"Back to calendar",add:"New event",edit:'Modify event "{pageSubTitle}"',"edit-event":"Modify event","save-and-back-to-calendar":"Save and back to calendar","save-and-continue":"Save and continue",step:"Step","event-informations":"Informations","event-beneficiaries":"Beneficiaries","event-technicians":"Technicians","event-materials":"Materials","event-summary":"Summary","event-confirmation":"Confirmation",saved:"Event saved.","not-saved":"Event has not saved modifications","display-only-selected-materials":"Display event's selected materials only?","display-all-materials-to-add-some":"Display all materials to add some","display-only-event-materials":"Display only event's materials","event-not-confirmed-help":"The event is not confirmed yet. It is subject to change at any time.","event-confirmed-help":"The event is confirmed: its information should no longer change.","event-missing-materials":"Missing materials","event-missing-materials-help":"These are the missing materials for the period of the event, because it is used in another event, the number needed is too high, or there are some out of order. These materials must therefore be added to the park, or rented from another company.","warning-no-material":"Warning: this event is empty, there is no material at the moment!","warning-no-beneficiary":"Warning: this event has no beneficiaries!","beneficiary-billing-help":"Only the first beneficiary in the list will be displayed on the bill.","missing-material-count":"Need {quantity}, missing {missing}!","no-units-available":"No unit available during this event for this material.","problems-on-returned-materials":"Problems on returned materials","return-inventory-not-done-yet":"Materials return inventory hasn't been done yet, or is not finished.","do-or-terminate-return-inventory":"Do or finish the return inventory","view-return-inventory":"View the return inventory in details","not-returned-material-count":["{returned} returned on {out} ! Missing {missing}.","{returned} returned on {out} ! Missing {missing}."],"broken-material-count":["{broken} returned broken !","{broken} returned broken !"]},"page-event-return":{title:'Return of the material of event "{pageSubTitle}"',help:"","this-event-is-not-past":"This event is not finished, so it is not possible to check its return at the moment.","confirm-terminate-title":"Do you really want to terminate this return inventory?","confirm-terminate-text":"Please note that it will no longer be possible to modify it.","confirm-terminate-text-with-broken":'This will update all the "out of order" quantities for the concerned materials, and it will no longer be possible to modify this inventory.',"inventory-done":"Inventory done","some-material-is-missing":"Some materials did not return from this event!","all-material-returned":"Congratulations! All materials were returned for this event.","some-material-came-back-broken":"Some materials came back broken."},"page-users":{title:"Users",help:"You can send an email to an user by clicking on his/her address.","help-edit":'- Group "Administrator" group gives all access rights to user.\n      - Group "Member" allow user to use most parts of Robert application.\n      - Group "Visitor" group gives a limited access to some data.',"action-add":"New user",add:"New user",edit:'Modify user "{pageSubTitle}"',"confirm-delete":"Move this user in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this user?","confirm-restore":"Do you really want to restore this user?",saved:"User saved.","profile-missing-or-deleted":"Profile missing or deleted","parks-access":"Access to material parks","restrict-access-to-parks":"Restrict access to some parks"},"page-beneficiaries":{title:"Beneficiaries",help:"You can send an email to a beneficiary by clicking on his/her address.","action-add":"New beneficiary",add:"New beneficiary",edit:'Modify beneficiary "{pageSubTitle}"',"beneficiary-type":"Beneficiary type",person:"Natural person (individual)",company:"Legal entity (company)","help-edit":'Only first name and last name are mandatory.\n      The "reference" is a customer or member number for your internal management, which will appear on the output sheets, estimates and bills. It must be unique.',"confirm-delete":"Move this beneficiary in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this beneficiary?","confirm-restore":"Do you really want to restore this beneficiary?",saved:"Beneficiary saved."},"page-companies":{title:"Companies",add:"New company",edit:'Modify company "{pageSubTitle}"',"edit-btn":"Modify company","create-new":"Add a new company","help-edit":"The legal name of the company is mandatory.","attached-persons":"People attached to the company",saved:"Company saved."},"page-materials":{title:"Materials",help:"You can choose a park, a category or some tags to filter materials.","action-add":"New material","manage-attributes":"Manage special attributes","display-quantities-at-date":"Display quantities at date...","remaining-quantities-on-date":"Remaining quantities\n      on {date}",add:"New material",edit:'Modify material "{pageSubTitle}"',"help-edit":'Use a short name for the material and use the description field to enter details.\n\n      If you check the box "Unitary identification", you will be able to specify units\n      of this material in the "Units" tab of the material page, after saving this form.\n\n      The material picture must be of type JPG, PNG or WEBP, and cannot exceed 10 MB.',"confirm-delete":"Move this material in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this material?","confirm-restore":"Do you really want to restore this material?",saved:"Material saved.","clear-filters":"Clear filters","print-complete-list":"Print the complete materials list"},"page-materials-view":{title:'Details of material "{pageSubTitle}"',infos:{"click-to-open-image":"Click to open image in a new tab."},documents:{"no-document":"No document yet.","drag-and-drop-files-here":"Drag and drop files here ↓ to add them.","choose-files":"Or click here to choose files to add","send-files":["Send file","Send {count} files"],"click-to-open":"Click to open / download file","confirm-permanently-delete":"Do you really want to permanently delete this document?",saved:"Documents saved.",deleted:"Document deleted."},"booking-periods":{title:"Booking periods","used-units":"Used units","currently-out":"Currently out",done:"Done","expected-to-be-out-on":"Outing planned for {date}","this-material-has-never-been-out-yet":"This material has never been out yet."},"add-unit":"Add a new unit"},"page-material-units":{add:'New Unit for material "{pageSubTitle}"',edit:'Modify unit "{pageSubTitle}"',"confirm-permanently-delete":"Do you really want to permanently delete this unit?",saved:"Unit saved.","help-edit":"The reference is the unique identifier of the unit.\n      Its serial number is optional."},"page-attributes":{title:"Material special attributes",help:"Here you can add fields that allows you to describe your material according to your own criteria.\n      Once created, a special attribute cannot be modified (except for its name).","go-back-to-material":"Back to material",name:"Name of the attribute",type:"Attribute type",unit:"Unit","max-length":"Max. length","type-string":"Text","type-integer":"Integer number","type-float":"Decimal number","type-boolean":"Boolean (Yes/No)","type-date":"Date","no-limit":"No limit","add-attributes":"Add attributes","no-attribute-yet":"No attribute yet.","add-btn":"Add an attribute","limited-to-categories":"Limited to categories","confirm-permanently-delete":"Do you really want to permanently delete this special attribute?\n\n      WARNING: All data related to this special attribute will be deleted DEFINITIVELY!!","second-confirm":{"confirm-permanently-delete":"Sorry to insist, but this operation is IRREVERSIBLE.\n\n        Do you REALLY want to remove this special attribute?"}},"page-categories":{title:"Categories",help:"Manage material's categories and sub-categories.","action-add":"New category","prompt-add":"New category","category-name":"Category name",create:"Create category","prompt-modify":"Add a sub-category","confirm-delete":"Move this category in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this category?","confirm-restore":"Do you really want to restore this category?",saved:"Category saved.",deleted:"Category deleted.","display-materials":"See the material of this category"},"page-subcategories":{add:"Do you really want to delete this category?","prompt-add":'New sub-category of "{categoryName}"',"sub-category-name":"Sub-category name",create:"Create sub-category","prompt-modify":"Modify sub-category","confirm-delete":"Move this sub in trash bin-category?","confirm-permanently-delete":"Do you really want to permanently delete this sub-category?","confirm-restore":"Do you really want to restore this sub-category?",saved:"Sub-category saved.",deleted:"Sub-category deleted.","display-materials":"See the material of this sub-category"},"page-technicians":{title:"Technicians",help:"You can send an email to a technician by clicking on his/her address.","action-add":"New technician",add:"New technician",edit:'Modify technician "{pageSubTitle}"',"help-edit":"Only first name and last name are mandatory.","confirm-delete":"Move this technician in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this technician?","confirm-restore":"Do you really want to restore this technician?",saved:"Technician saved."},"page-parks":{title:"Material parks",help:"You can click on the number of items in the park to display the list.","action-add":"New materials park",add:"New materials park",edit:'Modify park "{pageSubTitle}"',"help-edit":"Only the name of the park is mandatory.","confirm-delete":"Move this park in trash bin? This won't delete materials in this park.","confirm-permanently-delete":"Do you really want to permanently delete this park? WARNING: this will delete all materials of this park!!","confirm-restore":"Do you really want to restore this park?",saved:"Park saved.","total-items":"Totals","display-events-for-park":"See events","display-materials-of-this-park":"See materials list of this park","print-materials-of-this-park":"Print list of this park"},"page-tags":{title:"Tags",help:"Non-modifiables tags are those used by the system.","no-item":"No tag yet.","no-item-in-trash":"No tag in trash bin.","action-add":"New tag","prompt-add":"New tag","tag-name":"Tag name",create:"Create tag",add:"New tag","prompt-modify":"Modify tag","confirm-delete":"Move this tag in trash bin?","confirm-permanently-delete":"Do you really want to permanently delete this tag?","confirm-restore":"Do you really want to restore this tag?",saved:"Tag saved.",deleted:"Tag deleted."},"page-settings":{title:"Application settings","event-summary":{title:"Event summaries",help:"Here you can customize the PDF event summaries","material-list":"Materials list","display-mode":"Display mode","list-display-mode-categories":"Sorted by categories","list-display-mode-sub-categories":"Sorted by sub-categories","list-display-mode-parks":"Sorted by parks","list-display-mode-flat":"Not sorted","custom-text":"Custom text (bottom of page)","custom-text-title":"Text title","custom-text-content":"Text content",saved:"Event summaries settings were successfully saved."},"material-units":{title:"Material units",help:"",states:"States of material units",add:"Add a state","confirm-permanently-delete":"Do you really want to delete this material unit state?"}},"page-estimate":{"confirm-delete":"Do you really want to delete this estimate?"},"page-inventories":{title:"Inventories","title-with-park":'Inventories for the "{park}" park',"title-current":"Current inventory","select-park-intro":"To access the inventories, please select the involved park.","no-parks":"Please add a park before for being able to access the inventory management.",empty:"No inventory has been done for this park at this time.","underway-events-alert-title":"Some events are underway...","underway-events-alert-text":["Some events are underway with material belonging to this park.","Therefore, you will probably not be able to make an exhaustive inventory of all the material in the park.\n","Are you sure you want to start an inventory under such conditions?"].join("\n"),"underway-events-alert-confirm":"Start the inventory anyway","add-park":"Add a park",add:"New inventory for this park","created-at":"Started on",date:"Date",author:"Created by",continue:"Continue"},"page-inventory":{title:"New inventory","title-with-park":'New inventory for the "{park}" park',"no-materials":"There are no materials in the park, please add some to continue the inventory.","add-material":"Add material to the park","back-to-inventories-list":"Back to the list of park's inventories","locked-message":['An inventory started by "{author}" ({email}) on {date} is already in progress for this park.',"It is not possible to create two inventories at the same time for the same park."].join("\n"),"locked-message-no-author":["An inventory started on {date} is already in progress for this park.","It is not possible to create two inventories at the same time for the same park."].join("\n"),"locked-message-unlock-warning":['You can take control of the inventory of this park but this will make it inaccessible to its previous "owner".',"(if he is in the process of filling the inventory when you take control, his changes will NOT be saved)"].join("\n"),"confirm-terminate-title":"Do you really want to terminate this inventory?","confirm-terminate-text":["Besides closing the inventory (and making it uneditable), this action will have the following consequences:\n",'- The "in stock" and "out of order" quantities of the park\'s material will be updated.','- Missing units will be marked as "lost" and will therefore no longer be usable in events.','- The units state and their "out of order" status will be updated.'].join("\n")}}),H={errors:{generic:"Error: {message}","api-unreachable":"Sorry, but Robert2 API is unreachable... Please check your access to network.","not-found":"This record does not exist.",unknown:"Unknown error.",validation:"Please check form informations.","already-exists":"This record already exists.","show-details":"Show error details","details-title":"Details of error","details-intro1":"You can copy and paste the following to get help from the community.","details-intro2":"Please copy it as is, because it's written in markdown to help reading on","details-intro-forum":"the forum","details-intro3":"or on","details-intro-not-detailed":"To get more details about the error, you can modify the parameter `displayErrorDetails` to 'true' in file 'src/App/Config/settings.json'.","details-request":"API request:","details-message":"Error message","details-file":"File:","details-stacktrace":"Stack trace:",critical:["A critical error has occured, please refresh the page.","If the problem persists, please contact an administrator."].join("\n"),"file-type-not-allowed":"Type '{type}' not supported.","file-size-exceeded":"File too large. Maximum {max}.","file-already-exists":"This file already exists in the list."}},z=Object(g["a"])(Object(g["a"])(Object(g["a"])({},N),V),H),Q={"hello-pseudo":"Bonjour {pseudo} !","your-profile":"Votre profil","your-settings":"Vos paramètres","logout-quit":"Quitter Robert","action-add":"Ajouter","action-edit":"Modifier","action-view":"Afficher en détail","action-trash":"Corbeille","action-restore":"Restaurer","action-delete":"Supprimer","action-enable":"Activer","action-disable":"Désactiver","action-refresh":"Rafraîchir les données",yes:"Oui",no:"Non",loading:"Chargement en cours...","please-confirm":"Veuillez confirmer...","yes-delete":"Oui, mettre à la corbeille","yes-permanently-delete":"Oui, supprimer définitivement","yes-restore":"Oui, restaurer",cancel:"Annuler",close:"Fermer","copy-to-clipboard":"Copier dans le presse-papier","copied-in-clipboard":"Copié dans le presse-papier !","almost-done":"Presque terminé...","refresh-page":"Actualiser la page","take-control":"Prendre la main","please-choose":"Veuillez choisir...","start-typing-to-search":"Commencez à écrire pour rechercher...","type-at-least-count-chars-to-search":["Entrez encore au moins {count} lettre pour rechercher...","Entrez encore au moins {count} lettres pour rechercher..."],"empty-state":"Il n'y a aucun enregistrement à afficher pour le moment.","no-result-found-try-another-search":"Aucun résultat. Essayez avec une autre recherche.","create-select-item-label":"Créer un {label}","add-item":"Ajouter un {item}","remove-item":"Enlever ce {item}","cancel-add-item":"Annuler l'ajout de {item}","item-not-found":"{item} introuvable. Peut-être a-t-il été supprimé ?",locked:"verrouillé",save:"Sauvegarder","save-draft":"Sauvegarder le brouillon",add:"Ajouter",saving:"Sauvegarde...",saved:"{entity} sauvegardé.","choose-date":"Choisir cette date","reset-date":"Réinitialiser la date",actions:"Actions",informations:"Informations","connexion-infos":"Informations de connexion","personnal-infos":"Informations personnelles","minimal-infos":"Informations minimales","extra-infos":"Informations supplémentaires","billing-infos":"Informations de facturation",documents:"Documents",billing:"Facturation","special-attributes":"Caractéristiques spéciales",pseudo:"Pseudo","email-address-or-pseudo":"Adresse e-mail ou Pseudo",password:"Mot de passe","first-name":"Prénom","last-name":"Nom",name:"Nom",nickname:"Surnom",company:"Société","legal-name":"Raison sociale",contact:"Contact","contact-details":"Coordonnées","other-infos":"Autres informations",email:"E-mail",phone:"Téléphone",address:"Adresse",street:"Rue et N°","postal-code":"Code postal",city:"Ville",locality:"Ville",country:"Pays",group:"Groupe",admin:"Administrateur",member:"Membre",visitor:"Visiteur",owner:"Propriétaire","owner-key":"Propriétaire :","opening-hours":"Horaires d'ouverture",notes:"Notes",description:"Description",ref:"Réf.",reference:"Référence",park:"Parc",prices:"Tarifs","is-unitary":"Identification unitaire ?","rental-price":"Tarif location","replacement-price":"Prix de remplacement","rent-price":"Tarif loc.","repl-price":"Val. rempl.","value-per-day":"{value} / jour","serial-number":"N° de série",quantity:"Qté stock",quantities:"Quantités","quantity-out-of-order":"Qté en panne","remaining-quantity":"Qté restante",discountable:"Remisable ?","is-broken":"En panne ?","is-lost":"Perdu ?","purchase-date":"Date d'achat","material-is-discountable":"Le matériel est « remisable » : une remise peut être appliquée sur ce matériel.","hidden-on-bill":"Caché sur la facture ?","material-not-displayed-on-bill":"Le matériel n'est pas affiché sur les factures.","price-must-be-zero":"le tarif de location doit être égal à 0","all-parks":"Tous parcs confondus","all-categories":"Toutes catégories","all-sub-categories":"Toutes sous-catégories","not-limited":"non limité","open-trash-bin":"Afficher la corbeille","display-not-deleted-items":"Afficher les enregistrements non supprimés","created-at":"Créé le :","updated-at":"Modifié le :",units:"Unités",state:"État","add-a-picture":"Ajouter une photo","change-the-picture":"Changer la photo","remove-the-picture":"Supprimer la photo","event-details":"Détails de l'événement",title:"Titre","start-date":"Date de début","end-date":"Date de fin",location:"Lieu",duration:"Durée","duration-days":["Durée {duration} jour","Durée {duration} jours"],confirmed:"Confirmé","not-confirmed":"Non confirmé","is-billable":"Est facturable ?","event-is-now-billable":"Cet événement est maintenant facturable.","is-not-billable-help":"Mode « prêt » : pas de facturation.","is-billable-help":"Mode « location » : facturation possible.","event-not-billable":"Cet événement est défini comme « non facturable ».","enable-billable-event":"Activer la facturation pour cet événement","confirm-event":"Confirmer l'événement","unconfirm-event":"Remettre l'événement en attente","archive-event":"Archiver l'événement","unarchive-event":"Désarchiver l'événement","delete-event":"Supprimer l'événement","duplicate-event":"Dupliquer l'événement","duplicate-the-event":"Dupliquer l'événement « {title} »","dates-of-duplicated-event":"Dates du nouvel événement",print:"Imprimer","print-summary":"Imprimer ce récapitulatif",open:"Ouvrir",in:"À","open-in-openstreetmap":"Rechercher dans OpenStreetMap","on-date":"Le {date}","from-date-to-date":"du {from} au {to}",or:"ou",for:"Pour",with:"Avec",into:"dans","in-progress":"en cours","show-materials-details":"Afficher la liste détaillée du matériel","hide-materials-details":"Cacher la liste du matériel",bill:"Facture",estimate:"Devis",estimates:"Devis","no-bill-help":"Cet événement n'a aucune facture pour le moment.","no-estimate-help":"Cet événement n'a aucun devis pour le moment.","estimate-item-help":"Devis du {date} à {hour}","warning-no-estimate-before-billing":"Attention, cet événement n'a pas eu de devis !","warning-event-has-bill":"Attention, cet événement a déjà une facture !","missing-beneficiary":"Bénéficiaire manquant","position-held":"Poste occupé","not-billable-help":"Vous ne pouvez pas créer de devis ou facture pour un événement qui n'a pas encore de bénéficiaire.","click-edit-to-create-one":"Cliquez sur le bouton « Modifier » pour en ajouter un.","bill-number-generated-at":"Facture n° {number}, générée le {date}","with-amount-of":"pour un montant de {amount}","create-bill-help":"Vous pouvez créer une facture au nom du premier bénéficiaire de la liste, en utilisant une remise (taux ou montant) :","create-estimate-help":"Vous pouvez créer un devis au nom du premier bénéficiaire de la liste, en utilisant une remise (taux ou montant) :","contact-someone-to-create-bill":"Si besoin, contactez un membre de l'équipe pour lui demander d'éditer la facture.","contact-someone-to-create-estimate":"Si besoin, contactez un membre de l'équipe pour lui demander d'éditer un devis.","previous-bills":"Anciennes factures",discount:"Remise","without-discount":"sans remise","discount-rate":"remise {rate} %","wanted-rate":"Taux en %","wanted-amount":"Montant souhaité","create-bill":"Créer la facture","create-estimate":"Créer un devis",download:"Télécharger","download-pdf":"Télécharger au format PDF","regenerate-bill-help":"Vous pouvez re-générer la facture pour en changer la remise, ou si l'événement a été modifié.","create-new-estimate-help":"Vous pouvez créer un autre devis si l'événement a été modifié, ou si vous voulez une remise différente.","click-here-to-regenerate-bill":"Cliquez ici pour refaire une facture.","create-new-estimate":"Créer un nouveau devis","estimate-created":"Le devis a bien été créé.","estimate-deleted":"Le devis a été supprimé.","bill-created":"La facture a bien été créée.",total:"Total","total-discountable":"Total remisable","items-count":["{count} article","{count} articles"],"used-count":["{count} utilisé","{count} utilisés"],"no-items":"Aucun article","stock-items-count":"{count} en stock","out-of-order-items-count":"{count} en panne","sub-total":"Sous-total","total-amount":"Montant total","total-amount-with-discount":"Total après remise","replacement-total":"Valeur de remplacement totale",calculate:"Calculer",day:"jour","days-count":["{duration} jour","{duration} jours"],ratio:"coef.","ratio-long":"Coefficient",tags:"Étiquettes","add-tags":"Ajouter des étiquettes","choose-tags-below":"Choisissez les étiquettes ci-dessous :","entity-name-tags":"Étiquettes de « {entityName} »","remove-all-tags":"Enlever tous les tags","remaining-count":"reste {count}","return-inventory":"Inventaire de retour","grouped-by":"Voir groupé par :","not-grouped":"Non groupé","awaited-quantity":"Qté attendue :","actual-quantity":"Qté effective","return-scheduled-on":"Retour prévu le","back-to-calendar":"Retour au calendrier",inventories:"Inventaires","terminate-inventory":"Terminer l'inventaire","warning-terminate-inventory":"Attention, une fois cet inventaire terminé, il ne sera plus modifiable.","inventory-validation-error":"Certaines quantités ne sont pas correctes. Veuillez vérifier à nouveau la liste.",event:"Événement",user:"Utilisateur",beneficiary:"Bénéficiaire",material:"Matériel",category:"Catégorie","sub-category":"Sous-catégorie",categories:"Catégories",parks:"Parcs",technician:"Technicien",settings:"Paramètres","this-feature-is-coming-soon":"Cette fonctionnalité est en cours de développement.",french:"Français",english:"English"},G={"page-login":{title:"Connexion",welcome:"Bonjour ! Qui êtes vous ?",connexion:"Connexion","login-with-cas":"Connexion via CAS","please-wait":"Authentification, merci de patienter...",bye:"À bientôt !",footer:"Robert2 « Premium » est une version non-libre du logiciel libre Robert2. La copie et la redistribution de cette version sont interdites.","official-website":"Site web officiel","community-forum":"Forum de la communauté",error:{"bad-infos":"Les informations fournies sont incorrectes. Utilisez votre adresse e-mail ou votre pseudo, et votre mot de passe.","expired-session":"Votre session a expiré. Merci de vous reconnecter !","not-allowed":"Vous avez essayé d'accéder à une page dont l'accès vous est interdit. Merci de vous connecter avec un compte qui y a accès."}},"page-profile":{title:"Votre profil",help:"Si vous modifiez votre email, votre pseudo ou votre mot de passe, ne les oubliez pas avant de vous déconnecter !","you-are-group":"Vous êtes : {group}.","edit-password":"Modifier votre mot de passe","password-confirmation":"Confirmation du mot passe","password-confirmation-must-match":"Le mot de passe et sa confirmation doivent être identiques.","password-modified":"Votre mot de passe a bien été modifié.",saved:"Votre profil a bien été sauvegardé."},"page-user-settings":{title:"Vos paramètres",help:"La « durée d'une session » est le temps imparti avant votre déconnexion automatique de l'application.","auth-token-validity-duration":"Durée max. d'une session",interface:"Interface",language:"Langue",hours:"heures",saved:"Paramètres sauvegardés."},"page-calendar":{title:"Calendrier",help:"Cliquez-glissez pour déplacer la frise temporelle.\n      Utilisez la molette pour zoomer / dézoomer.\n      Survolez un événement avec la souris pour en voir les détails.\n      Double-cliquez sur une colonne vide pour créer un événement avec la date de départ pré-remplie.","help-center-view-on-today":"Centrer le calendrier sur aujourd'hui","help-add-event":"Créer un nouvel événement","add-event":"Nouvel événement","confirm-delete":"Mettre cet événement à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cet événement ?","confirm-restore":"Voulez-vous vraiment restaurer cet événement ?","event-deleted":"L'événement a bien été supprimé.","event-saved":"L'événement a bien été sauvegardé.","loading-event":"Chargement de l'événement...","help-timeline-event-operations":"Cliquez une fois pour sélectionner l'événement, afin de le déplacer, le redimensionner ou le supprimer.\n      Double-cliquez sur l'événement pour en ouvrir l'aperçu, et en modifier les détails.","center-on-today":"Centrer sur aujourd'hui","center-on":"Centrer sur le","this-event-is-past":"Cet événement est passé.","this-event-is-currently-running":"Cet événement se déroule en ce moment.","this-event-is-confirmed":"Cet événement est confirmé.","this-event-is-not-confirmed":"Cet événement n'est pas encore confirmé !","this-event-is-archived":"Cet événement est archivé.","this-event-is-locked":"Cet événement est verrouillé parce qu'il est confirmé ou que son inventaire de retour a été effectué.","this-event-has-missing-materials":"Cet événement a du matériel manquant.","this-event-needs-its-return-inventory":"Il faut faire l'inventaire de retour de cet événement !","this-event-has-not-returned-materials":"Cet événement a du matériel qui n'a pas été retourné.","all-events":"Tous les événements","event-with-missing-material-only":"Événements en manque de matériel uniquement ?","display-all-parks":"Tous les parcs",caption:{title:"Légende :",archived:"Archivé","past-and-ok":"Passé, inventaire fait et OK","past-material-not-returned":"Matériel non retourné !","past-no-inventory":"Passé sans inventaire","past-not-confirmed":"Passé et non confirmé","current-confirmed":"Actuel et confirmé","current-not-confirmed":"Actuel non confirmé","future-confirmed":"Futur et confirmé","future-not-confirmed":"Futur non confirmé"}},"page-events":{"help-edit":"","back-to-calendar":"Retour au calendrier",add:"Nouvel événement",edit:"Modifier l'événement « {pageSubTitle} »","edit-event":"Modifier l'événement","save-and-back-to-calendar":"Sauvegarder et retour au calendrier","save-and-continue":"Sauvegarder et continuer",step:"Étape","event-informations":"Informations","event-beneficiaries":"Bénéficiaires","event-technicians":"Techniciens","event-materials":"Matériel","event-summary":"Récapitulatif","event-confirmation":"Confirmation",saved:"Événement sauvegardé.","not-saved":"L'événement comporte des modifications non sauvegardées","display-only-selected-materials":"Afficher uniquement le matériel de l'événement ?","display-all-materials-to-add-some":"Afficher tout le matériel pour en ajouter","display-only-event-materials":"Afficher uniquement le matériel de l'événement","event-not-confirmed-help":"L'événement n'est pas encore confirmé, il est susceptible de changer à tout moment.","event-confirmed-help":"L'événement est confirmé : Ses informations ne devraient plus changer.","event-missing-materials":"Matériel manquant","event-missing-materials-help":"Il s'agit du matériel manquant pour la période de l'événement, car il est utilisé dans un autre événement, le nombre voulu est trop important, ou quelques uns sont en panne. Ce matériel doit donc être ajouté au parc, ou bien loué auprès d'une autre société.","warning-no-material":"Attention, cet événement est vide, il ne contient aucun matériel pour le moment !","warning-no-beneficiary":"Attention, cet événement n'a aucun bénéficiaire !","beneficiary-billing-help":"Seul le premier bénéficiaire de la liste apparaîtra sur la facture.","missing-material-count":"Besoin de {quantity}, il en manque {missing} !","no-units-available":"Aucune unité disponible pendant cet événement pour ce matériel.","problems-on-returned-materials":"Problèmes sur le matériel retourné","return-inventory-not-done-yet":"L'inventaire du retour de matériel n'a pas été fait, ou n'est pas encore terminé.","do-or-terminate-return-inventory":"Faire ou terminer l'inventaire de retour du matériel","view-return-inventory":"Voir l'inventaire de retour en détail","not-returned-material-count":["{returned} retourné sur {out} ! Il en manque {missing}.","{returned} retournés sur {out} ! Il en manque {missing}."],"broken-material-count":["{broken} revenu en panne !","{broken} revenus en panne !"]},"page-event-return":{title:"Retour du matériel de l'événement « {pageSubTitle} »",help:"","this-event-is-not-past":"Cet événement n'est pas terminé, il n'est donc pas possible de vérifier son retour pour le moment.","confirm-terminate-title":"Voulez-vous vraiment terminer cet inventaire de retour ?","confirm-terminate-text":"Veuillez noter qu'il ne sera plus possible de le modifier.","confirm-terminate-text-with-broken":"Ceci aura pour effet de mettre à jour toutes les quantités « en panne » du matériel concerné, et il ne sera plus possible de modifier cet inventaire.","inventory-done":"Inventaire terminé","some-material-is-missing":"Du matériel n'est pas revenu de cet événement !","all-material-returned":"Félicitations ! Tout le matériel a bien été retourné pour cet événement.","some-material-came-back-broken":"Du matériel est revenu en panne."},"page-users":{title:"Utilisateurs",help:"Vous pouvez envoyer un email à un utilisateur en cliquant sur son adresse.","help-edit":"- Le groupe « Administrateur » donne tous les droits à l'utilisateur.\n      - Le groupe « Membre » permet à l'utilisateur d'utiliser la plupart des fonctions de Robert.\n      - Le groupe « Visiteur » donne un accès limité à certaines données.","action-add":"Nouvel utilisateur",add:"Nouvel utilisateur",edit:"Modifier l'utilisateur « {pageSubTitle} »","confirm-delete":"Mettre cet utilisateur à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cet utilisateur ?","confirm-restore":"Voulez-vous vraiment restaurer cet utilisateur ?",saved:"Utilisateur sauvegardé.","profile-missing-or-deleted":"Profil manquant ou supprimé","parks-access":"Accès aux parcs de matériel","restrict-access-to-parks":"Restreindre l'accès à certains parcs"},"page-beneficiaries":{title:"Bénéficiaires",help:"Vous pouvez envoyer un email à un bénéficiaire en cliquant sur son adresse.","action-add":"Nouveau bénéficiaire",add:"Nouveau bénéficiaire",edit:"Modifier le bénéficiaire « {pageSubTitle} »","beneficiary-type":"Type de bénéficiaire",person:"Personne physique (individu)",company:"Personne morale (entreprise)","help-edit":"Seuls le nom et le prénom de la personne sont obligatoires.\n      La « référence » est un numéro client ou adhérent pour votre gestion interne, qui apparaîtra sur les fiches de sorties, les devis et les factures. Il doit être unique.","confirm-delete":"Mettre ce bénéficiaire à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement ce bénéficiaire ?","confirm-restore":"Voulez-vous vraiment restaurer ce bénéficiaire ?",saved:"Bénéficiaire sauvegardé."},"page-companies":{title:"Sociétés",add:"Nouvelle société",edit:"Modifier la société « {pageSubTitle} »","edit-btn":"Modifier la société","create-new":"Ajouter une nouvelle société","help-edit":"La raison sociale (nom de la société) est obligatoire.","attached-persons":"Personnes associées à la société",saved:"Société sauvegardée."},"page-materials":{title:"Matériel",help:"Vous pouvez choisir un parc, une catégorie ou des étiquettes pour filtrer le matériel.","action-add":"Nouveau matériel","manage-attributes":"Gérer les caractéristiques spéciales","display-quantities-at-date":"Afficher les quantités à date...","remaining-quantities-on-date":"Quantités restantes\n      le {date}",add:"Nouveau matériel",edit:"Modifier le matériel « {pageSubTitle} »","help-edit":"Utilisez un nom assez court pour le matériel, et la description pour entrer dans les détails.\n\n      Si vous cochez la case « identification unitaire », vous aurez la possibilité de spécifier des\n      unités de ce matériel dans l'onglet « unités » de la page du matériel, après avoir sauvegardé\n      le présent formulaire.\n\n      La photo du matériel doit être au format JPG, PNG ou WEBP, et ne doit pas dépasser 10 Mo.","confirm-delete":"Mettre ce matériel à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement ce matériel ?","confirm-restore":"Voulez-vous vraiment restaurer ce matériel ?",saved:"Matériel sauvegardé.","clear-filters":"Réinitialiser les filtres","print-complete-list":"Imprimer la liste complète du matériel"},"page-materials-view":{title:"Détails du matériel « {pageSubTitle} »",infos:{"click-to-open-image":"Cliquez pour ouvrir l'image en grand dans un nouvel onglet."},documents:{"no-document":"Aucun document pour le moment.","drag-and-drop-files-here":"Glissez-déposez des fichiers ici ↓ pour les ajouter.","choose-files":"Ou cliquez ici pour choisir des fichiers à ajouter","send-files":["Envoyer le fichier","Envoyer {count} fichiers"],"click-to-open":"Cliquez pour ouvrir / télécharger le fichier","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement ce document ?",saved:"Documents sauvegardés.",deleted:"Document supprimé."},"booking-periods":{title:"Périodes de réservation","used-units":"Unités utilisées","currently-out":"Actuellement sorti",done:"Terminé","expected-to-be-out-on":"Sortie prévue le {date}","this-material-has-never-been-out-yet":"Ce matériel n'est encore jamais sorti."},"add-unit":"Ajouter une unité"},"page-material-units":{add:"Nouvelle unité pour le matériel « {pageSubTitle} »",edit:"Modifier l'unité « {pageSubTitle} »","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cette unité ?",saved:"Unité sauvegardée.","help-edit":"La référence est l'identifiant unique de l'unité.\n      Son numéro de série est facultatif."},"page-attributes":{title:"Caractéristiques spéciales du matériel",help:"Ici vous pouvez ajouter les champs qui permettent de décrire votre matériel selon vos propres critères.\n      Une fois créée, une caractéristique spéciale ne pourra plus être modifiée (sauf son nom).","go-back-to-material":"Retourner au matériel",name:"Nom de la caractéristique",type:"Type de donnée",unit:"Unité","max-length":"Taille max.","type-string":"Texte","type-integer":"Nombre entier","type-float":"Nombre décimal","type-boolean":"Booléen (Oui / Non)","type-date":"Date","no-limit":"Sans limite","add-attributes":"Ajouter des caractéristiques","no-attribute-yet":"Aucune caractéristique spéciale pour le moment.","add-btn":"Ajouter une caractéristique","limited-to-categories":"Limitée aux catégories","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cette caractéristique spéciale ?\n\n      ATTENTION : Toutes les données relative à cette caractéristique spéciale seront supprimées DÉFINITIVEMENT !!","second-confirm":{"confirm-permanently-delete":"Désolé d'insister, mais cette opération IRRÉVERSIBLE.\n\n        Voulez-vous VRAIMENT supprimer cette caractéristique spéciale ?"}},"page-categories":{title:"Catégories",help:"Gestion des catégories et sous-catégories de matériel.","action-add":"Nouvelle catégorie","prompt-add":"Nouvelle catégorie","category-name":"Nom de la catégorie",create:"Créer la catégorie","prompt-modify":"Modifier la catégorie","confirm-delete":"Mettre cette catégorie à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cette catégorie ?","confirm-restore":"Voulez-vous vraiment restaurer cette catégorie ?",saved:"Catégorie sauvegardée.",deleted:"Catégorie supprimée.","display-materials":"Voir le matériel de la catégorie"},"page-subcategories":{add:"Ajouter une sous-catégorie","prompt-add":"Nouvelle sous-catégorie de « {categoryName} »","sub-category-name":"Nom de la sous-catégorie",create:"Créer la sous-catégorie","prompt-modify":"Modifier la sous-catégorie","confirm-delete":"Mettre cette sous-catégorie à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cette sous-catégorie ?","confirm-restore":"Voulez-vous vraiment restaurer cette sous-catégorie ?",saved:"Sous-catégorie sauvegardée.",deleted:"Sous-catégorie supprimée.","display-materials":"Voir le matériel de la sous-catégorie"},"page-technicians":{title:"Techniciens",help:"Vous pouvez envoyer un email à un technicien en cliquant sur son adresse.","action-add":"Nouveau technicien",add:"Nouveau technicien",edit:"Modifier le technicien « {pageSubTitle} »","help-edit":"Seuls le nom et le prénom de la personne sont obligatoires.","confirm-delete":"Mettre ce technicien à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement ce technicien ?","confirm-restore":"Voulez-vous vraiment restaurer ce technicien ?",saved:"Technicien sauvegardé."},"page-parks":{title:"Parcs de matériel",help:"Vous pouvez cliquer sur le nombre d'articles que contient le parc pour en afficher la liste.","action-add":"Nouveau parc de matériel",add:"Nouveau parc de matériel",edit:"Modifier le parc « {pageSubTitle} »","help-edit":"Seul le nom du parc est obligatoire.","confirm-delete":"Mettre ce parc à la corbeille ? Cela ne supprimera pas le matériel qu'il contient.","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement ce parc ? ATTENTION, cela supprimera tout le matériel contenu dans ce parc !!","confirm-restore":"Voulez-vous vraiment restaurer ce parc ?",saved:"Parc sauvegardé.","total-items":"Totaux","display-events-for-park":"Voir les événements","display-materials-of-this-park":"Voir le matériel de ce parc","print-materials-of-this-park":"Imprimer la liste de ce parc"},"page-tags":{title:"Étiquettes",help:"Les étiquettes non modifiables sont celles utilisées par le système.","no-item":"Aucune étiquette.","no-item-in-trash":"Aucune étiquette dans la corbeille.","action-add":"Nouvelle étiquette","prompt-add":"Nouvelle étiquette","tag-name":"Nom de l'étiquette",create:"Créer l'étiquette",add:"Nouvelle étiquette","prompt-modify":"Modifier l'étiquette","confirm-delete":"Mettre cette étiquette à la corbeille ?","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cette étiquette ?","confirm-restore":"Voulez-vous vraiment restaurer cette étiquette ?",saved:"Étiquette sauvegardée.",deleted:"Étiquette supprimée."},"page-settings":{title:"Paramètres de l'application","event-summary":{title:"Fiches de sortie",help:"Ici, vous pouvez personnaliser les fiches de sortie des événements.","material-list":"Liste du matériel","display-mode":"Mode de présentation","list-display-mode-categories":"Triée par catégories","list-display-mode-sub-categories":"Triée par sous-catégories","list-display-mode-parks":"Triée par parcs","list-display-mode-flat":"Liste non-triée","custom-text":"Texte personnalisé (bas de page)","custom-text-title":"Titre du texte","custom-text-content":"Contenu du texte",saved:"Les paramètres des fiches de sortie ont bien été sauvegardés."},"material-units":{title:"Unités de matériel",help:"",states:"États des unités de matériel",add:"Ajouter un état","confirm-permanently-delete":"Voulez-vous vraiment supprimer définitivement cet état d'unité ?"}},"page-estimate":{"confirm-delete":"Voulez-vous vraiment supprimer ce devis ?"},"page-inventories":{title:"Inventaires","title-with-park":"Inventaires du parc « {park} »","title-current":"Inventaire en cours","select-park-intro":"Pour pouvoir accèder aux inventaires, veuillez sélectionner le parc concerné.","no-parks":"Veuillez ajouter un parc avant de pouvoir accèder à la gestion des inventaires.",empty:"Aucun inventaire n'a été effectué pour ce parc pour le moment.","underway-events-alert-title":"Des événements sont en cours...","underway-events-alert-text":["Des événements sont en cours avec du matériel appartenant à ce parc.","Vous ne pourrez donc sans doute pas effectuer un inventaire exhaustif de tout le matériel du parc.\n","Étes-vous sûr de vouloir commencer un inventaire dans ces conditions ?"].join("\n"),"underway-events-alert-confirm":"Commencer l'inventaire malgré tout","add-park":"Ajouter un parc",add:"Nouvel inventaire pour ce parc","created-at":"Commencé le",date:"Date",author:"Créé par",continue:"Continuer"},"page-inventory":{title:"Nouvel inventaire","title-with-park":"Nouvel inventaire pour le parc « {park} »","no-materials":"Le parc ne contient aucun matériel, veuillez en ajouter pour poursuivre l'inventaire.","add-material":"Ajouter du matériel dans le parc","back-to-inventories-list":"Retour à la liste des inventaires du parc","locked-message":["Un inventaire débuté par « {author} » ({email}) le {date} est déjà en cours pour ce parc.","Il n'est pas possible de créer deux inventaires en même temps pour le même parc."].join("\n"),"locked-message-no-author":["Un inventaire débuté le {date} est déjà en cours pour ce parc.","Il n'est pas possible de créer deux inventaires en même temps pour le même parc."].join("\n"),"locked-message-unlock-warning":["Vous pouvez prendre la main sur l'inventaire de ce parc, mais ceci aura pour effet de le rendre inaccessible par son précédent « propriétaire ».","(si celui-ci est en cours de remplissage de l'inventaire au moment où vous prenez la main, ses modifications ne pourront PAS être sauvegardées)"].join("\n"),"confirm-terminate-title":"Voulez-vous vraiment terminer cet inventaire ?","confirm-terminate-text":["En plus de clôturer l'inventaire (et donc le rendre non modifiable), cette action aura les conséquences suivantes :\n","- Les quantités « en stock » et « en panne » des matériels du parc seront mises à jour.","- Les unités absentes seront marquées comme « perdues » et ne seront donc plus utilisables dans les événements (et inversement pour les quantités « retrouvées »).","- L'état des unités et leur statut « en panne », ou non, sera mis à jour."].join("\n")}},Y={errors:{generic:"Erreur : {message}","api-unreachable":"Désolé, mais l'API de Robert2 est inaccessible... Veuillez vérifier votre accès au réseau.","not-found":"Cet enregistrement n'existe pas.",validation:"Veuillez vérifier les informations du formulaire.",unknown:"Erreur inconnue.","already-exists":"Cet enregistrement existe déjà.","show-details":"Voir le détail de l'erreur","details-title":"Détails de l'erreur","details-intro1":"Vous pouvez copier ce qui suit, pour obtenir de l'aide de la part de la communauté.","details-intro2":"Merci de le copier tel quel, car c'est écrit en markdown pour faciliter la lecture sur","details-intro-forum":"le forum","details-intro3":"ou sur","details-intro-not-detailed":"Pour obtenir plus de détails sur l'erreur, vous pouvez modifier le paramètre `displayErrorDetails` à 'true' dans le fichier 'src/App/Config/settings.json'.","details-request":"Requête API :","details-message":"Message de l'erreur","details-file":"Fichier :","details-stacktrace":"Trace de la pile :",critical:["Une erreur s'est produite, veuillez actualiser la page.","Si le problème persiste, veuillez contacter un administrateur."].join("\n"),"file-type-not-allowed":"Le type '{type}' n'est pas pris en charge.","file-size-exceeded":"Fichier trop gros. Maximum {max}.","file-already-exists":"Ce fichier est déjà présent dans la liste."}},W=Object(g["a"])(Object(g["a"])(Object(g["a"])({},Q),G),Y),K={en:z,fr:W},X={count:"Enregistrements {from} à {to} sur {count}|{count} enregistrements|Un enregistrement",first:"Première",last:"Dernière",filter:"Filtre :",filterPlaceholder:"Rechercher un nom...",limit:"Enregistrements :",page:"Page :",noResults:"Aucun enregistrement trouvé.",filterBy:"Filtrer par {column}",loading:"Chargement...",defaultOption:"Sélection {column}",columns:"Col."},Z={count:"Showing {from} to {to} of {count} records|{count} records|One record",first:"First",last:"Last",filter:"Filter:",filterPlaceholder:"Search a name...",limit:"Records:",page:"Page:",noResults:"No matching records",filterBy:"Filter by {column}",loading:"Loading...",defaultOption:"Select {column}",columns:"Col."},J={fr:X,en:Z},ee=(a("99af"),a("8c4f")),te="Robert2",ae="YYYY-MM-DD HH:mm:ss",ie="YYYY-MM-DD",se=500,ne=["application/pdf","application/zip","application/x-rar-compressed","image/jpeg","image/png","image/webp","text/plain","application/vnd.oasis.opendocument.spreadsheet","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.text","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],re=["image/jpeg","image/png","image/webp"],oe=10485760,le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",[a("div",{staticClass:"Login"},[a("div",{staticClass:"Login__message",class:"Login__message--"+e.message.type},[e.message.isLoading?a("i",{staticClass:"fa fa-circle-o-notch fa-spin"}):e._e(),e._v(" "+e._s(e.message.text)+" ")]),a("div",{staticClass:"Login__body"},[a("form",{staticClass:"Login__form",on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.credentials.identifier,expression:"credentials.identifier"}],staticClass:"Login__form__input",attrs:{type:"text",autocomplete:"username",placeholder:e.$t("email-address-or-pseudo")},domProps:{value:e.credentials.identifier},on:{input:function(t){t.target.composing||e.$set(e.credentials,"identifier",t.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.credentials.password,expression:"credentials.password"}],staticClass:"Login__form__input",attrs:{type:"password",autocomplete:"current-password",placeholder:e.$t("password")},domProps:{value:e.credentials.password},on:{input:function(t){t.target.composing||e.$set(e.credentials,"password",t.target.value)}}}),a("button",{staticClass:"Login__form__submit info",attrs:{type:"submit"}},[a("i",{staticClass:"fa fa-user-alt"}),e._v(" "+e._s(e.$t("page-login.connexion"))+" ")])]),e.showAlternativesLogin?a("div",{staticClass:"Login__alternatives"},[a("div",{staticClass:"Login__divider"},[a("strong",{staticClass:"Login__divider__label"},[e._v(e._s(e.$t("or")))])]),a("div",{staticClass:"Login__buttons"},[e.showCASLogin?a("a",{staticClass:"Login__button Login__button--cas",attrs:{href:e.casLoginUrl}},[e._v(" "+e._s(e.$t("page-login.login-with-cas"))+" ")]):e._e()])]):e._e()])])])},ce=[],ue=(a("37e7"),a("bf6b")),de=a.n(ue),me=a("4179"),pe=a.n(me),he={name:"Logo",props:{minimalist:Boolean},computed:{src:function(){return this.minimalist?de.a:pe.a}},render:function(){var e=arguments[0],t=this.src;return e("img",{class:"Logo",attrs:{src:t,alt:"Robert²"}})}},fe={name:"LoginLayout",data:function(){return{apiVersion:_.api.version}},render:function(){var e=arguments[0],t=this.$t,a=this.apiVersion;return e("div",{class:"LoginLayout"},[e("div",{class:"LoginLayout__logo"},[e(he)]),e("div",{class:"LoginLayout__body"},[this.$slots.default]),e("div",{class:"LoginLayout__footer"},[t("page-login.footer"),e("br"),"| ",e("a",{attrs:{href:"http://robertmanager.org",target:"_blank"}},[t("page-login.official-website")]),"| ",e("a",{attrs:{href:"http://forum.robertmanager.org",target:"_blank"}},[t("page-login.community-forum")]),"| ",e("a",{attrs:{href:"https://github.com/robert-2/Robert2",target:"_blank"}},["Github project"])," | v",a])])}},ve={name:"Login",components:{Layout:fe},data:function(){var e="default",t=this.$t("page-login.welcome"),a=this.$route.hash;switch(a){case"#bye":e="success",t=this.$t("page-login.bye");break;case"#expired":e="error",t=this.$t("page-login.error.expired-session");break;case"#restricted":e="error",t=this.$t("page-login.error.not-allowed");break;default:break}return{message:{type:e,text:t,isLoading:!1},credentials:{identifier:"",password:""},showCASLogin:_.auth.isCASEnabled}},computed:{showAlternativesLogin:function(){return this.showCASLogin},casLoginUrl:function(){var e=_.baseUrl;return"".concat(e,"/login/cas")}},methods:{login:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.message={type:"default",text:e.$t("page-login.please-wait"),isLoading:!0},t.prev=1,t.next=4,e.$store.dispatch("auth/login",Object(g["a"])({},e.credentials));case 4:e.$router.replace("/"),t.next=16;break;case 7:if(t.prev=7,t.t0=t["catch"](1),t.t0.response){t.next=12;break}return e.errorMessage({code:0,message:"network error"}),t.abrupt("return");case 12:a=t.t0.response,i=a.status,s=a.data,n=404!==i||s.error?404:0,r=s.error?s.error.message:"network error",e.errorMessage({code:n,message:r});case 16:case"end":return t.stop()}}),t,null,[[1,7]])})))()},errorMessage:function(e){var t=this.$t("errors.api-unreachable");404===e.code&&(t=this.$t("page-login.error.bad-infos")),this.message={type:"error",text:t,isLoading:!1}}}},_e=ve,ge=(a("4b04"),a("2877")),be=Object(ge["a"])(_e,le,ce,!1,null,null,null),ye=be.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view UserProfile",class:{"UserProfile--password-edit":e.isPasswordEdit}},[a("h3",{staticClass:"UserProfile__title"},[e._v(" "+e._s(e.$t("page-profile.you-are-group",{group:e.$t(e.groupId)}))+" ")]),a("div",{staticClass:"UserProfile__content"},[a("form",{staticClass:"Form",attrs:{method:"POST"},on:{submit:function(t){return t.preventDefault(),e.save(t)}}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("connexion-infos"))+" ")]),a("FormField",{attrs:{name:"pseudo",label:"pseudo",required:"",errors:e.errors.pseudo},model:{value:e.user.pseudo,callback:function(t){e.$set(e.user,"pseudo",t)},expression:"user.pseudo"}}),a("FormField",{attrs:{name:"email",label:"email",type:"email",required:"",errors:e.errors.email},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),e.isPasswordEdit?e._e():a("a",{staticClass:"UserProfile__password-edit-toggle",attrs:{role:"button"},on:{click:e.togglePasswordEdit}},[e._v(" "+e._s(e.$t("page-profile.edit-password"))+" ")]),a("section",{staticClass:"Form__fieldset UserProfile__section-password"},[a("h4",{staticClass:"Form__fieldset__title"},[a("a",{staticClass:"UserProfile__password-edit-cancel",attrs:{role:"button"},on:{click:e.togglePasswordEdit}},[e._v(" "+e._s(e.$t("cancel"))+" ")]),e._v(" "+e._s(e.$t("page-profile.edit-password"))+" ")]),a("FormField",{attrs:{name:"password",label:"password",type:"password",errors:e.errors.password},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),a("FormField",{attrs:{name:"passwordConfirmation",label:"page-profile.password-confirmation",type:"password"},model:{value:e.user.password_confirmation,callback:function(t){e.$set(e.user,"password_confirmation",t)},expression:"user.password_confirmation"}})],1),a("section",{staticClass:"Form__fieldset UserProfile__section-infos"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("personnal-infos"))+" ")]),a("FormField",{attrs:{name:"first_name",label:"first-name",errors:e.errors.first_name},model:{value:e.user.person.first_name,callback:function(t){e.$set(e.user.person,"first_name",t)},expression:"user.person.first_name"}}),a("FormField",{attrs:{name:"last_name",label:"last-name",errors:e.errors.last_name},model:{value:e.user.person.last_name,callback:function(t){e.$set(e.user.person,"last_name",t)},expression:"user.person.last_name"}}),a("FormField",{attrs:{name:"nickname",label:"nickname",errors:e.errors.nickname},model:{value:e.user.person.nickname,callback:function(t){e.$set(e.user.person,"nickname",t)},expression:"user.person.nickname"}}),a("FormField",{attrs:{name:"phone",label:"phone",type:"tel",errors:e.errors.phone},model:{value:e.user.person.phone,callback:function(t){e.$set(e.user.person,"phone",t)},expression:"user.person.phone"}}),a("FormField",{attrs:{name:"street",label:"street",errors:e.errors.street},model:{value:e.user.person.street,callback:function(t){e.$set(e.user.person,"street",t)},expression:"user.person.street"}}),a("FormField",{staticClass:"UserProfile__postal-code",attrs:{name:"postal_code",label:"postal-code",errors:e.errors.postal_code},model:{value:e.user.person.postal_code,callback:function(t){e.$set(e.user.person,"postal_code",t)},expression:"user.person.postal_code"}}),a("FormField",{attrs:{name:"locality",label:"city",errors:e.errors.locality},model:{value:e.user.person.locality,callback:function(t){e.$set(e.user.person,"locality",t)},expression:"user.person.locality"}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("save"))+" ")])])]),a("div",{staticClass:"UserProfile__extras"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),a("div",{staticClass:"UserProfile__extras__buttons"},[a("router-link",{attrs:{to:"/user-settings",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",on:{click:i}},[a("i",{staticClass:"fas fa-cogs"}),e._v(" "+e._s(e.$t("your-settings"))+" ")])]}}])})],1)],1)])])])},Ce=[],we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Help",class:"Help--"+e.modifier},[e.isLoading?a("div",{staticClass:"Help__loading"},[a("i",{staticClass:"fas fa-circle-notch fa-spin"}),e._v(" "+e._s(e.$t("loading"))+" ")]):e._e(),!e.isLoading&&e.error?a("ErrorMessage",{attrs:{error:e.error}}):e._e(),!e.$t(e.messageText)||e.error||e.isLoading?e._e():a("div",{staticClass:"Help__message"},[e._v(" "+e._s(e.$t(e.messageText))+" ")])],1)},$e=[],Ee=(a("f4b6"),{width:900,height:"auto",minHeight:300,adaptive:!0,draggable:!1,name:"defaultModal"}),xe=Ee,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ErrorDetails"},[a("div",{staticClass:"ErrorDetails__header"},[a("h2",{staticClass:"ErrorDetails__title"},[e._v(" "+e._s(e.$t("errors.details-title"))+" ")]),a("button",{staticClass:"ErrorDetails__btn-close",on:{click:function(t){return e.$emit("close")}}},[a("i",{staticClass:"fas fa-times"})])]),a("div",{staticClass:"ErrorDetails__main"},[a("p",[e._v(" "+e._s(e.$t("errors.details-intro1"))+" "+e._s(e.$t("errors.details-intro2"))+" "),a("a",{attrs:{href:"https://forum.robertmanager.org",target:"_blank"}},[e._v(" "+e._s(e.$t("errors.details-intro-forum"))+" ")]),e._v(" "+e._s(e.$t("errors.details-intro3"))+" "),a("a",{attrs:{href:"https://github.com/Robert-2/Robert2/issues",target:"_blank"}},[e._v("Github")]),e._v(". ")]),e.details?e._e():a("p",{staticClass:"ErrorDetails__no-details-info"},[a("i",{staticClass:"fas fa-info-circle"}),e._v(" "+e._s(e.$t("errors.details-intro-not-detailed"))+" ")]),a("hr"),a("div",{ref:"errorContent",staticClass:"ErrorDetails__content"},[e.requested?a("div",[a("h3",{staticClass:"ErrorDetails__subtitle"},[e._v(" #### "+e._s(e.$t("errors.details-request"))+" ")]),a("p",{staticClass:"ErrorDetails__request"},[e._v(" `"+e._s(e.requested)+"` ")])]):e._e(),a("h3",{staticClass:"ErrorDetails__subtitle"},[e._v(" #### "+e._s(e.$t("errors.details-message"))+" ("),a("span",{staticClass:"ErrorDetails__code"},[e._v(e._s(e.code))]),e._v(") : ")]),a("p",{staticClass:"ErrorDetails__message"},[e._v(" `"+e._s(e.message)+"` ")]),e.file.length>0?a("div",[a("h3",{staticClass:"ErrorDetails__subtitle"},[e._v(" #### "+e._s(e.$t("errors.details-file"))+" ")]),a("p",{staticClass:"ErrorDetails__file"},[e._v(" `"+e._s(e.file)+"` ")])]):e._e(),e.trace.length>0?a("div",[a("h3",{staticClass:"ErrorDetails__subtitle"},[e._v(" #### "+e._s(e.$t("errors.details-stacktrace"))+" ")]),a("div",{staticClass:"ErrorDetails__trace"},[e._v(" >! Details"),a("br"),e._v(" ```log"),a("br"),e._l(e.trace,(function(t,i){return a("div",{key:i,staticClass:"ErrorDetails__traceItem"},[a("span",{staticClass:"ErrorDetails__traceItem__index"},[e._v("- "+e._s(i)+": ")]),a("span",{staticClass:"ErrorDetails__traceItem__info"},[t.class?a("span",[e._v(e._s(t.class)+"::")]):e._e(),e._v(e._s(t.function)+" "),a("br")]),t.file?a("span",{staticClass:"ErrorDetails__traceItem__info"},[e._v(" File: "+e._s(t.file)+", line "+e._s(t.line)+" ")]):e._e()])})),e._v(" ``` ")],2)]):e._e()]),a("hr"),a("div",{staticClass:"ErrorDetails__footer"},[e.isCopied?a("p",{staticClass:"ErrorDetails__is-copied"},[a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(e.$t("copied-in-clipboard"))+" ")]):e._e(),a("button",{staticClass:"info",on:{click:e.copyErrorContent}},[a("i",{staticClass:"fas fa-clipboard"}),e._v(" "+e._s(e.$t("copy-to-clipboard"))+" ")]),a("button",{on:{click:function(t){return e.$emit("close")}}},[a("i",{staticClass:"fas fa-times"}),e._v(" "+e._s(e.$t("close"))+" ")])])])])},Me=[],Se=(a("1276"),a("a9e3"),function(e){if(!e)return"";var t=e.split("/src/");return t.length>0?"src/".concat(t[1]):e}),Le={name:"ErrorDetails",props:{code:{type:Number,required:!0},message:{type:String,required:!0},details:{type:Object,default:null}},data:function(){return{isCopied:!1}},computed:{requested:function(){var e;return null===(e=this.details)||void 0===e?void 0:e.requested},file:function(){var e;return Se(null===(e=this.details)||void 0===e?void 0:e.file)},trace:function(){var e,t=null===(e=this.details)||void 0===e?void 0:e.stackTrace;return t?t.map((function(e){var t=e.file;return Object(g["a"])(Object(g["a"])({},e),{},{file:Se(t)})})):[]}},methods:{copyErrorContent:function(){var e=document.createRange();e.selectNode(this.$refs.errorContent),window.getSelection().removeAllRanges(),window.getSelection().addRange(e),document.execCommand("copy"),this.isCopied=!0,window.getSelection().removeAllRanges()}}},Ie=Le,Te=(a("8ed0"),Object(ge["a"])(Ie,De,Me,!1,null,null,null)),Ae=Te.exports,Oe={name:"ErrorMessage",props:{error:{type:Error,required:!0}},data:function(){return{isDetailsModalOpened:!1}},computed:{code:function(){var e,t,a=this.error;return a.response?null!==(e=null===(t=a.response)||void 0===t?void 0:t.status)&&void 0!==e?e:500:-1},message:function(){var e,t,a=this.error;if(!a.response)return this.$t("errors.generic",{message:a.message||"unknown"});var i=a.response,s=i.status,n=i.data;return 400===s?this.$t("errors.validation"):404===s?this.$t("errors.not-found"):409===s?this.$t("errors.already-exists"):null!==(e=null===n||void 0===n||null===(t=n.error)||void 0===t?void 0:t.message)&&void 0!==e?e:this.$t("errors.unknown")},details:function(){var e,t,a=this.error;if(!a.response)return null;var i=a.response.data;return null!==(e=null===i||void 0===i||null===(t=i.error)||void 0===t?void 0:t.debug)&&void 0!==e?e:null}},methods:{handleShowDetails:function(){var e=this;if(!this.isDetailsModalOpened){this.isDetailsModalOpened=!0;var t=this.code,a=this.message,i=this.details;this.$modal.show(Ae,{code:t,message:a,details:i},xe,{"before-close":function(){e.isDetailsModalOpened=!1}})}}},render:function(){var e=arguments[0],t=this.$t,a=this.code,i=this.message,s=this.handleShowDetails;return e("p",{class:"ErrorMessage"},[e("span",{class:"ErrorMessage__message"},[e("i",{class:"fas fa-exclamation-triangle"})," ",i]),500===a&&e("a",{class:"ErrorMessage__show-details",on:{click:s}},[e("i",{class:"fas fa-external-link-alt"})," ",t("errors.show-details")])])}},je=Oe,Fe={name:"Help",components:{ErrorMessage:je},props:{message:{required:!0,default:""},error:{type:Error,default:null},isLoading:{type:Boolean,default:!1}},computed:{modifier:function(){return this.isLoading?"info":this.error?"error":this.message.type?this.message.type:"info"},messageText:function(){return this.message.text?this.message.text:this.message}}},qe=Fe,Pe=(a("ef5b"),Object(ge["a"])(qe,we,$e,!1,null,null,null)),Be=Pe.exports,Re=(a("3b5a"),a("fa33")),Ue=a("ee9b"),Ne=(a("b3f1"),{name:"SwitchToggle",props:{value:{type:Boolean,required:!0},locked:{type:Boolean,default:!1},hideLabel:{type:Boolean,default:!1},lockedReason:String},methods:{handleSwitch:function(){this.locked||this.$emit("input",!this.value)}},render:function(){var e=arguments[0],t=this.$t,a=this.value,i=this.locked,s=this.lockedReason,n=this.handleSwitch,r=this.hideLabel,o=["SwitchToggle",{"SwitchToggle--enabled":a,"SwitchToggle--locked":i}];return e("div",{class:o,on:{click:n}},[e("div",{class:"SwitchToggle__slide"},[e("div",{class:"SwitchToggle__button"})]),!r&&e("div",{class:"SwitchToggle__label"},[a&&e("span",[t("yes")]),!a&&e("span",[t("no")]),!(!i||!s)&&e("span",{class:"SwitchToggle__label__locked"},["(",t("locked"),": ",s,")"])])])}}),Ve=Ne,He=["text","email","password","number","tel","select","textarea","date","switch"],ze={name:"FormField",props:{label:String,name:String,type:{validator:function(e){return He.includes(e)},default:"text"},required:Boolean,disabled:Boolean,disabledReason:String,placeholder:String,value:[String,Number,Date,Boolean],step:Number,min:Number,max:Number,addon:String,options:Array,errors:Array,datepickerOptions:Object},data:function(){var e=this.$store.state.i18n.locale;return{datepickerLang:Ue[e],renderKey:1}},watch:{options:function(){this.renderKey+=1}},methods:{handleInput:function(e){var t=e.target.value;this.$emit("input",t)},handleChange:function(e){var t=e.target.value;this.$emit("change",t)},handleDatepickerChange:function(e){this.$emit("input",e);var t=r()(e).format("YYYY-MM-DD");this.$emit("change",{field:this.name,newValue:t,newDate:e})},handleSwitchChange:function(e){this.$emit("input",e),this.$emit("change",{field:this.name,newValue:e})}},render:function(){var e=arguments[0],t=this.$t,a=this.type,i=this.label,s=this.name,n=this.value,r=this.addon,o=this.placeholder,l=this.required,c=this.disabled,u=this.disabledReason,d=this.options,m=this.step,p=this.min,h=this.max,f=this.datepickerLang,v=this.datepickerOptions,_=this.handleInput,g=this.handleChange,b=this.handleDatepickerChange,y=this.handleSwitchChange,k=this.errors,C=this.renderKey,w=["FormField",{"FormField--with-addon":!!r,"FormField--with-error":k&&k.length>0}];return e("div",{class:w},[i&&e("label",{class:"FormField__label"},[t(i)," ",l&&e("span",{class:"FormField__label__required"},["*"])]),["text","email","tel","password","number"].includes(a)&&e("div",{class:"FormField__input-wrapper"},[e("input",{attrs:{type:a,step:"number"===a?m||.01:null,min:"number"===a&&p||null,max:"number"===a&&h||null,name:s,autocomplete:"password"===a?"new-password":"off",disabled:c,placeholder:t(o)},class:"FormField__input",domProps:{value:n},on:{input:_,change:g}}),r&&e("div",{class:"FormField__addon"},[r])]),"select"===a&&e("select",{key:C,attrs:{name:s,disabled:c},class:"FormField__select",domProps:{value:n},on:{input:_,change:g}},[d.map((function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t(a.label)])}))]),"textarea"===a&&e("textarea",{attrs:{name:s,disabled:c,placeholder:t(o)},domProps:{value:n},class:"FormField__textarea",on:{input:_}}),"date"===a&&e(Re["a"],{attrs:{value:n,language:f,format:v.format,"disabled-dates":v.disabled,placeholder:t(o),"input-class":"FormField__datepicker__input","monday-first":!0},class:"FormField__datepicker",on:{input:b}}),"switch"===a&&e("div",{class:"FormField__switch"},[e(Ve,{attrs:{value:null!==n&&void 0!==n&&n,locked:c,lockedReason:u},on:{input:y}})]),k&&e("div",{class:"FormField__error"},[e("span",{class:"FormField__error__text"},[k[0]])])])}},Qe={name:"UserProfile",components:{Help:Be,FormField:ze},data:function(){var e=this.$store.state.auth.user;return{help:"page-profile.help",error:null,isLoading:!1,isPasswordEdit:!1,user:{id:e.id,pseudo:e.pseudo,email:e.email,password:"",password_confirmation:"",group_id:e.groupId,restricted_parks:[],person:{first_name:"",last_name:"",nickname:"",phone:"",street:"",postal_code:"",locality:""}},errors:{pseudo:null,email:null,password:null,group_id:null,person:{first_name:null,last_name:null,nickname:null,phone:null,street:null,postal_code:null,locality:null}}}},computed:{groupId:function(){var e=this.$store.state.auth.user;return e?e.groupId:""}},mounted:function(){this.fetch()},methods:{fetch:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$store.state.auth.user.id,i=e.$route.meta.resource,e.resetHelpLoading(),t.prev=3,t.next=6,e.$http.get("".concat(i,"/").concat(a));case 6:s=t.sent,n=s.data,e.setUserData(n),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](3),e.displayError(t.t0);case 14:return t.prev=14,e.isLoading=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[3,11,14,17]])})))()},save:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,r,o,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.user,i=a.id,s=a.password,i){t.next=3;break}return t.abrupt("return");case 3:if(n=Object(g["a"])({},e.user),delete n.restricted_parks,!s){t.next=13;break}if(s===e.user.password_confirmation){t.next=10;break}return e.errors.password=[e.$t("page-profile.password-confirmation-must-match")],e.displayError(e.$t("errors.validation")),t.abrupt("return");case 10:e.errors.password=null,delete n.password_confirmation,delete n.person;case 13:return r=e.$route.meta.resource,e.resetHelpLoading(),t.prev=15,t.next=18,e.$http.put("".concat(r,"/").concat(i),n);case 18:o=t.sent,l=o.data,c=e.isPasswordEdit?"page-profile.password-modified":"page-profile.saved",e.help={type:"success",text:c},e.isPasswordEdit=!1,e.setUserData(l),e.$store.commit("auth/setUserProfile",l),t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](15),e.displayError(t.t0);case 30:return t.prev=30,e.isLoading=!1,t.finish(30);case 33:case"end":return t.stop()}}),t,null,[[15,27,30,33]])})))()},resetHelpLoading:function(){this.help="page-profile.help",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-profile.help",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setUserData:function(e){var t=e.person;t||(t={first_name:"",last_name:"",nickname:"",phone:"",street:"",postal_code:"",locality:""}),this.user=Object(g["a"])(Object(g["a"])({},e),{},{person:t})},togglePasswordEdit:function(e){e.preventDefault(),this.isPasswordEdit=!this.isPasswordEdit,this.isPasswordEdit||(this.user.password="",this.user.password_confirmation="")}}},Ge=Qe,Ye=(a("52dc"),Object(ge["a"])(Ge,ke,Ce,!1,null,null,null)),We=Ye.exports,Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view UserSettings"},[a("h3",{staticClass:"UserSettings__title"},[e._v(" "+e._s(e.$t("page-user-settings.interface"))+" ")]),a("div",{staticClass:"UserSettings__content"},[a("form",{staticClass:"Form",attrs:{method:"POST"},on:{submit:function(t){return t.preventDefault(),e.save(t)}}},[a("section",{staticClass:"Form__fieldset"},[a("FormField",{attrs:{name:"language",label:"page-user-settings.language",type:"select",options:e.langsOptions,errors:e.errors.language},model:{value:e.settings.language,callback:function(t){e.$set(e.settings,"language",t)},expression:"settings.language"}}),a("FormField",{staticClass:"UserSettings__hours",attrs:{name:"auth_token_validity_duration",label:"page-user-settings.auth-token-validity-duration",type:"number",addon:e.$t("hours"),errors:e.errors.auth_token_validity_duration},model:{value:e.settings.auth_token_validity_duration,callback:function(t){e.$set(e.settings,"auth_token_validity_duration",t)},expression:"settings.auth_token_validity_duration"}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("save"))+" ")])])]),a("div",{staticClass:"UserSettings__extras"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),a("div",{staticClass:"UserSettings__extras__buttons"},[a("router-link",{attrs:{to:"/profile",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",on:{click:i}},[a("i",{staticClass:"fas fa-user-alt"}),e._v(" "+e._s(e.$t("your-profile"))+" ")])]}}])})],1)],1)])])])},Xe=[],Ze={name:"UserSettings",components:{Help:Be,FormField:ze},data:function(){return{help:"page-user-settings.help",error:null,isLoading:!0,langsOptions:[{label:"french",value:"FR"},{label:"english",value:"EN"}],settings:{language:"",auth_token_validity_duration:""},errors:{language:null,auth_token_validity_duration:null}}},mounted:function(){this.fetch()},methods:{fetch:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$store.state.auth.user.id,e.isLoading=!0,t.prev=2,t.next=5,e.$http.get("users/".concat(a,"/settings"));case 5:i=t.sent,s=i.data,e.settings=s,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),e.displayError(t.t0);case 13:return t.prev=13,e.isLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[2,10,13,16]])})))()},save:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$store.state.auth.user.id,e.isLoading=!0,t.prev=2,t.next=5,e.$http.put("users/".concat(a,"/settings"),e.settings);case 5:i=t.sent,n=i.data,e.settings=n,e.help={type:"success",text:"page-user-settings.saved"},r=n.language.toLowerCase(),localStorage.setItem("userLocale",r),e.$store.commit("auth/setLocale",n.language),s["default"].i18n.set(r),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](2),e.displayError(t.t0);case 18:return t.prev=18,e.isLoading=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[2,15,18,21]])})))()},displayError:function(e){var t,a;this.help="page-user-settings.help",this.error=e;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))}}},Je=Ze,et=(a("5afa"),Object(ge["a"])(Je,Ke,Xe,!1,null,null,null)),tt=et.exports,at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__header"},[a("CalendarHeader",{ref:"Header",attrs:{isLoading:e.isLoading},on:{"set-center-date":e.setCenterDate,refresh:e.getEventsData,filterMissingMaterials:e.handleFilterMissingMaterial,filterByPark:e.handleFilterByPark}})],1),a("div",{ref:"Container",staticClass:"content__main-view Calendar"},[a("i",{staticClass:"fas fa-circle-notch fa-3x fa-spin Calendar__loading"}),a("Timeline",{ref:"Timeline",staticClass:"Calendar__timeline",attrs:{items:e.events,options:e.timelineOptions},on:{"item-over":e.onItemOver,"item-out":e.onItemOut,"item-moved":e.onItemMoved,"item-remove":e.onItemRemove,"item-removed":e.onItemRemoved,"double-click":e.onDoubleClick,"range-changed":e.onRangeChanged}}),a("div",{staticClass:"Calendar__footer"},[a("Help",{attrs:{message:e.help,error:e.error}}),a("CalendarCaption")],1)],1)])},it=[],st=a("2909"),nt=(a("25eb"),a("c1f9"),a("3dd1")),rt=a.n(nt),ot=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return rt.a.fire({title:e("please-confirm"),text:e("page-".concat(t,a?".confirm-delete":".confirm-permanently-delete")),icon:"warning",showCancelButton:!0,customClass:{confirmButton:a?"swal2-confirm--trash":"swal2-confirm--delete"},confirmButtonText:e(a?"yes-delete":"yes-permanently-delete"),cancelButtonText:e("cancel")})},lt=function(e,t){return rt.a.fire({title:e("please-confirm"),text:e("page-".concat(t,".confirm-restore")),icon:"warning",showCancelButton:!0,customClass:{confirmButton:"swal2-confirm--restore"},confirmButtonText:e("yes-restore"),cancelButtonText:e("cancel")})},ct=function(e,t,a){var i=a.titleData,s=void 0===i?void 0:i,n=a.placeholder,r=void 0===n?"":n,o=a.confirmText,l=void 0===o?"save":o,c=a.inputType,u=void 0===c?"text":c,d=a.inputValue,m=void 0===d?"":d;return rt.a.fire({title:e(t,s),input:u,inputPlaceholder:e(r),inputValue:m,showCancelButton:!0,customClass:{confirmButton:"swal2-confirm--success"},confirmButtonText:e(l),cancelButtonText:e("cancel")})},ut={ConfirmDelete:ot,ConfirmRestore:lt,Prompt:ct},dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EventDetails"},[e.isLoading?a("section",{staticClass:"EventDetails__loading"},[a("i",{staticClass:"fas fa-circle-notch fa-spin fa-2x"}),e._v(" "+e._s(e.$t("page-calendar.loading-event"))+" ")]):e._e(),!e.isLoading&&e.event?a("section",{staticClass:"EventDetails__content"},[a("Header",{attrs:{event:e.event},on:{close:function(t){return e.$emit("close")},saved:e.handleSavedFromHeader,deleted:e.handleDeletedFromHeader,error:e.handleError}}),a("div",{staticClass:"EventDetails__content__body"},[a("tabs",{attrs:{onSelect:e.handleChangeTab}},[a("tab",{attrs:{"title-slot":"infos"}},[a("Help",{attrs:{message:{type:"success",text:e.successMessage},error:e.error}}),a("div",{staticClass:"EventDetails__base-infos"},[e.event.location?a("LocationText",{attrs:{location:e.event.location}}):e._e(),a("PersonsList",{attrs:{type:"beneficiaries",persons:e.beneficiaries,warningEmptyText:e.$t("page-events.warning-no-beneficiary")}}),a("PersonsList",{attrs:{type:"technicians",persons:e.assignees}})],1),e.event.description?a("p",{staticClass:"EventDetails__description"},[a("i",{staticClass:"fas fa-clipboard"}),e._v(" "+e._s(e.event.description)+" ")]):e._e(),e.hasMaterials&&!e.event.isPast?a("div",{staticClass:"EventDetails__confirmation",class:{"EventDetails__confirmation--confirmed":e.event.is_confirmed}},[e.event.is_confirmed?e._e():a("div",[a("i",{staticClass:"fas fa-hourglass-half"}),e._v(" "+e._s(e.$t("page-events.event-not-confirmed-help"))+" ")]),e.event.is_confirmed?a("div",[a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(e.$t("page-events.event-confirmed-help"))+" ")]):e._e()]):e._e(),a("EventTotals",{attrs:{materials:e.event.materials,withRentalPrices:e.showBilling&&e.event.is_billable,discountRate:e.discountRate,start:e.event.startDate,end:e.event.endDate}})],1),a("tab",{attrs:{"title-slot":"materials",disabled:!e.hasMaterials}},[a("Help",{attrs:{message:{type:"success",text:e.successMessage},error:e.error}}),e.event.is_return_inventory_done?a("ReturnInventorySummary",{attrs:{eventId:e.event.id,isDone:e.event.is_return_inventory_done,materials:e.event.materials}}):a("EventMissingMaterials",{attrs:{eventId:e.event.id}}),e.hasMaterials?a("EventMaterials",{attrs:{materials:e.event.materials,start:e.event.startDate,end:e.event.endDate,withRentalPrices:e.showBilling&&e.event.is_billable,hideDetails:e.event.materials.length>16}}):e._e(),a("EventTotals",{attrs:{materials:e.event.materials,withRentalPrices:e.showBilling&&e.event.is_billable,discountRate:e.discountRate,start:e.event.startDate,end:e.event.endDate}})],1),e.showBilling?a("tab",{attrs:{"title-slot":"estimates",disabled:!e.hasMaterials}},[a("Help",{attrs:{message:{type:"success",text:e.successMessage},error:e.error}}),e.hasMaterials&&e.event.is_billable?a("EventEstimates",{attrs:{beneficiaries:e.event.beneficiaries,materials:e.event.materials,estimates:e.event.estimates,lastBill:e.lastBill,start:e.event.startDate,end:e.event.endDate,loading:e.isCreating,deletingId:e.deletingId},on:{createEstimate:e.handleCreateEstimate,deleteEstimate:e.handleDeleteEstimate}}):e._e(),e.event.is_billable?e._e():a("div",{staticClass:"EventDetails__not-billable"},[a("p",[a("i",{staticClass:"fas fa-ban"}),e._v(" "+e._s(e.$t("event-not-billable"))+" ")]),!e.event.is_confirmed&&e.userCanEditBill?a("p",[a("button",{staticClass:"success",on:{click:e.setEventIsBillable}},[e._v(" "+e._s(e.$t("enable-billable-event"))+" ")])]):e._e()])],1):e._e(),e.showBilling?a("tab",{attrs:{"title-slot":"billing",disabled:!e.hasMaterials}},[a("Help",{attrs:{message:{type:"success",text:e.successMessage},error:e.error}}),e.hasMaterials&&e.event.is_billable?a("EventBilling",{attrs:{beneficiaries:e.event.beneficiaries,lastBill:e.lastBill,lastEstimate:e.lastEstimate,allBills:e.event.bills,materials:e.event.materials,start:e.event.startDate,end:e.event.endDate,loading:e.isCreating},on:{createBill:e.handleCreateBill}}):e._e(),e.event.is_billable?e._e():a("div",{staticClass:"EventDetails__not-billable"},[a("p",[a("i",{staticClass:"fas fa-ban"}),e._v(" "+e._s(e.$t("event-not-billable"))+" ")]),!e.event.is_confirmed&&e.userCanEditBill?a("p",[a("button",{staticClass:"success",on:{click:e.setEventIsBillable}},[e._v(" "+e._s(e.$t("enable-billable-event"))+" ")])]):e._e()])],1):e._e(),a("template",{slot:"infos"},[a("i",{staticClass:"fas fa-info-circle"}),e._v(" "+e._s(e.$t("informations"))+" ")]),a("template",{slot:"materials"},[a("i",{staticClass:"fas fa-box"}),e._v(" "+e._s(e.$t("material"))+" "),e.hasMaterialsProblems?a("i",{staticClass:"fas fa-exclamation-triangle"}):e._e()]),a("template",{slot:"estimates"},[a("i",{staticClass:"fas fa-file-signature"}),e._v(" "+e._s(e.$t("estimates"))+" ")]),a("template",{slot:"billing"},[a("i",{staticClass:"fas fa-file-invoice-dollar"}),e._v(" "+e._s(e.$t("bill"))+" ")])],2),e.hasMaterials?e._e():a("div",{staticClass:"EventDetails__materials-empty"},[a("p",[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.$t("page-events.warning-no-material"))+" ")]),e.event.isPast?e._e():a("router-link",{attrs:{to:"/events/"+e.event.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",on:{click:i}},[a("i",{staticClass:"fas fa-edit"}),e._v(" "+e._s(e.$t("page-events.edit-event"))+" ")])]}}],null,!1,906362114)})],1)],1)],1):e._e()])},mt=[],pt=a("0652"),ht=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e?e.discount_rate:t?t.discount_rate:a},ft=ht,vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"LocationText"},[a("i",{staticClass:"fas fa-map-marker-alt"}),e._v(" "+e._s(e.$t("in"))+" "),a("strong",[e._v(e._s(e.location))]),a("a",{attrs:{href:"https://www.openstreetmap.org/search?query="+e.location,target:"_blank",title:e.$t("open-in-openstreetmap")}},[e._v(" "),a("i",{staticClass:"fas fa-external-link-alt"})])])},_t=[],gt={name:"LocationText",props:{location:String}},bt=gt,yt=(a("26e1"),Object(ge["a"])(bt,vt,_t,!1,null,null,null)),kt=yt.exports,Ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"PersonsList"},[0===e.persons.length&&e.warningEmptyText?a("div",{staticClass:"PersonsList__nobody"},[a("i",{staticClass:"fas fa-exclamation-circle"}),e._v(" "+e._s(e.warningEmptyText)+" ")]):e._e(),e.persons.length>0?a("div",{staticClass:"PersonsList__list"},["beneficiaries"===e.type?a("span",[a("i",{staticClass:"fas fa-address-book"}),e._v(" "+e._s(e.$t("for"))+" ")]):e._e(),"technicians"===e.type?a("span",[a("i",{staticClass:"fas fa-people-carry"}),e._v(" "+e._s(e.$t("with"))+" ")]):e._e(),e._l(e.persons,(function(t){return a("div",{key:t.id,staticClass:"PersonsList__item"},[a("router-link",{attrs:{to:"/"+e.type+"/"+t.id,title:e.$t("action-edit")}},[e._v(" "+e._s(t.name)+" ")]),t.company?a("router-link",{attrs:{to:"/companies/"+t.company_id,title:e.$t("action-edit")}},[e._v(" ("+e._s(t.company)+") ")]):e._e()],1)}))],2):e._e()])},wt=[],$t={name:"PersonsList",props:{persons:Array,type:String,warningEmptyText:String}},Et=$t,xt=(a("2416"),Object(ge["a"])(Et,Ct,wt,!1,null,null,null)),Dt=xt.exports,Mt=(a("f1b2"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=_.currency.iso;return e.toLocaleString(void 0,{style:"currency",currency:t,currencyDisplay:"symbol",useGrouping:!0})}),St=Mt,Lt=(a("4ec9"),a("3ca3"),a("ddb0"),a("c740"),a("a630"),function(e){var t;return"awaited_quantity"in e?e.awaited_quantity:"quantity"in(null!==(t=e.pivot)&&void 0!==t?t:{})?e.pivot.quantity:e.stock_quantity}),It=function(e){return"awaited_units"in e?e.awaited_units:e.units},Tt=function(e,t){return e.localeCompare(t,void 0,{ignorePunctuation:!0,sensitivity:"base"})},At=function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"name";if(!e||0===e.length||!a)return[];var s=new Map;e.forEach((function(e){if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error("Identifier '".concat(t,"' doesn't exist in material data."));if("park_id"===t&&e.is_unitary){var i=It(e);i.forEach((function(t){var n=t.park_id,r=a(n);s.has(n)||s.set(n,{id:n,name:r,materials:[],subTotal:0});var o=s.get(n),l=o.materials.findIndex((function(t){return t.id===e.id}));if(!(l>-1)){var c=i.filter((function(e){return e.park_id===n})),u=Object(g["a"])({},e);"awaited_units"in e?u.awaited_units=c:u.units=c,e.pivot&&(u.pivot=Object(g["a"])(Object(g["a"])({},e.pivot),{},{quantity:c.length,units:c.map((function(e){return e.id}))})),"awaited_units"in e&&(u.awaited_quantity=c.length),o.materials.push(u);var d=c.length;o.subTotal+=d*e.rental_price}}))}else{var n=e[t];if(!s.has(n)){var r=a(n);s.set(n,{id:n,name:r,materials:[],subTotal:0})}var o=s.get(n),l=Lt(e);o.materials.push(e),o.subTotal+=l*e.rental_price}}));var n=Array.from(s.values());return n.sort((function(e,t){var a,i;return Tt(null!==(a=e.name)&&void 0!==a?a:"",null!==(i=t.name)&&void 0!==i?i:"")})),n.forEach((function(e){e.materials.sort((function(e,t){if("price"===i){var a=e.rental_price*Lt(e),s=t.rental_price*Lt(t);return a>s?-1:1}if("name"===i)return Tt(e.name,t.name);var n=e[i],r=t[i];return n===r?0:n<r?-1:1}))})),n},Ot=At,jt={name:"EventMaterials",props:{materials:Array,start:Object,end:Object,withRentalPrices:{type:Boolean,default:!0},hideDetails:{type:Boolean,default:!1}},data:function(){return{showMaterialsList:!this.hideDetails}},computed:{categories:function(){var e=this.$store.getters["categories/categoryName"];return Ot(this.materials,"category_id",e,"price")}},created:function(){this.$store.dispatch("categories/fetch")},methods:{formatAmount:function(e){return St(e)}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.materials,s=this.categories,n=this.showMaterialsList,r=this.withRentalPrices;return t("div",{class:"EventMaterials"},[(!n||i.length>30)&&t("div",{class:"EventMaterials__toggle"},[t("button",{on:{click:function(){e.showMaterialsList=!n}},class:{info:!n}},[t("i",{class:{fas:!0,"fa-eye":!n,"fa-eye-slash":n}}),a(n?"hide-materials-details":"show-materials-details")])]),n&&t("div",{class:"EventMaterials__categories"},[s.map((function(i,n){return t("div",{key:i.id,class:"EventMaterials__category"},[t("h4",{class:"EventMaterials__title"},[i.name]),t("ul",{class:"EventMaterials__list"},[i.materials.map((function(a){return t("li",{key:a.id,class:"EventMaterials__item"},[t("div",{class:"EventMaterials__item__quantity-first"},[a.pivot.quantity]),t("div",{class:"EventMaterials__item__name"},[a.name]),r&&t("div",{class:"EventMaterials__item__price"},[e.formatAmount(a.rental_price)]),t("div",{class:"EventMaterials__item__quantity"},[t("i",{class:"fas fa-times"})," ",a.pivot.quantity]),r&&t("div",{class:"EventMaterials__item__total"},[e.formatAmount(a.pivot.quantity*a.rental_price)])])}))]),r&&t("div",{class:"EventMaterials__subtotal"},[n===s.length-1&&t("button",{on:{click:function(){e.showMaterialsList=!1}}},[t("i",{class:"fas fa-eye-slash"})," ",a("hide-materials-details")]),t("div",{class:"EventMaterials__subtotal__name"},[a("sub-total")]),t("div",{class:"EventMaterials__subtotal__price"},[e.formatAmount(i.subTotal)])])])}))])])}},Ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.hasMissingMaterials||e.error?a("div",{staticClass:"EventMissingMaterials"},[a("h3",{staticClass:"EventMissingMaterials__title"},[a("i",{staticClass:"fas fa-box-open"}),e._v(" "+e._s(e.$t("page-events.event-missing-materials"))+" ")]),a("p",{staticClass:"EventMissingMaterials__help"},[e._v(" "+e._s(e.$t("page-events.event-missing-materials-help"))+" ")]),e.error?a("div",{staticClass:"EventMissingMaterials__error"},[e._v(" "+e._s(e.error)+" ")]):e._e(),a("ul",{staticClass:"EventMissingMaterials__list"},e._l(e.missingMaterials,(function(t){return a("li",{key:t.id,staticClass:"EventMissingMaterials__item"},[a("div",{staticClass:"EventMissingMaterials__item__name"},[e._v(" "+e._s(t.name)+" ")]),a("div",{staticClass:"EventMissingMaterials__item__quantity"},[e._v(" "+e._s(e.$t("page-events.missing-material-count",e.getMissingCount(t)))+" ")])])})),0)]):e._e()},qt=[],Pt={name:"EventMissingMaterials",props:{eventId:Number},data:function(){return{hasMissingMaterials:!1,missingMaterials:[],error:null}},mounted:function(){this.fetchMissingMaterials()},methods:{fetchMissingMaterials:function(){var e=this;this.$http.get("events/".concat(this.eventId,"/missing-materials")).then((function(t){var a=t.data;e.missingMaterials=a,e.hasMissingMaterials=a.length>0})).catch(this.displayError)},getMissingCount:function(e){var t=e.pivot.quantity;return{quantity:t,missing:e.missing_quantity}},displayError:function(e){this.error=e}}},Bt=Pt,Rt=(a("5b9a"),Object(ge["a"])(Bt,Ft,qt,!1,null,null,null)),Ut=Rt.exports,Nt=(a("3e22"),a("6bf3"),{name:"ReturnInventoryItem",props:{data:Object},render:function(){var e=arguments[0],t=this.$t,a=this.data,i=a.id,s=a.name,n=a.out,r=a.returned,o=a.missing,l=a.broken;return e("li",{class:"ReturnInventoryItem"},[e("div",{class:"ReturnInventoryItem__name"},[e("router-link",{attrs:{to:"/materials/".concat(i,"/view")}},[s])]),e("div",{class:"ReturnInventoryItem__missing"},[o>0&&t("page-events.not-returned-material-count",{out:n,returned:r,missing:o},r)]),e("div",{class:"ReturnInventoryItem__broken"},[l>0&&t("page-events.broken-material-count",{broken:l},l)])])}}),Vt=Nt,Ht={name:"ReturnInventorySummary",components:{ReturnInventoryItem:Vt},props:{eventId:Number,isDone:Boolean,materials:Array},computed:{materialsWithProblem:function(){return this.materials.map((function(e){return Object(g["a"])(Object(g["a"])({},e),{},{out:e.pivot.quantity,returned:e.pivot.quantity_returned,missing:e.pivot.quantity-e.pivot.quantity_returned,broken:e.pivot.quantity_broken})})).filter((function(e){var t=e.missing,a=e.broken;return t>0||a>0}))},isVisitor:function(){return this.$store.getters["auth/is"]("visitor")}},render:function(){var e=arguments[0],t=this.$t,a=this.eventId,i=this.isDone,s=this.isVisitor,n=this.materialsWithProblem,r=n.length>0;return e("div",{class:"ReturnInventorySummary"},[r&&e("div",{class:"ReturnInventorySummary__title"},[t("page-events.problems-on-returned-materials")]),!i&&e("div",{class:"ReturnInventorySummary__not-done"},[e("p",[t("page-events.return-inventory-not-done-yet")]),!s&&e("router-link",{attrs:{to:"/event-return/".concat(a)},class:"ReturnInventorySummary__link"},[e("i",{class:"fas fa-tasks"})," ",t("page-events.do-or-terminate-return-inventory")])]),i&&e("div",{class:"ReturnInventorySummary__done"},[!r&&e("div",{class:"ReturnInventorySummary__all-ok"},[t("page-event-return.all-material-returned")]),r&&e("ul",{class:"ReturnInventorySummary__list"},[n.map((function(t){return e(Vt,{key:t.id,attrs:{data:t}})}))]),e("router-link",{attrs:{to:"/event-return/".concat(a)},class:"ReturnInventorySummary__link"},[e("i",{class:"fas fa-tasks"})," ",t("page-events.view-return-inventory")])])])}},zt=Ht,Qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"EventEstimates"},[e.estimates.length>0&&!e.displayCreateEstimate&&!e.loading?a("ul",{staticClass:"EventEstimates__list"},e._l(e.estimates,(function(t,i){return a("li",{key:t.id,staticClass:"EventEstimates__list__item",class:{"EventEstimates__list__item--old":i>0}},[a("i",{staticClass:"fas fa-file-signature EventEstimates__list__item__icon"}),a("div",{staticClass:"EventEstimates__list__item__text"},[e._v(" "+e._s(e.$t("estimate-item-help",e.formatDate(t.date)))),a("br"),a("strong",[e._v(e._s(e.formatAmount(t.due_amount)))]),0===t.discount_rate?a("span",[e._v(" ("+e._s(e.$t("without-discount"))+"). ")]):a("span",[e._v(" ("+e._s(e.$t("discount-rate",{rate:t.discount_rate}))+"). ")])]),a("div",{staticClass:"EventEstimates__list__item__actions"},[a("a",{staticClass:"EventEstimates__list__item__download",class:{"EventEstimates__list__item__download--disabled":e.deletingId===t.id},attrs:{href:e.getPdfUrl(t.id)}},[a("i",{staticClass:"fas fa-download"}),e._v(" "+e._s(e.$t("download"))+" ")]),a("button",{staticClass:"EventEstimates__list__item__delete danger",attrs:{disabled:!!e.deletingId},on:{click:function(a){return e.$emit("deleteEstimate",t.id)}}},[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("action-delete"))+" ")])])])})),0):e._e(),e.loading||e.deletingId?a("div",{staticClass:"EventEstimates__loading"},[a("i",{staticClass:"fas fa-circle-notch fa-spin"}),e._v(" "+e._s(e.$t("loading"))+" ")]):e._e(),e.userCanEdit&&e.lastBill?a("div",{staticClass:"EventEstimates__warning-has-bill"},[e._v(" "+e._s(e.$t("warning-event-has-bill"))+" ")]):e._e(),e.estimates.length>0&&e.userCanEdit&&!e.loading&&!e.deletingId?a("div",{staticClass:"EventEstimates__create-new"},[a("p",{staticClass:"EventEstimates__create-new__text"},[e._v(" "+e._s(e.$t("create-new-estimate-help"))+" ")]),e.displayCreateEstimate?e._e():a("button",{staticClass:"EventEstimates__create-new__button success",on:{click:e.openCreateEstimate}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("create-new-estimate"))+" ")])]):e._e(),e.isBillable?e._e():a("div",{staticClass:"EventEstimates__not-billable"},[a("h3",{staticClass:"EventEstimates__not-billable__title"},[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.$t("missing-beneficiary"))+" ")]),e.userCanEdit?a("p",{staticClass:"EventEstimates__not-billable__text"},[e._v(" "+e._s(e.$t("not-billable-help"))),a("br"),e._v(" "+e._s(e.$t("click-edit-to-create-one"))+" ")]):e._e()]),0===e.estimates.length&&e.isBillable?a("div",[a("p",{staticClass:"EventEstimates__no-estimate"},[e._v(" "+e._s(e.$t("no-estimate-help"))),a("br"),e.userCanEdit?a("span",[e._v(e._s(e.$t("create-estimate-help")))]):a("span",[e._v(e._s(e.$t("contact-someone-to-create-estimate")))])])]):e._e(),e.displayCreateEstimate||e.loading||0===e.estimates.length&&e.isBillable&&e.userCanEdit&&!e.deletingId?a("BillEstimateCreationForm",{attrs:{discountRate:e.discountRate,discountTarget:e.discountTarget,maxAmount:e.grandTotal,beneficiary:e.beneficiaries[0],saveLabel:e.$t("create-estimate"),isRegeneration:e.estimates.length>0,loading:e.loading},on:{change:e.handleChangeDiscount,submit:e.createEstimate,cancel:e.closeCreateEstimate}}):e._e()],1)},Gt=[],Yt=(a("c35a"),a("35b3"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Math.round((e+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t)}),Wt=Yt,Kt=(a("9129"),function(e,t){if("number"!==typeof e||Number.isNaN(e))return 0;if(0===e||0===t)return 0;var a=_.degressiveRate(t);return e*a}),Xt=Kt,Zt=function(e){return e&&0!==e.length?e.reduce((function(e,t){return e+t.rental_price*t.pivot.quantity}),0):0},Jt=Zt,ea=function(e){return e&&0!==e.length?e.reduce((function(e,t){return t.is_discountable?e+t.rental_price*t.pivot.quantity:e}),0):0},ta=ea,aa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"Form BillEstimateCreationForm",on:{submit:e.handleSubmit}},[a("div",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(e._s(e.$t("discount")))]),a("FormField",{staticClass:"BillEstimateCreationForm__discount-input",attrs:{value:e.discountRate,name:"discountRate",type:"number",step:1e-4,min:0,max:99.9999,addon:"%",label:"wanted-rate",disabled:e.loading},on:{change:e.handleChangeRate}}),a("FormField",{staticClass:"BillEstimateCreationForm__discount-target-input",attrs:{value:e.discountTarget,name:"discountTarget",type:"number",step:.01,min:0,max:e.maxAmount,addon:e.currency,label:"wanted-amount",disabled:e.loading},on:{change:e.handleChangeAmount}}),a("div",{staticClass:"BillEstimateCreationForm__beneficiary"},[a("div",{staticClass:"BillEstimateCreationForm__beneficiary__label"},[e._v(" "+e._s(e.$t("beneficiary"))+" ")]),a("div",{staticClass:"BillEstimateCreationForm__beneficiary__name"},[a("router-link",{attrs:{to:"/beneficiaries/"+e.beneficiary.id,title:e.$t("action-edit")}},[e._v(" "+e._s(e.beneficiary.full_name)+" ")])],1)])],1),a("div",{staticClass:"BillEstimateCreationForm__save"},[a("button",{staticClass:"success",attrs:{type:"submit",disabled:e.loading}},[e.loading?a("i",{staticClass:"fas fa-circle-notch fa-spin"}):a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.saveLabel)+" ")]),e.isRegeneration?a("button",{attrs:{type:"button",disabled:e.loading},on:{click:function(t){return e.$emit("cancel")}}},[e._v(" "+e._s(e.$t("cancel"))+" ")]):e._e()])])},ia=[],sa={name:"BillEstimateCreationForm",components:{FormField:ze},props:{discountRate:Number,discountTarget:Number,maxAmount:Number,beneficiary:Object,saveLabel:String,isRegeneration:Boolean,loading:Boolean},data:function(){return{currency:_.currency.symbol}},methods:{handleChangeRate:function(e){this.$emit("change",{field:"rate",value:Number.parseFloat(e)})},handleChangeAmount:function(e){this.$emit("change",{field:"amount",value:Number.parseFloat(e)})},handleSubmit:function(e){e.preventDefault(),this.$emit("submit")}}},na=sa,ra=(a("a8d7"),Object(ge["a"])(na,aa,ia,!1,null,null,null)),oa=ra.exports,la={name:"EventEstimates",components:{BillEstimateCreationForm:oa},props:{beneficiaries:Array,materials:Array,estimates:Array,lastBill:Object,loading:Boolean,deletingId:Number,start:Object,end:Object},data:function(){var e=Object(T["a"])(this.estimates,1),t=e[0],a=ft(this.lastBill,t);return{discountRate:a,duration:this.end?this.end.diff(this.start,"days")+1:1,currency:_.currency.symbol,isBillable:this.beneficiaries.length>0,displayCreateEstimate:!1}},watch:{discountRate:function(e){this.$emit("discountRateChange",Number.parseFloat(e))}},computed:{userCanEdit:function(){return this.$store.getters["auth/is"](["admin","member"])},total:function(){return Jt(this.materials)},grandTotal:function(){return Xt(this.total,this.duration)},totalDiscountable:function(){return ta(this.materials)},grandTotalDiscountable:function(){return Xt(this.totalDiscountable,this.duration)},discountAmount:function(){return this.grandTotalDiscountable*(this.discountRate/100)},discountTarget:{get:function(){return Wt(this.grandTotal-this.discountAmount)},set:function(e){var t=this.grandTotal-e,a=t/this.grandTotalDiscountable*100;this.discountRate=Wt(a,4)}}},methods:{handleChangeDiscount:function(e){var t=e.field,a=e.value;"amount"===t?this.discountTarget=a:"rate"===t&&(this.discountRate=a)},createEstimate:function(){this.displayCreateEstimate=!1,this.loading||this.$emit("createEstimate",this.discountRate)},getPdfUrl:function(e){if(this.deletingId===e)return"#";var t=_.baseUrl;return"".concat(t,"/estimates/").concat(e,"/pdf")},openCreateEstimate:function(){this.displayCreateEstimate=!0},closeCreateEstimate:function(){this.displayCreateEstimate=!1;var e=Object(T["a"])(this.estimates,1),t=e[0];this.discountRate=ft(this.lastBill,t,this.discountRate)},formatDate:function(e){var t=r()(e);return{date:t.format("L"),hour:t.format("HH:mm")}},formatAmount:function(e){return St(e)}}},ca=la,ua=(a("f974"),Object(ge["a"])(ca,Qt,Gt,!1,null,null,null)),da=ua.exports,ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"EventBilling"},[!e.lastBill||e.displayCreateBill||e.loading?e._e():a("DisplayBill",{attrs:{data:e.lastBill}}),e.lastBill&&e.userCanEdit?a("div",{staticClass:"EventBilling__regenerate"},[a("p",{staticClass:"EventBilling__regenerate__text"},[e._v(" "+e._s(e.$t("regenerate-bill-help"))+" ")]),e.displayCreateBill||e.loading?e._e():a("button",{staticClass:"EventBilling__regenerate__button",on:{click:e.openBillRegeneration}},[a("i",{staticClass:"fas fa-sync"}),e._v(" "+e._s(e.$t("click-here-to-regenerate-bill"))+" ")])]):e._e(),e.isBillable?e._e():a("div",{staticClass:"EventBilling__not-billable"},[a("h3",{staticClass:"EventBilling__not-billable__title"},[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.$t("missing-beneficiary"))+" ")]),e.userCanEdit?a("p",{staticClass:"EventBilling__not-billable__text"},[e._v(" "+e._s(e.$t("not-billable-help"))),a("br"),e._v(" "+e._s(e.$t("click-edit-to-create-one"))+" ")]):e._e()]),!e.lastBill&&e.isBillable?a("div",[e.userCanEdit&&!e.lastEstimate?a("div",{staticClass:"EventBilling__warning-no-estimate"},[e._v(" "+e._s(e.$t("warning-no-estimate-before-billing"))+" ")]):e._e(),a("p",{staticClass:"EventBilling__no-bill"},[e._v(" "+e._s(e.$t("no-bill-help"))),a("br"),e.userCanEdit?a("span",[e._v(e._s(e.$t("create-bill-help")))]):a("span",[e._v(e._s(e.$t("contact-someone-to-create-bill")))])])]):e._e(),e.displayCreateBill||e.loading||!e.lastBill&&e.isBillable&&e.userCanEdit?a("BillEstimateCreationForm",{attrs:{discountRate:e.discountRate,discountTarget:e.discountTarget,maxAmount:e.grandTotal,beneficiary:e.beneficiaries[0],saveLabel:e.$t("create-bill"),isRegeneration:!!e.lastBill,loading:e.loading},on:{change:e.handleChangeDiscount,submit:e.createBill,cancel:e.closeBillRegeneration}}):e._e(),e.allBills.length>1&&!e.displayCreateBill&&!e.loading?a("div",[a("h3",{staticClass:"EventBilling__list-title"},[e._v(e._s(e.$t("previous-bills")))]),a("ul",{staticClass:"EventBilling__list"},e._l(e.allBills,(function(t,i){return a("li",{key:t.id,staticClass:"EventBilling__list__item",class:{"EventBilling__list__item--current":0===i}},[!t||e.displayCreateBill||e.loading?e._e():a("DisplayBill",{attrs:{data:t}})],1)})),0)]):e._e()],1)},pa=[],ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"DisplayBill"},[a("div",{staticClass:"DisplayBill__main"},[e._m(0),a("div",{staticClass:"DisplayBill__text"},[e._v(" "+e._s(e.$t("bill-number-generated-at",{number:e.data.number,date:e.billDate.format("L")}))+" "),a("br"),e._v(" "+e._s(e.$t("with-amount-of",{amount:e.formatAmount(e.data.due_amount)}))+" "),0===e.data.discount_rate?a("span",[e._v(" ("+e._s(e.$t("without-discount"))+"). ")]):a("span",[e._v(" ("+e._s(e.$t("discount-rate",{rate:e.data.discount_rate}))+"). ")])])]),a("div",{staticClass:"DisplayBill__actions"},[a("a",{staticClass:"DisplayBill__download",attrs:{href:e.pdfUrl}},[a("i",{staticClass:"fas fa-download"}),e._v(" "+e._s(e.$t("download-pdf"))+" ")])])])},fa=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"DisplayBill__icon"},[a("i",{staticClass:"fas fa-file-invoice-dollar"})])}],va={name:"DisplayBill",props:{data:Object},computed:{pdfUrl:function(){var e=_.baseUrl,t=this.data||{id:null},a=t.id;return"".concat(e,"/bills/").concat(a,"/pdf")},billDate:function(){var e=this.data.date;return r.a.isMoment(e)?e:r()(e)}},methods:{formatAmount:function(e){return St(e)}}},_a=va,ga=(a("75db"),Object(ge["a"])(_a,ha,fa,!1,null,null,null)),ba=ga.exports,ya={name:"EventBilling",components:{DisplayBill:ba,BillEstimateCreationForm:oa},props:{lastBill:Object,lastEstimate:Object,allBills:Array,beneficiaries:Array,materials:Array,loading:Boolean,start:Object,end:Object},data:function(){var e=ft(this.lastBill,this.lastEstimate);return{discountRate:e,duration:this.end?this.end.diff(this.start,"days")+1:1,isBillable:this.beneficiaries.length>0,displayCreateBill:!1}},watch:{discountRate:function(e){this.$emit("discountRateChange",Number.parseFloat(e))}},computed:{userCanEdit:function(){return this.$store.getters["auth/is"](["admin","member"])},total:function(){return Jt(this.materials)},grandTotal:function(){return Xt(this.total,this.duration)},totalDiscountable:function(){return ta(this.materials)},grandTotalDiscountable:function(){return Xt(this.totalDiscountable,this.duration)},discountAmount:function(){return this.grandTotalDiscountable*(this.discountRate/100)},discountTarget:{get:function(){return Wt(this.grandTotal-this.discountAmount)},set:function(e){var t=this.grandTotal-e,a=t/this.grandTotalDiscountable*100;this.discountRate=Wt(a,4)}}},methods:{handleChangeDiscount:function(e){var t=e.field,a=e.value;"amount"===t?this.discountTarget=a:"rate"===t&&(this.discountRate=a)},createBill:function(){this.displayCreateBill=!1,this.loading||this.$emit("createBill",this.discountRate)},openBillRegeneration:function(){this.displayCreateBill=!0},closeBillRegeneration:function(){this.displayCreateBill=!1,this.discountRate=ft(this.lastBill,this.lastEstimate,this.discountRate)}}},ka=ya,Ca=(a("19d4"),Object(ge["a"])(ka,ma,pa,!1,null,null,null)),wa=Ca.exports,$a=(a("25f2"),function(e){return e&&0!==e.length?e.reduce((function(e,t){return e+t.pivot.quantity}),0):0}),Ea=$a,xa=function(e){return e&&0!==e.length?e.reduce((function(e,t){return e+t.replacement_price*t.pivot.quantity}),0):0},Da=xa,Ma={name:"EventTotals",props:{materials:Array,withRentalPrices:Boolean,discountRate:Number,start:Object,end:Object},data:function(){return{duration:this.end?this.end.diff(this.start,"days")+1:1,currency:_.currency.symbol}},created:function(){this.$store.dispatch("categories/fetch")},computed:{ratio:function(){return _.degressiveRate(this.duration)},itemsCount:function(){return Ea(this.materials)},total:function(){return Jt(this.materials)},grandTotal:function(){return Xt(this.total,this.duration)},totalDiscountable:function(){return ta(this.materials)},grandTotalDiscountable:function(){return Xt(this.totalDiscountable,this.duration)},discountAmount:function(){return this.grandTotalDiscountable*(this.discountRate/100)},discountTarget:{get:function(){return Wt(this.grandTotal-this.discountAmount)},set:function(e){var t=this.grandTotal-e,a=t/this.grandTotalDiscountable*100;this.discountRate=Wt(a,4)}},grandTotalWithDiscount:function(){return this.grandTotal-this.discountAmount},replacementTotal:function(){return Da(this.materials)}},methods:{recalcDiscountRate:function(e){this.discountTarget=parseFloat(e)}},render:function(){var e=arguments[0],t=this.$t,a=this.withRentalPrices,i=this.itemsCount,s=this.total,n=this.duration,r=this.ratio,o=this.grandTotal,l=this.discountRate,c=this.totalDiscountable,u=this.grandTotalDiscountable,d=this.discountAmount,m=this.grandTotalWithDiscount,p=this.replacementTotal;return e("section",{class:"EventTotals"},[a&&e("div",{class:"EventTotals__rental-prices"},[e("div",{class:"EventTotals__base"},[t("total")," ",e("span",{class:"EventTotals__items-count"},[t("items-count",{count:i},i)]),e("span",{class:"EventTotals__daily-total"},[e("i",{class:"fas fa-arrow-right"})," ",St(s)]),e("span",{class:"EventTotals__duration"},[e("i",{class:"fas fa-times"})," ",t("days-count",{duration:n},n)]),e("span",{class:"EventTotals__ratio"},[e("i",{class:"fas fa-arrow-right"})," ",t("ratio")," ",r])]),e("div",{class:"EventTotals__grand"},[t("total-amount"),": ",St(o)]),l>0&&c!==s&&e("div",{class:"EventTotals__discountable"},[t("total-discountable"),":",St(c)," / ",t("day"),e("i",{class:"fas fa-arrow-right"})," ",St(u)]),l>0&&e("div",{class:"EventTotals__discount"},[t("discount")," ",{discountRate:l}," %",e("i",{class:"fas fa-arrow-right"})," - ",St(d)]),l>0&&e("div",{class:"EventTotals__grand-discount"},[t("total-amount-with-discount"),": ",St(m)]),n>1&&e("div",{class:"EventTotals__daily"},["(",St(m/n)," / ",t("day"),")"])]),e("div",{class:"EventTotals__replacement"},[t("replacement-total"),": ",St(p)])])}},Sa=function(e){var t=e.start_date,a=e.end_date,i=e.is_confirmed,s=e.is_archived,n=e.has_missing_materials,o=e.is_return_inventory_done,l=e.has_not_returned_materials,c=r()(),u=r()(t),d=r()(a),m=d.isBefore(c,"day"),p=c.isBetween(u,d,"day","[]");return Object(g["a"])(Object(g["a"])({},e),{},{startDate:u,endDate:d,isConfirmed:i,isArchived:s,isPast:m,isCurrent:p,hasMissingMaterials:n,hasNotReturnedMaterials:l,isInventoryDone:o})},La=Sa,Ia=(a("238b"),function(e){var t=e.isConfirmed,a=e.isArchived,i=e.isPast,s=e.isInventoryDone,n=e.hasNotReturnedMaterials;return a?"archive":t?i?i&&s&&!n?"check":i&&!s?"clock":null:"check":"question"}),Ta=Ia,Aa=(a("52e5"),a("389c"),a("e67d")),Oa=a.n(Aa),ja=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{Dropdown__item:!0,"Dropdown__item--active":e}},Fa={name:"Dropdown",directives:{ClickOutside:Oa.a},props:{variant:{type:String,default:"default"}},data:function(){return{isOpen:!1}},watch:{$route:function(){this.closeDropdown()}},methods:{toggleDropdown:function(){this.isOpen=!this.isOpen},closeDropdown:function(){this.isOpen=!1}},render:function(){var e=arguments[0],t=this.isOpen,a=this.toggleDropdown,i=this.closeDropdown,s=this.variant,n=this.$slots,r=n.buttonText,o=n.title,l=n.items,c=["Dropdown",{"Dropdown--open":t,"Dropdown--actions":"actions"===s}];return e("div",{class:c,directives:[{name:"click-outside",value:i}]},[e("div",{class:"Dropdown__button",on:{click:a}},[e("span",{class:"Dropdown__button__text"},[r||e("i",{class:"Dropdown__button__icon fas fa-ellipsis-h"})]),r&&e("i",{class:"Dropdown__button__chevron fas fa-chevron-".concat(t?"up":"down")})]),e("div",{class:"Dropdown__menu"},[o&&e("h3",{class:"Dropdown__menu__title"},[o]),e("ul",{class:"Dropdown__menu__items"},[l])])])}},qa=(a("69fa"),{name:"DuplicateEvent",props:{event:Object},data:function(){return{dates:{startDate:null,endDate:null},startDatepickerOptions:{format:"d MMMM yyyy",disabled:{from:null,to:new Date}},endDatepickerOptions:{format:"d MMMM yyyy",disabled:{from:null,to:null}},error:null,validationErrors:null,isSaving:!1}},computed:{duration:function(){var e=this.dates,t=e.startDate,a=e.endDate;return t&&a?r()(a).diff(t,"days")+1:null},itemsCount:function(){return Ea(this.event.materials)}},methods:{refreshDatesLimits:function(){var e=this.dates.startDate;e&&(this.endDatepickerOptions.disabled.to=r()(e).toDate())},handleStartDateChange:function(e){var t=e.newDate,a=this.dates.endDate;if(a){var i=r()(t),s=r()(a);s.isBefore(i)&&(this.dates.endDate=i.toDate())}this.refreshDatesLimits()},handleSubmit:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isSaving){t.next=2;break}return t.abrupt("return");case 2:return e.isSaving=!0,e.error=!1,e.validationErrors=!1,a=e.$store.state.auth.user,i={user_id:a.id,start_date:r()(e.dates.startDate).startOf("day").format(ae),end_date:r()(e.dates.endDate).endOf("day").format(ae)},t.prev=7,s="events/".concat(e.event.id,"/duplicate"),t.next=11,e.$http.post(s,i);case 11:e.$emit("close"),t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](7),e.error=t.t0,l=(null===(n=t.t0.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.error)||{code:0,details:{}},c=l.code,u=l.details,400===c&&(e.validationErrors=Object(g["a"])({},u));case 19:return t.prev=19,e.isSaving=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[7,14,19,22]])})))()},handleClose:function(){this.$emit("close")}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.dates,s=this.duration,n=this.itemsCount,r=this.error,o=this.validationErrors,l=this.startDatepickerOptions,c=this.endDatepickerOptions,u=this.refreshDatesLimits,d=this.handleStartDateChange,m=this.handleSubmit,p=this.handleClose,h=this.event,f=h.title,v=h.location,_=h.beneficiaries,g=h.assignees;return t("div",{class:"DuplicateEvent"},[t("div",{class:"DuplicateEvent__header"},[t("h2",{class:"DuplicateEvent__header__title"},[a("duplicate-the-event",{title:f})]),t("button",{class:"DuplicateEvent__header__btn-close",on:{click:p}},[t("i",{class:"fas fa-times"})])]),t("div",{class:"DuplicateEvent__main"},[t("h4",{class:"DuplicateEvent__main__help"},[a("dates-of-duplicated-event")]),t("div",{class:"DuplicateEvent__main__dates"},[t("div",{class:"DuplicateEvent__main__dates__fields"},[t(ze,{attrs:{name:"start_date",label:"start-date",type:"date",required:!0,errors:null===o||void 0===o?void 0:o.start_date,datepickerOptions:l},on:{change:d},model:{value:i.startDate,callback:function(t){e.$set(i,"startDate",t)}}}),t(ze,{attrs:{name:"end_date",label:"end-date",type:"date",required:!0,errors:null===o||void 0===o?void 0:o.end_date,datepickerOptions:c},on:{change:u},model:{value:i.endDate,callback:function(t){e.$set(i,"endDate",t)}}})]),t("div",{class:"DuplicateEvent__main__dates__duration"},[s&&t("span",[t("i",{class:"fas fa-clock"})," ",a("duration-days",{duration:s},s)])])]),t("div",{class:"DuplicateEvent__main__infos"},[v&&t(kt,{attrs:{location:v}}),t(Dt,{attrs:{type:"beneficiaries",persons:_.map((function(e){var t=e.id,a=e.full_name;return{id:t,name:a}})),warningEmptyText:a("page-events.warning-no-beneficiary")}}),t(Dt,{attrs:{type:"technicians",persons:g.map((function(e){var t=e.id,a=e.full_name;return{id:t,name:a}}))}}),t("div",{class:"DuplicateEvent__main__infos__items-count"},[t("i",{class:"fas fa-box"})," ",a("items-count",{count:n},n)])]),r&&t("p",{class:"DuplicateEvent__main__error"},[t("i",{class:"fas fa-exclamation-triangle"})," ",r.message])]),t("hr",{class:"DuplicateEvent__separator"}),t("div",{class:"DuplicateEvent__footer"},[t("button",{on:{click:m},class:"success"},[t("i",{class:"fas fa-check"})," ",a("duplicate-event")]),t("button",{on:{click:p}},[t("i",{class:"fas fa-times"})," ",a("close")])])])}}),Pa={name:"CalendarEventDetailsHeaderActions",props:{event:{type:Object,required:!0}},data:function(){return{isConfirming:!1,isArchiving:!1,isDeleting:!1}},computed:{isPrintable:function(){return this.event.materials&&this.event.materials.length>0&&this.event.beneficiaries&&this.event.beneficiaries.length>0},isVisitor:function(){return this.$store.getters["auth/is"]("visitor")},isEditable:function(){var e=this.event,t=e.isPast,a=e.isConfirmed,i=e.isInventoryDone;return!t||!(i||a)},isRemovable:function(){var e=this.event,t=e.isConfirmed,a=e.isInventoryDone;return!(t||a)},isConfirmable:function(){var e;return 0===(null===(e=this.event.materials)||void 0===e?void 0:e.length)},isEndToday:function(){return this.event.endDate.isSame(new Date,"day")},eventSummaryPdfUrl:function(){var e=_.baseUrl,t=this.event||{id:null},a=t.id;return"".concat(e,"/events/").concat(a,"/pdf")}},methods:{toggleConfirmed:function(){this.setEventConfirmation(!this.event.isConfirmed)},setEventConfirmation:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isConfirming){a.next=2;break}return a.abrupt("return");case 2:return t.isConfirming=!0,i=t.event.id,a.prev=4,s="events/".concat(i),a.next=8,t.$http.put(s,{id:i,is_confirmed:e});case 8:n=a.sent,r=n.data,t.$emit("saved",r),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](4),t.$emit("error",a.t0);case 16:return a.prev=16,t.isConfirming=!1,a.finish(16);case 19:case"end":return a.stop()}}),a,null,[[4,13,16,19]])})))()},toggleArchived:function(){this.setEventArchived(!this.event.isArchived)},setEventArchived:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isArchiving){a.next=2;break}return a.abrupt("return");case 2:return t.isArchiving=!0,i=t.event.id,a.prev=4,s="events/".concat(i),a.next=8,t.$http.put(s,{id:i,is_archived:e});case 8:n=a.sent,r=n.data,t.$emit("saved",r),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](4),t.$emit("error",a.t0);case 16:return a.prev=16,t.isArchiving=!1,a.finish(16);case 19:case"end":return a.stop()}}),a,null,[[4,13,16,19]])})))()},handleDelete:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.isVisitor,i=e.isRemovable,s=e.isDeleting,!a&&i&&!s){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,ut.ConfirmDelete(e.$t,"calendar");case 5:if(n=t.sent,n.value){t.next=8;break}return t.abrupt("return");case 8:return e.isDeleting=!0,r=e.event.id,t.prev=10,o="events/".concat(r),t.next=14,e.$http.delete(o);case 14:e.$emit("deleted",r),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](10),e.$emit("error",t.t0);case 20:return t.prev=20,e.isDeleting=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[10,17,20,23]])})))()},askDuplicate:function(){var e=this.event,t=Object(g["a"])(Object(g["a"])({},xe),{},{name:"duplicateEventStartDateModal",width:600,draggable:!0,clickToClose:!1});this.$modal.show(qa,{event:e},t)}},render:function(){var e=arguments[0],t=this.$t,a=this.isVisitor,i=this.isEditable,s=this.isConfirmable,n=this.isPrintable,r=this.isRemovable,o=this.isEndToday,l=this.eventSummaryPdfUrl,c=this.isArchiving,u=this.isConfirming,d=this.isDeleting,m=this.toggleConfirmed,p=this.toggleArchived,h=this.handleDelete,f=this.askDuplicate;if(a)return n?e("a",{attrs:{href:l,target:"_blank"},class:"button outline"},[e("i",{class:"fas fa-print"})," ",t("print")]):null;var v=this.event,_=v.id,b=v.isPast,y=v.isConfirmed,k=v.isInventoryDone,C=v.isArchived;return e("div",{class:"EventDetailsHeaderActions"},[n&&e("a",{attrs:{href:l,target:"_blank"},class:"button outline"},[e("i",{class:"fas fa-print"})," ",t("print")]),i&&e("router-link",{attrs:{to:"/events/".concat(_),custom:!0}},[function(a){var i=a.navigate;return e("button",{class:"info",on:{click:i}},[e("i",{class:"fas fa-edit"})," ",t("action-edit")])}]),(b||o)&&!C&&e("router-link",{attrs:{to:"/event-return/".concat(_),custom:!0}},[function(a){var i=a.navigate;return e("button",{class:"info",on:{click:i}},[e("i",{class:"fas fa-tasks"})," ",t("return-inventory")])}]),e(Fa,{attrs:{variant:"actions"}},[e("template",{slot:"items"},[!b&&e("button",{class:Object(g["a"])(Object(g["a"])({},ja()),{},{info:y,success:!y}),attrs:{disabled:s},on:{click:m}},[!u&&!y&&e("i",{class:"fas fa-check"}),!u&&y&&e("i",{class:"fas fa-hourglass-half"}),u&&e("i",{class:"fas fa-circle-notch fa-spin"})," ",t(y?"unconfirm-event":"confirm-event")]),b&&k&&e("button",{class:Object(g["a"])(Object(g["a"])({},ja()),{},{info:!C}),on:{click:p}},[!c&&e("i",{class:"fas fa-archive"}),c&&e("i",{class:"fas fa-circle-notch fa-spin"})," ",t(C?"unarchive-event":"archive-event")]),e("button",{class:Object(g["a"])(Object(g["a"])({},ja()),{},{warning:!0}),on:{click:f}},[e("i",{class:"fas fa-copy"})," ",t("duplicate-event")]),r&&e("button",{class:Object(g["a"])(Object(g["a"])({},ja()),{},{danger:!0}),on:{click:h}},[!d&&e("i",{class:"fas fa-trash"}),d&&e("i",{class:"fas fa-circle-notch fa-spin"})," ",t("delete-event")])])])])}},Ba={name:"CalendarEventDetailsHeader",props:{event:{type:Object,required:!0}},computed:{mainIcon:function(){var e=this.event.hasMissingMaterials||this.event.hasNotReturnedMaterials;return e?"exclamation-triangle":Ta(this.event)},fromToDates:function(){var e,t;return{from:(null===(e=this.event)||void 0===e?void 0:e.startDate.format("L"))||"?",to:(null===(t=this.event)||void 0===t?void 0:t.endDate.format("L"))||"?"}}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.event,s=this.mainIcon,n=this.fromToDates;return t("header",{class:"EventDetailsHeader"},[t("div",{class:"EventDetailsHeader__status"},[t("i",{class:"fas fa-".concat(s)})]),t("div",{class:"EventDetailsHeader__details"},[t("h1",{class:"EventDetailsHeader__details__title"},[i.title]),t("div",{class:"EventDetailsHeader__details__location-dates"},[a("from-date-to-date",n),i.isCurrent&&t("span",{class:"EventDetailsHeader__details__in-progress"},["(",a("in-progress"),")"])])]),t(Pa,{attrs:{event:i},on:{saved:function(t){e.$emit("saved",t)},deleted:function(t){e.$emit("deleted",t)},error:function(t){e.$emit("error",t)}}}),t("button",{class:"close",on:{click:function(){e.$emit("close")}}},[t("i",{class:"fas fa-times"})])])}},Ra={name:"EventDetails",components:{Header:Ba,Tabs:pt["b"],Tab:pt["a"],Help:Be,LocationText:kt,PersonsList:Dt,EventMaterials:jt,EventMissingMaterials:Ut,ReturnInventorySummary:zt,EventEstimates:da,EventBilling:wa,EventTotals:Ma},props:{eventId:{type:Number,required:!0}},data:function(){return{event:null,beneficiaries:[],discountRate:0,assignees:[],showBilling:"none"!==_.billingMode,lastBill:null,lastEstimate:null,successMessage:null,error:null,isLoading:!1,isCreating:!1,deletingId:null}},created:function(){this.getEvent()},computed:{hasMaterials:function(){var e,t;return(null===(e=this.event)||void 0===e||null===(t=e.materials)||void 0===t?void 0:t.length)>0},hasMaterialsProblems:function(){var e,t,a;return(null===(e=this.event)||void 0===e?void 0:e.hasMissingMaterials)&&!(null!==(t=this.event)&&void 0!==t&&t.is_return_inventory_done)||(null===(a=this.event)||void 0===a?void 0:a.hasNotReturnedMaterials)},userCanEditBill:function(){return this.$store.getters["auth/is"](["admin","member"])}},methods:{getEvent:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.error=null,e.successMessage=null,e.isLoading=!0,a=e.$props.eventId,i="events/".concat(a),t.next=8,e.$http.get(i);case 8:s=t.sent,n=s.data,e.setData(n),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),e.handleError(t.t0);case 16:return t.prev=16,e.isLoading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})))()},handleChangeTab:function(){this.error=null,this.successMessage=null},handleCreateEstimate:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isCreating&&!t.deletingId){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,t.error=null,t.successMessage=null,t.isCreating=!0,i=t.event.id,a.next=9,t.$http.post("events/".concat(i,"/estimate"),{discountRate:e});case 9:s=a.sent,n=s.data,t.event.estimates.unshift(n),t.lastEstimate=Object(g["a"])(Object(g["a"])({},n),{},{date:r()(n.date)}),t.updateDiscountRate(),t.successMessage=t.$t("estimate-created"),a.next=20;break;case 17:a.prev=17,a.t0=a["catch"](2),t.handleError(a.t0);case 20:return a.prev=20,t.isCreating=!1,a.finish(20);case 23:case"end":return a.stop()}}),a,null,[[2,17,20,23]])})))()},handleDeleteEstimate:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,o,l,c,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.deletingId&&!t.isCreating){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,ut.ConfirmDelete(t.$t,"estimate");case 4:if(i=a.sent,s=i.value,s){a.next=8;break}return a.abrupt("return");case 8:return a.prev=8,t.error=null,t.successMessage=null,t.deletingId=e,a.next=14,t.$http.delete("estimates/".concat(e));case 14:n=a.sent,o=n.data,l=t.event.estimates,c=l.filter((function(e){return e.id!==o.id})),t.event.estimates=c,u=Object(T["a"])(c,1),d=u[0],t.lastEstimate=d?Object(g["a"])(Object(g["a"])({},d),{},{date:r()(d.date)}):null,t.updateDiscountRate(),t.successMessage=t.$t("estimate-deleted"),a.next=28;break;case 25:a.prev=25,a.t0=a["catch"](8),t.handleError(a.t0);case 28:return a.prev=28,t.deletingId=null,a.finish(28);case 31:case"end":return a.stop()}}),a,null,[[8,25,28,31]])})))()},handleCreateBill:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.deletingId&&!t.isCreating){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,t.error=null,t.successMessage=null,t.isCreating=!0,i=t.$props.eventId,s="events/".concat(i,"/bill"),a.next=10,t.$http.post(s,{discountRate:e});case 10:n=a.sent,o=n.data,t.event.bills.unshift(o),t.lastBill=Object(g["a"])(Object(g["a"])({},o),{},{date:r()(o.date)}),t.updateDiscountRate(),t.successMessage=t.$t("bill-created"),a.next=21;break;case 18:a.prev=18,a.t0=a["catch"](2),t.handleError(a.t0);case 21:return a.prev=21,t.isCreating=!1,a.finish(21);case 24:case"end":return a.stop()}}),a,null,[[2,18,21,24]])})))()},setEventIsBillable:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.isLoading||e.deletingId||e.isCreating)){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.error=null,e.successMessage=null,e.isLoading=!0,a=e.$props.eventId,i={is_billable:!0},t.next=10,e.$http.put("events/".concat(a),i);case 10:s=t.sent,n=s.data,e.setData(n),e.successMessage=e.$t("event-is-now-billable"),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](2),e.handleError(t.t0);case 19:return t.prev=19,e.isLoading=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})))()},handleSavedFromHeader:function(e){this.error=null,this.setData(e),this.$emit("event-updated",e)},handleDeletedFromHeader:function(){this.error=null,this.$emit("close")},handleError:function(e){this.error=e,this.isLoading=!1},setData:function(e){this.event=Object(g["a"])(Object(g["a"])({},La(e)),e),e.beneficiaries&&(this.beneficiaries=e.beneficiaries.map((function(e){return{id:e.id,name:e.full_name,company_id:e.company_id?e.company_id:null,company:e.company?e.company.legal_name:null}}))),e.assignees&&(this.assignees=e.assignees.map((function(e){return{id:e.id,name:e.full_name}})));var t=Object(T["a"])(e.bills,1),a=t[0],i=Object(T["a"])(e.estimates,1),s=i[0];a&&(this.lastBill=Object(g["a"])(Object(g["a"])({},a),{},{date:r()(a.date)})),s&&(this.lastEstimate=Object(g["a"])(Object(g["a"])({},s),{},{date:r()(s.date)})),this.updateDiscountRate()},updateDiscountRate:function(){this.discountRate=ft(this.lastBill,this.lastEstimate)}}},Ua=Ra,Na=(a("3293"),Object(ge["a"])(Ua,dt,mt,!1,null,null,null)),Va=Na.exports,Ha=(a("4fad"),a("1cc1"),a("27f7")),za=function(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))},Qa=function(e){if(e.items instanceof Ha["a"]||e.items instanceof Ha["b"])return e.items;var t=function(t){if(Array.isArray(t)){var a=new Ha["a"](t).getIds(),i=za(e.data.getIds(),a);e.data.update(t),e.data.remove(i)}};return e.$watch("items",t,{deep:!0}),new Ha["a"](e.items)},Ga={name:"Timeline",props:{items:{type:[Array,Ha["a"],Ha["b"]],default:function(){return[]}},options:{type:Object}},data:function(){return{data:null}},created:function(){this.timeline=null},mounted:function(){var e=this;this.data=Qa(this),this.timeline=new Ha["c"](this.$refs.visualization,this.data,this.fullOptions);var t={itemover:"item-over",itemout:"item-out",rangechanged:"range-changed",doubleClick:"double-click",click:"click"};Object.entries(t).forEach((function(t){var a=Object(T["a"])(t,2),i=a[0],s=a[1];e.timeline.on(i,(function(t){e.$emit(s,t)}))}));var a={add:"item-added",update:"item-updated",remove:"item-removed"};Object.entries(a).forEach((function(t){var a=Object(T["a"])(t,2),i=a[0],s=a[1];e.data.on(i,(function(t,a,i){e.$emit(s,{event:t,properties:a,senderId:i})}))}))},computed:{fullOptions:function(){var e=this;return Object(g["a"])(Object(g["a"])({xss:{filterOptions:{whiteList:{i:"class",strong:"class",em:"class"}}},tooltip:{followMouse:!0,overflowMethod:"flip"},moment:function(e){return r()(e)}},this.options||{}),{},{onMove:function(t,a){e.$emit("item-moved",t,a)},onRemove:function(t,a){e.$emit("item-remove",t,a)}})}},watch:{fullOptions:{deep:!0,handler:function(){this.timeline.setOptions(this.fullOptions)}}},beforeDestroy:function(){this.timeline.destroy()},methods:{moveTo:function(e,t){this.timeline.moveTo(e,t)}},render:function(){var e=arguments[0];return e("div",{ref:"visualization"})}},Ya=Ga,Wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"CalendarHeader"},[a("div",{staticClass:"CalendarHeader__timeline-actions"},[a("div",{staticClass:"CalendarHeader__center-date"},[a("FormField",{attrs:{name:"centerDate",label:"page-calendar.center-on",type:"date","datepicker-options":e.datepickerOptions},on:{change:e.setCenterDate},model:{value:e.centerDate,callback:function(t){e.centerDate=t},expression:"centerDate"}})],1),a("button",{staticClass:"CalendarHeader__button info",attrs:{disabled:e.isToday,title:e.$t("page-calendar.center-on-today")},on:{click:function(t){return e.centerToday()}}},[a("i",{staticClass:"fas fa-compress-arrows-alt"}),a("span",{staticClass:"CalendarHeader__button__title"},[e._v(e._s(e.$t("page-calendar.center-on-today")))])]),a("button",{staticClass:"CalendarHeader__button info",attrs:{title:e.$t("action-refresh"),disabled:e.isLoading},on:{click:function(t){return e.refresh()}}},[a("i",{staticClass:"fas fa-sync-alt"}),a("span",{staticClass:"CalendarHeader__button__title"},[e._v(e._s(e.$t("action-refresh")))])])]),a("div",{staticClass:"CalendarHeader__filters"},[e.parks.length>1?a("div",{staticClass:"CalendarHeader__filter",class:{"CalendarHeader__filter--active":!!e.filters.park}},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.filters.park,expression:"filters.park"}],staticClass:"CalendarHeader__filter__select",on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.filters,"park",t.target.multiple?a:a[0])},e.handleFilterParkChange]}},[a("option",{attrs:{value:""}},[e._v(" "+e._s(e.$t("page-calendar.display-all-parks"))+" ")]),e._l(e.parks,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2)]):e._e(),a("div",{staticClass:"CalendarHeader__filter",class:{"CalendarHeader__filter--active":e.filters.hasMissingMaterials}},[a("label",{staticClass:"CalendarHeader__filter__label"},[e._v(" "+e._s(e.$t("page-calendar.event-with-missing-material-only"))+" ")]),a("SwitchToggle",{attrs:{value:e.filters.hasMissingMaterials},on:{input:e.handleFilterMissingMaterialChange}})],1)]),a("div",{staticClass:"CalendarHeader__loading-container"},[e.isLoading?a("div",{staticClass:"CalendarHeader__loading"},[a("i",{staticClass:"fas fa-circle-notch fa-spin"}),e._v(" "+e._s(e.$t("loading"))+" ")]):e._e()]),a("div",{staticClass:"CalendarHeader__actions"},[a("router-link",{directives:[{name:"show",rawName:"v-show",value:!e.isVisitor,expression:"!isVisitor"}],attrs:{to:"/events/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"success",on:{click:i}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-calendar.add-event"))+" ")])]}}])})],1)])},Ka=[],Xa={name:"CalendarHeader",components:{Help:Be,FormField:ze,SwitchToggle:Ve},props:{isLoading:Boolean},data:function(){return{centerDate:"",datepickerOptions:{format:"d MMMM yyyy"},filters:{park:this.$route.query.park||"",hasMissingMaterials:!1}}},computed:{parks:function(){return this.$store.state.parks.list},isToday:function(){return r()(this.centerDate).isSame(r()(),"day")},isVisitor:function(){return this.$store.getters["auth/is"]("visitor")}},mounted:function(){this.$store.dispatch("parks/fetch")},methods:{setCenterDate:function(e){var t=r()(e.newDate).hour(12).minute(0).toDate();this.$emit("set-center-date",t)},centerToday:function(){var e=r()().hour(12).minute(0).toDate();this.$emit("set-center-date",e)},refresh:function(){this.$emit("refresh")},changePeriod:function(e){var t=r()(e.start),a=r()(e.end),i=a.diff(t,"hours");this.centerDate=t.add(i/2,"hours").format()},handleFilterMissingMaterialChange:function(e){this.filters.hasMissingMaterials=e,this.$emit("filterMissingMaterials",e)},handleFilterParkChange:function(e){var t=e.currentTarget.value;this.$emit("filterByPark",t)}}},Za=Xa,Ja=(a("8d7f"),Object(ge["a"])(Za,Wa,Ka,!1,null,null,null)),ei=Ja.exports,ti=(a("f44c"),{name:"CalendarCaption",render:function(){var e=arguments[0],t=this.$t;return e("div",{class:"CalendarCaption"},[e("div",{class:"CalendarCaption__group"},[e("h4",{class:"CalendarCaption__title"},[t("page-calendar.caption.title")]),e("div",{class:"timeline-event timeline-event--past timeline-event--archived"},[e("i",{class:"fas fa-archive"})," ",t("page-calendar.caption.archived")])]),e("div",{class:"CalendarCaption__group"},[e("div",{class:"timeline-event timeline-event--past"},[e("i",{class:"fas fa-check"})," ",t("page-calendar.caption.past-and-ok")]),e("div",{class:"timeline-event timeline-event--past timeline-event--with-warning"},[e("i",{class:"fas fa-exclamation-triangle"})," ",t("page-calendar.caption.past-material-not-returned")])]),e("div",{class:"CalendarCaption__group"},[e("div",{class:"timeline-event timeline-event--past timeline-event--no-return-inventory"},[e("i",{class:"fas fa-clock"})," ",t("page-calendar.caption.past-no-inventory")]),e("div",{class:"timeline-event timeline-event--past timeline-event--not-confirmed"},[e("i",{class:"fas fa-question"})," ",t("page-calendar.caption.past-not-confirmed")])]),e("div",{class:"CalendarCaption__group"},[e("div",{class:"timeline-event timeline-event--current"},[e("i",{class:"fas fa-check"})," ",t("page-calendar.caption.current-confirmed")]),e("div",{class:"timeline-event timeline-event--current timeline-event--not-confirmed"},[e("i",{class:"fas fa-question"})," ",t("page-calendar.caption.current-not-confirmed")])]),e("div",{class:"CalendarCaption__group"},[e("div",{class:"timeline-event"},[e("i",{class:"fas fa-check"})," ",t("page-calendar.caption.future-confirmed")]),e("div",{class:"timeline-event timeline-event--not-confirmed"},[e("i",{class:"fas fa-question"})," ",t("page-calendar.caption.future-not-confirmed")])])])}}),ai=function(e){var t=e.isPast,a=e.isCurrent,i=e.isConfirmed,s=e.isArchived,n=e.hasMissingMaterials,r=e.isInventoryDone,o=e.hasNotReturnedMaterials,l=["timeline-event"];return t&&(l.push("timeline-event--past"),i&&!r&&l.push("timeline-event--no-return-inventory")),s&&l.push("timeline-event--archived"),a&&l.push("timeline-event--current"),i||l.push("timeline-event--not-confirmed"),(n||o)&&l.push("timeline-event--with-warning"),l},ii=ai,si=function(e){var t=e.isPast,a=e.isCurrent,i=e.isConfirmed,s=e.isInventoryDone,n=e.isArchived,r=e.hasMissingMaterials,o=e.hasMissingUnits,l=void 0!==o&&o,c=e.hasNotReturnedMaterials,u=[];return t&&c&&u.push({icon:"exclamation-triangle",i18nKey:"this-event-has-not-returned-materials"}),n?(u.push({icon:"archive",i18nKey:"this-event-is-archived"}),u):(t&&!i&&u.push({icon:"history",i18nKey:"this-event-is-past"}),t||i||u.push({icon:"question",i18nKey:"this-event-is-not-confirmed"}),a&&u.push({icon:"running",i18nKey:"this-event-is-currently-running"}),i&&u.push({icon:t?"lock":"check",i18nKey:t?"this-event-is-locked":"this-event-is-confirmed"}),(r||l)&&u.push({icon:"exclamation-triangle",i18nKey:"this-event-has-missing-materials"}),t&&!s&&u.push({icon:"exclamation-triangle",i18nKey:"this-event-needs-its-return-inventory"}),u)},ni=si,ri=function(e,t){var a=function(e,t){return e?'<i class="fas fa-'.concat(e,'"></i> ').concat(t):t},i=La(e),s=i.title,n=i.location,r=i.startDate,o=i.endDate,l=i.isPast,c=i.isConfirmed,u=i.hasMissingMaterials,d=i.isInventoryDone,m=i.hasNotReturnedMaterials,p=i.beneficiaries,h=i.assignees,f=s;(u||m)&&(f=a("exclamation-triangle",f));var v=a(Ta(i),f),_=a("map-marker-alt",n||"?");n&&(v="".concat(v," − ").concat(_));var b=a("clock",t("from-date-to-date",{from:r.format("L"),to:o.format("L")})),y=a("exclamation-triangle","<em>(".concat(t("missing-beneficiary"),")</em>"));if(p.length>0){var k=p.map((function(e){return e.full_name}));y=a("address-book","".concat(t("for")," ").concat(k.join(", ")))}var C="";if(h.length>0){var w=h.map((function(e){return e.full_name}));C=a("people-carry","".concat(t("with")," ").concat(w.join(", ")))}var $=ni(i).map((function(e){var i=e.icon,s=e.i18nKey;return a(i,t("page-calendar.".concat(s)))})).join("\n");return Object(g["a"])(Object(g["a"])({},i),{},{content:v,start:r,end:o,editable:!c||l&&!c&&!d,className:ii(i).join(" "),title:["<strong>".concat(s,"</strong>"),"\n".concat(_,"\n").concat(b,"\n").concat(y,"\n").concat(C,"\n"),$].join("\n")})},oi=ri,li=864e5,ci={name:"Calendar",components:{CalendarHeader:ei,Timeline:Ya,EventDetails:Va,Help:Be,CalendarCaption:ti},data:function(){var e=r()().subtract(2,"days").startOf("day"),t=r()().add(5,"days").endOf("day"),a=localStorage.getItem("calendarStart"),i=localStorage.getItem("calendarEnd");a&&i&&(e=a,t=i);var s=this.$store.getters["auth/is"]("visitor"),n=this.$route.query.park;return{help:"page-calendar.help",error:null,isLoading:!1,fetchStart:r()().subtract(8,"days").startOf("day"),fetchEnd:r()().add(1,"months").endOf("month"),isModalOpened:!1,hasMissingMaterialFilter:!1,parkId:n?Number.parseInt(n,10):null,events:[],allEvents:[],timelineOptions:{selectable:!s,editable:{add:!1,updateTime:!0,updateGroup:!1,remove:!0,overrideItems:!1},start:e,end:t,locale:this.$store.state.i18n.locale,minHeight:"100%",orientation:"top",zoomMin:7*li,zoomMax:6*li*30}}},mounted:function(){this.getEventsData()},methods:{filterEvents:function(){var e=this,t=Object(st["a"])(this.allEvents);this.parkId&&(t=t.filter((function(t){var a=t.parks;return null===a||void 0===a?void 0:a.includes(e.parkId)}))),this.hasMissingMaterialFilter&&(t=t.filter((function(e){var t=e.hasMissingMaterials;return!!t}))),this.events=t},getEventsData:function(){var e=this;this.error=null,this.isLoading=!0,this.isModalOpened=!1;var t={start:this.fetchStart.format("YYYY-MM-DD HH:mm:ss"),end:this.fetchEnd.format("YYYY-MM-DD HH:mm:ss")};this.$http.get(this.$route.meta.resource,{params:t}).then((function(t){var a=t.data;e.events=a.data.map((function(t){return oi(t,e.$t)})),e.allEvents=Object(st["a"])(e.events),e.filterEvents(),e.isLoading=!1})).catch((function(t){e.showError(t)}))},setCenterDate:function(e){this.$refs.Timeline.moveTo(e)},onItemOver:function(){this.help="page-calendar.help-timeline-event-operations"},onItemOut:function(){this.help="page-calendar.help"},onItemMoved:function(e,t){var a=this,i=this.$store.getters["auth/is"]("visitor");if(!i){var s="".concat(this.$route.meta.resource,"/").concat(e.id),n=r()(e.end);0===n.hour()&&n.subtract(1,"day").endOf("day");var o={start_date:r()(e.start).format(ae),end_date:n.format(ae)};this.error=null,this.isLoading=!0,this.$http.put(s,o).then((function(){a.isLoading=!1,a.help={type:"success",text:"page-calendar.event-saved"},t(e),a.getEventsData()})).catch((function(e){t(null),a.showError(e)}))}},onItemRemove:function(e,t){var a=this,i=this.$store.getters["auth/is"]("visitor");i||e.isConfirmed||ut.ConfirmDelete(this.$t,"calendar").then((function(i){if(i.value){a.error=null,a.isLoading=!0;var s="".concat(a.$route.meta.resource,"/").concat(e.id);a.$http.delete(s).then((function(){t(e)}))}else t(null)}))},onItemRemoved:function(){this.isLoading&&(this.help={type:"success",text:"page-calendar.event-deleted"},this.error=null,this.isLoading=!1)},onDoubleClick:function(e){if(!this.isModalOpened){var t=e.item;if(t)return this.openEventModal(t),void(this.isModalOpened=!0);var a=r()(e.time).startOf("day").format(ie);this.$router.push({path:"/events/new",query:{startDate:a}})}},onRangeChanged:function(e){var t=Object.fromEntries(["start","end"].map((function(t){return[t,e[t].getTime()]})));localStorage.setItem("calendarStart",t.start),localStorage.setItem("calendarEnd",t.end),this.$refs.Header.changePeriod(t);var a=!1;this.fetchStart.isAfter(t.start)&&(this.fetchStart=r()(t.start).subtract(8,"days").startOf("day"),a=!0),this.fetchEnd.isBefore(t.end)&&(this.fetchEnd=r()(t.end).add(1,"months").endOf("month"),a=!0),a&&this.getEventsData()},openEventModal:function(e){var t=this;this.$modal.show(Va,{eventId:e},xe,{"before-close":function(){t.getEventsData()}})},showError:function(e){this.error=e,this.isLoading=!1},handleFilterMissingMaterial:function(e){this.hasMissingMaterialFilter=e,this.filterEvents()},handleFilterByPark:function(e){this.parkId=""===e?null:Number.parseInt(e,10),this.filterEvents()}}},ui=ci,di=(a("f59e"),Object(ge["a"])(ui,at,it,!1,null,null,null)),mi=di.exports,pi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"Event"},[a("div",{staticClass:"Event__panel"},[a("Breadcrumb",{attrs:{event:e.event,steps:e.steps,"current-step":e.currentStep},on:{openStep:e.openStep}}),a("MiniSummary"),a("div",{staticClass:"Event__panel__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1)],1),1===e.currentStep?a("EventStep1",{attrs:{event:e.event},on:{loading:e.startLoading,error:e.displayError,updateEvent:e.setEventData,gotoStep:e.openStep}}):e._e(),2===e.currentStep?a("EventStep2",{attrs:{event:e.event},on:{loading:e.startLoading,stopLoading:e.stopLoading,error:e.displayError,updateEvent:e.setEventData,gotoStep:e.openStep}}):e._e(),3===e.currentStep?a("EventStep3",{attrs:{event:e.event},on:{loading:e.startLoading,stopLoading:e.stopLoading,error:e.displayError,updateEvent:e.setEventData,gotoStep:e.openStep}}):e._e(),4===e.currentStep?a("EventStep4",{attrs:{event:e.event},on:{loading:e.startLoading,error:e.displayError,updateEvent:e.setEventData,gotoStep:e.openStep}}):e._e(),5===e.currentStep?a("EventStep5",{attrs:{event:e.event},on:{error:e.displayError,updateEvent:e.setEventData}}):e._e()],1)])])},hi=[],fi=(a("a4d3"),a("e01a"),function(e,t){if(e===t)return!0;if(!e||!t)return!1;var a=e;r.a.isMoment(e)||(a=r()(e));var i=t;return r.a.isMoment(t)||(i=r()(t)),a.isSame(i,"day")}),vi=fi,_i=new D["a"].Store({state:{title:"",dates:{start:null,end:null},location:null,description:null,materials:[],isConfirmed:!1,isBillable:!0,isSaved:!1},mutations:{reset:function(e){e.title="",e.dates={start:null,end:null},e.location=null,e.description=null,e.materials=[],e.isConfirmed=!1,e.isBillable=!0,e.isSaved=!0},init:function(e,t){e.title=t.title,e.dates={start:t.start_date,end:t.end_date},e.location=t.location,e.description=t.description,e.isBillable=t.is_billable,e.materials=t.materials,e.isConfirmed=t.is_confirmed},setIsSaved:function(e,t){e.isSaved=t}},actions:{checkIsSaved:function(e,t){var a=e.commit,i=e.state,s=t.title===i.title&&vi(t.start_date,i.dates.start)&&vi(t.end_date,i.dates.end)&&t.location===i.location&&t.description===i.description&&t.is_confirmed===i.isConfirmed&&t.is_billable===i.isBillable;a("setIsSaved",s)}}}),gi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Breadcrumb"},e._l(e.steps,(function(t){return a("div",{key:t.id,staticClass:"Breadcrumb__step",class:{"Breadcrumb__step--current":e.isCurrent(t),"Breadcrumb__step--active":e.isActive(t),"Breadcrumb__step--validated":!e.isCurrent(t)&&e.isValidated(t)},on:{click:function(a){return e.openStep(t)}}},[e.isCurrent(t)?a("i",{staticClass:"fas fa-arrow-right"}):e._e(),!e.isCurrent(t)&&e.isValidated(t)?a("i",{staticClass:"fas fa-check"}):e._e(),e._v(" "+e._s(t.id)+" - "),a("span",{staticClass:"Breadcrumb__step__name"},[e._v(" "+e._s(t.name)+" ")])])})),0)},bi=[],yi={name:"Breadcrumb",props:["event","steps","currentStep"],methods:{openStep:function(e){this.isActive(e)&&this.$emit("openStep",e.id)},isCurrent:function(e){return e.id===this.currentStep},isActive:function(e){var t=this.steps.findIndex((function(t){return t.id===e.id}));if(t<0)return!1;var a=this.steps[t-1]||null;return this.isCurrent(e)||this.isValidated(e)||a&&this.isValidated(a)},isValidated:function(e){var t=this,a=!0;return e.fields.forEach((function(e){t.event[e]&&0!==t.event[e].length||(a=!1)})),a}}},ki=yi,Ci=(a("3ed7"),Object(ge["a"])(ki,gi,bi,!1,null,null,null)),wi=Ci.exports,$i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EventMiniSummary",class:{"EventMiniSummary--confirmed":e.isConfirmed,"EventMiniSummary--not-saved":!e.isSaved}},[e.isSaved?e._e():a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.right-end",value:e.$t("page-events.not-saved"),expression:"$t('page-events.not-saved')",modifiers:{"right-end":!0}}],staticClass:"EventMiniSummary__not-saved"},[a("i",{staticClass:"fas fa-exclamation-triangle"})]),e.title?a("div",{staticClass:"EventMiniSummary__title"},[e._v(" "+e._s(e.title)+" ")]):e._e(),e.location?a("div",{staticClass:"EventMiniSummary__detail"},[e._v(" "+e._s(e.$t("in"))+" "+e._s(e.location)+" ")]):e._e(),e.dates.start&&e.dates.end?a("div",{staticClass:"EventMiniSummary__detail"},[1===e.duration?a("span",[e._v(" "+e._s(e.$t("on-date",{date:e.fromToDates.from}))+" ")]):e._e(),e.duration>1?a("span",[e._v(" "+e._s(e.$t("from-date-to-date",e.fromToDates))+" ")]):e._e(),a("br"),e._v(" "+e._s(e.$t("duration-days",{duration:e.duration},e.duration))+" "),a("br"),e.showPrices?a("span",[e._v(" "+e._s(e.$t("ratio"))+" "+e._s(e.ratio)+" ")]):e._e()]):e._e(),e.showPrices?a("div",{staticClass:"EventMiniSummary__total"},[e._v(" "+e._s(e.$t("total"))+" "),a("strong",[e._v(e._s(e.grandTotal))])]):e._e(),a("div",{staticClass:"EventMiniSummary__detail"},[e.isConfirmed?a("span",[a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(e.$t("confirmed"))+" ")]):a("span",{},[a("i",{staticClass:"far fa-question-circle"}),e._v(" "+e._s(e.$t("not-confirmed"))+" ")])])])},Ei=[],xi={name:"EventMiniSummary",computed:{title:function(){return _i.state.title},dates:function(){return _i.state.dates},location:function(){return _i.state.location},materials:function(){return _i.state.materials},isConfirmed:function(){return _i.state.isConfirmed},isSaved:function(){return _i.state.isSaved},showPrices:function(){return"none"!==_.billingMode&&_i.state.isBillable},fromToDates:function(){var e=this.dates,t=e.start,a=e.end;return{from:t?r()(t).format("L"):"",to:a?r()(a).format("L"):""}},duration:function(){var e=this.dates,t=e.start,a=e.end;return t&&a?r()(a).diff(t,"days")+1:0},ratio:function(){return _.degressiveRate(this.duration)},grandTotal:function(){var e=Jt(this.materials),t=Xt(e,this.duration);return St(t)}},methods:{formatAmount:function(e){return St(e)}}},Di=xi,Mi=(a("ae27"),Object(ge["a"])(Di,$i,Ei,!1,null,null,null)),Si=Mi.exports,Li=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"Form EventStep1",attrs:{method:"POST"},on:{submit:e.saveAndBack}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("minimal-infos"))+" "),a("span",{staticClass:"FormField__label__required"},[e._v("*")])]),a("FormField",{attrs:{name:"title",label:"title",required:"",errors:e.errors.title},on:{input:e.checkIsSavedEvent},model:{value:e.event.title,callback:function(t){e.$set(e.event,"title",t)},expression:"event.title"}}),a("div",{staticClass:"EventStep1__dates"},[a("div",{staticClass:"EventStep1__dates__fields"},[a("FormField",{attrs:{name:"start_date",label:"start-date",type:"date",required:"",errors:e.errors.start_date,"datepicker-options":e.startDatepickerOptions},on:{change:e.handleStartDateChange},model:{value:e.event.start_date,callback:function(t){e.$set(e.event,"start_date",t)},expression:"event.start_date"}}),a("FormField",{attrs:{name:"end_date",label:"end-date",type:"date",required:"",errors:e.errors.end_date,"datepicker-options":e.endDatepickerOptions},on:{change:e.refreshDatesLimits},model:{value:e.event.end_date,callback:function(t){e.$set(e.event,"end_date",t)},expression:"event.end_date"}})],1),e.duration>0?a("div",{staticClass:"EventStep1__dates__duration"},[e._v(" "+e._s(e.$t("duration-days",{duration:e.duration},e.duration))+" ")]):e._e()])],1),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("event-details"))+" ")]),a("FormField",{staticClass:"EventStep1__location",attrs:{name:"location",label:"location",errors:e.errors.location},on:{input:e.checkIsSavedEvent},model:{value:e.event.location,callback:function(t){e.$set(e.event,"location",t)},expression:"event.location"}}),a("FormField",{staticClass:"EventStep1__description",attrs:{name:"description",label:"description",type:"textarea",errors:e.errors.description},on:{input:e.checkIsSavedEvent},model:{value:e.event.description,callback:function(t){e.$set(e.event,"description",t)},expression:"event.description"}}),e.showIsBillable?a("div",{staticClass:"EventStep1__is-billable"},[a("FormField",{attrs:{name:"is_billable",label:"is-billable",type:"switch",errors:e.errors.is_billable},on:{change:e.checkIsSavedEvent},model:{value:e.event.is_billable,callback:function(t){e.$set(e.event,"is_billable",t)},expression:"event.is_billable"}}),a("div",{staticClass:"EventStep1__is-billable__help"},[a("i",{staticClass:"fas fa-arrow-right"}),e.event.is_billable?e._e():a("span",[e._v(" "+e._s(e.$t("is-not-billable-help"))+" ")]),e.event.is_billable?a("span",[e._v(" "+e._s(e.$t("is-billable-help"))+" ")]):e._e()])],1):e._e()],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"EventStep1__save-btn info",attrs:{type:"submit"}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("page-events.save-and-back-to-calendar"))+" ")]),a("button",{staticClass:"EventStep1__save-btn success",on:{click:e.saveAndNext}},[e._v(" "+e._s(e.$t("page-events.save-and-continue"))+" "),a("i",{staticClass:"fas fa-arrow-right"})])])])},Ii=[],Ti=a("15fd"),Ai={name:"EventStep1",components:{FormField:ze},props:{event:Object},data:function(){return{startDatepickerOptions:{format:"d MMMM yyyy",disabled:{from:null,to:null}},endDatepickerOptions:{format:"d MMMM yyyy",disabled:{from:null,to:null}},duration:0,showIsBillable:"partial"===_.billingMode,errors:{title:null,start_date:null,end_date:null,location:null,description:null}}},mounted:function(){this.refreshDatesLimits()},watch:{event:"refreshDatesLimits"},methods:{refreshDatesLimits:function(){var e=this.event.start_date;e&&(this.endDatepickerOptions.disabled.to=r()(e).toDate()),this.calcDuration(),this.checkIsSavedEvent()},handleStartDateChange:function(e){var t=e.newDate,a=this.event.end_date;if(a){var i=r()(t),s=r()(a);s.isBefore(i)&&(this.event.end_date=i.toDate())}this.refreshDatesLimits()},calcDuration:function(){var e=this.event,t=e.start_date,a=e.end_date;t&&a&&(this.duration=r()(a).diff(t,"days")+1)},checkIsSavedEvent:function(){_i.dispatch("checkIsSaved",this.event)},saveAndBack:function(e){e.preventDefault(),this.save({gotoStep:!1})},saveAndNext:function(e){e.preventDefault(),this.save({gotoStep:2})},displayError:function(e){var t,a;this.$emit("error",e);var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},save:function(e){var t=this;this.$emit("loading");var a=this.event.id,i=this.$route.meta.resource,s=this.$http.post,n=i;a&&(s=this.$http.put,n="".concat(i,"/").concat(a));var o=this.event,l=(o.user,o.beneficiaries,o.assignees,o.materials,Object(Ti["a"])(o,["user","beneficiaries","assignees","materials"])),c=Object(g["a"])(Object(g["a"])({},l),{},{start_date:r()(this.event.start_date).startOf("day").format(ae),end_date:r()(this.event.end_date).endOf("day").format(ae)});s(n,c).then((function(a){var i=a.data,s=e.gotoStep;s?(_i.commit("setIsSaved",!0),t.$emit("updateEvent",i),t.$emit("gotoStep",s)):t.$router.push("/")})).catch(this.displayError)}}},Oi=Ai,ji=(a("313d"),Object(ge["a"])(Oi,Li,Ii,!1,null,null,null)),Fi=ji.exports,qi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"Form EventStep2",attrs:{method:"POST"},on:{submit:e.saveAndBack}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("page-events.event-beneficiaries"))+" ")]),a("MultipleItem",{attrs:{label:"beneficiary",field:"full_name",fetchEntity:"persons",fetchParams:e.fetchParams,selectedItems:e.event.beneficiaries,createItemPath:"/beneficiaries/new",formatOptions:e.formatItemOptions,getItemLabel:e.getItemLabel},on:{itemsUpdated:e.updateItems}}),e.showBillingHelp?a("p",{staticClass:"EventStep2__help"},[a("i",{staticClass:"fas fa-info-circle"}),e._v(" "+e._s(e.$t("page-events.beneficiary-billing-help"))+" ")]):e._e()],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"EventStep2__save-btn info",attrs:{type:"submit"}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("page-events.save-and-back-to-calendar"))+" ")]),a("button",{staticClass:"EventStep2__save-btn success",on:{click:e.saveAndNext}},[e._v(" "+e._s(e.$t("page-events.save-and-continue"))+" "),a("i",{staticClass:"fas fa-arrow-right"})])])])},Pi=[],Bi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MultipleItem"},[e._l(e.notSavedSelectedItems,(function(t,i){return a("div",{key:t.id||"unknown-"+i,staticClass:"MultipleItem__item FormField"},[a("label",{staticClass:"FormField__label"},[e._v(" "+e._s(e.$t(e.label))+" "+e._s(i+1)+" ")]),a("div",{staticClass:"MultipleItem__value-field"},[t?a("span",[e._v(e._s(e.getItemLabel(t)||"N/A"))]):a("span",{staticClass:"MultipleItem__value-field--error"},[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.$t("item-not-found",{item:e.$t(e.label)}))+" ")])]),e.pivotField?a("input",{staticClass:"MultipleItem__item-pivot-field",attrs:{type:"text",placeholder:e.pivotPlaceholder},domProps:{value:e.itemsPivots[i]},on:{input:function(t){e.handlePivotChange(i,t.currentTarget.value)}}}):e._e(),a("button",{staticClass:"MultipleItem__item-action-btn danger",attrs:{title:e.$t("remove-item",{item:e.$t(e.label)})},on:{click:function(a){a.preventDefault(),e.removeItem(t.id,i)}}},[a("i",{staticClass:"fas fa-trash-alt"})])])})),e.askNewItem?a("div",{staticClass:"MultipleItem__item FormField"},[a("label",{staticClass:"FormField__label"},[e._v(" "+e._s(e.$t(e.label))+" "+e._s(e.itemsIds.length+1)+" ")]),a("VueSelect",{attrs:{filterable:!1,options:e.selectableOptions},on:{search:e.handleSearch,input:e.insertNewItem},scopedSlots:e._u([{key:"no-options",fn:function(t){var i=t.search;return[0===i.length?a("span",[e._v(" "+e._s(e.$t("start-typing-to-search"))+" ")]):e._e(),i.length>0&&i.length<e.minSearchCharacters?a("span",[e._v(" "+e._s(e.$t("type-at-least-count-chars-to-search",{count:e.minSearchCharacters-i.length},e.minSearchCharacters-i.length))+" ")]):e._e(),i.length>=e.minSearchCharacters?a("div",[a("p",[e._v(e._s(e.$t("no-result-found-try-another-search")))]),a("router-link",{attrs:{to:e.createItemPath,custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"success",on:{click:i}},[e._v(" "+e._s(e.$t("create-select-item-label",{label:e.$t(e.label)}))+" ")])]}}],null,!0)})],1):e._e()]}}],null,!1,562345421),model:{value:e.newItem,callback:function(t){e.newItem=t},expression:"newItem"}}),a("button",{staticClass:"MultipleItem__item-action-btn warning",attrs:{title:e.$t("cancel-add-item",{item:e.$t(e.label)})},on:{click:e.cancelNewItem}},[a("i",{staticClass:"fas fa-ban"})])],1):e._e(),a("div",{staticClass:"MultipleItem__actions"},[e.askNewItem?e._e():a("button",{staticClass:"success",on:{click:e.startAddItem}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("add-item",{item:e.$t(e.label)}))+" ")])])],2)},Ri=[],Ui=(a("841c"),a("4a7a")),Ni=a.n(Ui),Vi=a("b012"),Hi=a.n(Vi),zi={name:"MultipleItem",components:{VueSelect:Ni.a},props:{fetchEntity:String,fetchParams:Object,label:String,field:String,selectedItems:Array,createItemPath:String,formatOptions:Function,getItemLabel:Function,pivotField:String,pivotPlaceholder:String},data:function(){var e=this,t={value:null,label:this.$t("please-choose")},a=[];return this.pivotField&&(a=this.selectedItems.map((function(t){return t.pivot[e.pivotField]}))),{itemsIds:this.selectedItems.map((function(e){return e.id})),itemsPivots:a,notSavedSelectedItems:Object(st["a"])(this.selectedItems),minSearchCharacters:2,askNewItem:!1,fieldOptions:[],newItem:t,defaultItem:t}},computed:{selectableOptions:function(){var e=this;return this.fieldOptions.filter((function(t){return!e.itemsIds.includes(t.value)}))}},methods:{handleSearch:function(e,t){e.length<this.minSearchCharacters||(t(!0),this.search(t,e))},search:Object(Vi["debounce"])((function(e,t){var a=this,i=Object(g["a"])(Object(g["a"])({},this.fetchParams),{},{search:t,limit:10});this.$http.get(this.fetchEntity,{params:i}).then((function(e){var t=e.data;a.fieldOptions=a.formatOptions(t.data)})).catch(console.error).finally((function(){e(!1)}))}),se),handlePivotChange:function(e,t){this.itemsPivots[e]=t,this.$emit("pivotsUpdated",this.itemsPivots)},startAddItem:function(e){e.preventDefault(),this.askNewItem=!0},insertNewItem:function(){if(this.newItem&&this.newItem.value){var e=this.newItem,t=e.value,a=e.label;this.itemsIds.push(t),this.notSavedSelectedItems.push({id:t,label:a}),this.askNewItem=!1,this.newItem=this.defaultItem,this.$emit("itemsUpdated",this.itemsIds)}},cancelNewItem:function(e){e.preventDefault(),this.askNewItem=!1,this.newItem=this.defaultItem},removeItem:function(e,t){this.itemsIds=this.itemsIds.filter((function(t){return t!==e})),this.notSavedSelectedItems=this.notSavedSelectedItems.filter((function(t){return t.id!==e})),this.$emit("itemsUpdated",this.itemsIds),this.pivotField&&this.itemsPivots.length>0&&(this.itemsPivots=this.itemsPivots.filter((function(e,a){return a!==t})),this.$emit("pivotsUpdated",this.itemsPivots))}}},Qi=zi,Gi=(a("5f98"),Object(ge["a"])(Qi,Bi,Ri,!1,null,null,null)),Yi=Gi.exports,Wi=function(e){var t=e.label,a=e.first_name,i=e.last_name,s=e.reference,n=e.company,r=e.locality;if(t)return t;var o="".concat(i," ").concat(a);return s&&s.length>0&&(o+=" (".concat(s,")")),n&&n.legal_name.length>0&&(o+=" − ".concat(n.legal_name)),r&&r.length>0&&(o+=" − ".concat(r)),o},Ki=Wi,Xi={name:"EventStep2",components:{MultipleItem:Yi},props:["event"],data:function(){return{beneficiariesIds:this.event.beneficiaries.map((function(e){return e.id})),showBillingHelp:"none"!==_.billingMode,fetchParams:{tags:[_.beneficiaryTagName]},errors:{}}},mounted:function(){_i.commit("setIsSaved",!0)},methods:{updateItems:function(e){this.beneficiariesIds=e;var t=this.event.beneficiaries.map((function(e){return e.id})),a=e.filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!e.includes(t)})));_i.commit("setIsSaved",0===a.length)},formatItemOptions:function(e){return S(e,Ki)},getItemLabel:function(e){return Ki(e)},saveAndBack:function(e){e.preventDefault(),this.save({gotoStep:!1})},saveAndNext:function(e){e.preventDefault(),this.save({gotoStep:3})},displayError:function(e){var t,a;this.$emit("error",e);var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},save:function(e){var t=this;this.$emit("loading");var a=this.event.id,i=this.$route.meta.resource,s={beneficiaries:this.beneficiariesIds};this.$http.put("".concat(i,"/").concat(a),s).then((function(a){var i=a.data,s=e.gotoStep;s?(_i.commit("setIsSaved",!0),t.$emit("updateEvent",i),t.$emit("gotoStep",s)):t.$router.push("/")})).catch(this.displayError)}}},Zi=Xi,Ji=(a("3bec"),Object(ge["a"])(Zi,qi,Pi,!1,null,null,null)),es=Ji.exports,ts=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"Form EventStep3",attrs:{method:"POST"},on:{submit:e.saveAndBack}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("page-events.event-technicians"))+" ")]),a("MultipleItem",{attrs:{label:"technician",field:"full_name",fetchEntity:"persons",fetchParams:e.fetchParams,selectedItems:e.event.assignees,createItemPath:"/technicians/new",formatOptions:e.formatItemOptions,getItemLabel:e.getItemLabel,pivotField:"position",pivotPlaceholder:e.$t("position-held")},on:{itemsUpdated:e.updateItems,pivotsUpdated:e.updatePivots}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"EventStep3__save-btn info",attrs:{type:"submit"}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("page-events.save-and-back-to-calendar"))+" ")]),a("button",{staticClass:"EventStep3__save-btn success",on:{click:e.saveAndNext}},[e._v(" "+e._s(e.$t("page-events.save-and-continue"))+" "),a("i",{staticClass:"fas fa-arrow-right"})])])])},as=[],is={name:"EventStep3",components:{MultipleItem:Yi},props:["event"],data:function(){return{assigneesIds:this.event.assignees.map((function(e){return e.id})),assigneesPositions:this.event.assignees.map((function(e){return e.pivot.position})),fetchParams:{tags:[_.technicianTagName]},errors:{}}},mounted:function(){_i.commit("setIsSaved",!0)},methods:{updateItems:function(e){this.assigneesIds=e;var t=this.event.assignees.map((function(e){return e.id})),a=e.filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!e.includes(t)})));_i.commit("setIsSaved",0===a.length)},updatePivots:function(e){this.assigneesPositions=e;var t=this.event.assignees.map((function(e){return e.pivot.position})),a=e.filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!e.includes(t)})));_i.commit("setIsSaved",0===a.length)},formatItemOptions:function(e){return S(e,Ki)},getItemLabel:function(e){return Ki(e)},saveAndBack:function(e){e.preventDefault(),this.save({gotoStep:!1})},saveAndNext:function(e){e.preventDefault(),this.save({gotoStep:4})},displayError:function(e){var t,a;this.$emit("error",e);var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},save:function(e){var t=this;this.$emit("loading");var a=this.event.id,i=this.$route.meta.resource,s={};this.assigneesIds.forEach((function(e,a){s[e]={position:t.assigneesPositions[a]}})),this.$http.put("".concat(i,"/").concat(a),{assignees:s}).then((function(a){var i=a.data,s=e.gotoStep;s?(_i.commit("setIsSaved",!0),t.$emit("updateEvent",i),t.$emit("gotoStep",s)):t.$router.push("/")})).catch(this.displayError)}}},ss=is,ns=(a("02d6"),Object(ge["a"])(ss,ts,as,!1,null,null,null)),rs=ns.exports,os=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"Form EventStep4",attrs:{method:"POST"},on:{submit:e.saveAndBack}},[a("section",{staticClass:"Form__fieldset"},[a("MaterialsList",{attrs:{event:e.event},on:{change:e.handleChange}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"EventStep4__save-btn info",attrs:{type:"submit"}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("page-events.save-and-back-to-calendar"))+" ")]),a("button",{staticClass:"EventStep4__save-btn success",on:{click:e.saveAndNext}},[e._v(" "+e._s(e.$t("page-events.save-and-continue"))+" "),a("i",{staticClass:"fas fa-arrow-right"})])])])},ls=[],cs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialsList"},[a("header",{staticClass:"MaterialsList__header"},[a("MaterialsFilter",{ref:"filters",attrs:{baseRoute:"/events/"+e.event.id},on:{change:e.handleFiltersChanges}}),a("div",{staticClass:"MaterialsList__header__extra-filters"},[e.hasMaterial?a("div",{staticClass:"MaterialsList__header__extra-filters__filter"},[e._v(" "+e._s(e.$t("page-events.display-only-selected-materials"))+" "),a("SwitchToggle",{attrs:{value:e.showSelectedOnly},on:{input:e.setSelectedOnly}})],1):e._e()])],1),e.error?a("div",{staticClass:"MaterialsList__error"},[e._v(e._s(e.error))]):e._e(),a("div",{staticClass:"MaterialsList__main"},[e.isLoading?a("div",{staticClass:"MaterialsList__loading"},[a("i",{staticClass:"fas fa-circle-notch fa-spin fa-2x"}),e._v(" "+e._s(e.$t("loading"))+" ")]):e._e(),a("v-client-table",{ref:"DataTable",attrs:{name:"materialsListTable",data:e.materials,columns:e.columns,options:e.tableOptions},scopedSlots:e._u([{key:"child-toggler",fn:function(t){var i=t.row;return[i.is_unitary?a("button",{staticClass:"MaterialsList__child-toggler__button",attrs:{type:"button"},on:{click:function(t){return e.toggleChild(i.id)}}},[e.isChildOpen(i.id)?a("i",{staticClass:"fas fa-caret-down"}):a("i",{staticClass:"fas fa-caret-right"})]):e._e()]}},{key:"child_row",fn:function(t){var i=t.row;return[a("Units",{attrs:{material:i,event:e.event,filters:e.getFilters()},on:{change:e.handleChanges}})]}},{key:"qty",fn:function(t){return a("div",{},[a("span",{key:"qty-"+t.row.id+"-"+e.renderId},[e._v(" "+e._s(e.getQuantity(t.row)>0?e.getQuantity(t.row)+" ×":"")+" ")])])}},{key:"remaining_quantity",fn:function(t){return a("div",{},[a("span",{key:"remain-qty-"+t.row.id+"-"+e.renderId,staticClass:"MaterialsList__remaining",class:{"MaterialsList__remaining--zero":0===e.getRemainingQuantity(t.row),"MaterialsList__remaining--empty":e.getRemainingQuantity(t.row)<0}},[e._v(" "+e._s(e.$t("remaining-count",{count:e.getRemainingQuantity(t.row)}))+" ")])])}},{key:"price",fn:function(t){return a("div",{},[e._v(" "+e._s(e.formatAmount(t.row.rental_price))+" "),a("i",{staticClass:"fas fa-times"})])}},{key:"quantity",fn:function(t){return a("Quantity",{key:"quantities-"+t.row.id+"-"+e.renderId,attrs:{material:t.row,initialQuantity:e.getQuantity(t.row)},on:{decrement:function(a){return e.decrement(t.row)},setQuantity:e.setQuantity,increment:function(a){return e.increment(t.row)}}})}},{key:"amount",fn:function(t){return a("div",{},[a("span",{key:"amount-"+t.row.id+"-"+e.renderId},[e._v(" "+e._s(e.formatAmount(t.row.rental_price*e.getQuantity(t.row)))+" ")])])}},{key:"actions",fn:function(t){return a("div",{},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.getQuantity(t.row)>0,expression:"getQuantity(material.row) > 0"}],key:"clear-"+t.row.id+"-"+e.renderId,staticClass:"warning",attrs:{type:"button",role:"button"},on:{click:function(a){return e.setQuantity(t.row,0)}}},[a("i",{staticClass:"fas fa-backspace"})])])}}])}),!e.isLoading&&e.hasMaterial?a("div",{staticClass:"MaterialsList__add-more"},[e.showSelectedOnly?a("button",{attrs:{type:"button",role:"button"},on:{click:function(t){return e.setSelectedOnly(!1)}}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-events.display-all-materials-to-add-some"))+" ")]):e._e(),e.showSelectedOnly?e._e():a("button",{attrs:{type:"button",role:"button"},on:{click:function(t){return e.setSelectedOnly(!0)}}},[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("page-events.display-only-event-materials"))+" ")])]):e._e()],1)])},us=[],ds=(a("a434"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialsFilters"},[e.parks.length>1?a("select",{directives:[{name:"model",rawName:"v-model",value:e.filters.park,expression:"filters.park"}],staticClass:"MaterialsFilters__item",class:{"MaterialsFilters__item--is-active":""!==e.filters.park},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.filters,"park",t.target.multiple?a:a[0])},e.changePark]}},[a("option",{attrs:{value:""}},[e._v(" "+e._s(e.$t("all-parks"))+" ")]),e._l(e.parks,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2):e._e(),a("select",{directives:[{name:"model",rawName:"v-model",value:e.filters.category,expression:"filters.category"}],staticClass:"MaterialsFilters__item",class:{"MaterialsFilters__item--is-active":""!==e.filters.category},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.filters,"category",t.target.multiple?a:a[0])},e.changeCategory]}},[a("option",{attrs:{value:""}},[e._v(" "+e._s(e.$t("all-categories"))+" ")]),e._l(e.categories,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2),a("select",{directives:[{name:"model",rawName:"v-model",value:e.filters.subCategory,expression:"filters.subCategory"}],staticClass:"MaterialsFilters__item",class:{"MaterialsFilters__item--is-active":""!==e.filters.subCategory},attrs:{disabled:0===e.subCategories.length},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.filters,"subCategory",t.target.multiple?a:a[0])},e.changeSubCategory]}},[a("option",{attrs:{value:""}},[e._v(" "+e._s(e.$t("all-sub-categories"))+" ")]),e._l(e.subCategories,(function(t){return a("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2),a("VueSelect",{staticClass:"MaterialsFilters__item",class:{"MaterialsFilters__item--is-active":e.filters.tags.length>0},attrs:{options:e.$store.getters["tags/options"],placeholder:e.$t("tags"),multiple:""},on:{input:e.setQueryFilters},model:{value:e.filters.tags,callback:function(t){e.$set(e.filters,"tags",t)},expression:"filters.tags"}}),e.isFilterEmpty?e._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("page-materials.clear-filters"),expression:"$t('page-materials.clear-filters')"}],staticClass:"MaterialsFilters__reset warning",on:{click:e.clearFilters}},[a("i",{staticClass:"fas fa-backspace"})])],1)}),ms=[],ps={name:"MaterialsFilters",components:{VueSelect:Ni.a},props:{baseRoute:String},data:function(){return{filters:{park:this.$route.query.park||"",category:this.$route.query.category||"",subCategory:this.$route.query.subCategory||"",tags:[]}}},computed:{parks:function(){return this.$store.state.parks.list},categories:function(){return this.$store.state.categories.list},subCategories:function(){var e=this.filters.category;if(""===e)return[];var t=parseInt(e,10),a=this.categories.find((function(e){return e.id===t}));return(null===a||void 0===a?void 0:a.sub_categories)||[]},isFilterEmpty:function(){return""===this.filters.park&&""===this.filters.category&&""===this.filters.subCategory&&0===this.filters.tags.length}},mounted:function(){this.$store.dispatch("parks/fetch"),this.$store.dispatch("categories/fetch"),this.$store.dispatch("tags/fetch")},methods:{changePark:function(e){this.filters.park=parseInt(e.currentTarget.value,10)||"",this.setQueryFilters()},changeCategory:function(e){this.filters.category=parseInt(e.currentTarget.value,10)||"",this.filters.subCategory="",this.setQueryFilters()},changeSubCategory:function(e){this.filters.subCategory=parseInt(e.currentTarget.value,10)||"",this.setQueryFilters()},clearFilters:function(){this.filters={park:"",category:"",subCategory:"",tags:[]},this.setQueryFilters()},setQueryFilters:function(){var e=this.filters,t=e.park,a=e.category,i=e.subCategory,s=e.tags,n={park:t||null,category:a||null,subCategory:i||null,tags:s.map((function(e){return e.label}))},r={};t&&(r.park=t),a&&(r.category=a),i&&(r.subCategory=i),s.length>0&&(r.tags=JSON.stringify(s.map((function(e){return e.label})))),this.$router.push({path:this.baseRoute,query:r}),this.$emit("change",n)}}},hs=ps,fs=(a("3cc7"),Object(ge["a"])(hs,ds,ms,!1,null,null,null)),vs=fs.exports,_s=(a("dca8"),a("fb6a"),a("25f0"),{qwerty:{48:{base:"0"},49:{base:"1"},50:{base:"2"},51:{base:"3",shift:"#"},52:{base:"4",shift:"$"},53:{base:"5"},54:{base:"6",shift:"^"},55:{base:"7"},56:{base:"8"},57:{base:"9"},191:{base:"/"},219:{base:"["},220:{shift:"|"},221:{base:"]"},223:{base:"/"}},azerty:{48:{shift:"0"},49:{shift:"1"},50:{shift:"2"},51:{alt:"#",shift:"3"},52:{shift:"4"},53:{shift:"5",alt:"["},54:{shift:"6",alt:"|"},55:{shift:"7"},56:{shift:"8"},57:{shift:"9",alt:"^"},191:{shift:"/"},221:{base:"$",alt:"]"}}}),gs=function(e,t){var a,i=(e.which||e.keyCode).toString(),s=String.fromCharCode(i);if("qwerty"===t&&!e.altKey&&!e.shiftKey){if(["219","221"].includes(i)&&"BracketLeft"===e.code)return"[";if("186"===i&&"BracketRight"===e.code)return"]";if("223"===i&&"Slash"===e.code)return"/"}if(!e.altKey){var n=i>=65&&i<=90;if(n)return e.shiftKey?s.toUpperCase():s.toLowerCase();var r=i>=96&&i<=105;if(r)return(i-96).toString()}var o="base";(e.shiftKey||e.altKey)&&(o=e.shiftKey?"shift":"alt");var l=_s[t][i];return l&&o in l&&"Dead"!==e.key?null!==(a=l[o])&&void 0!==a?a:"":["/","|","^","#","$","[","]"].includes(e.key)?e.key:""},bs=gs,ys=Object.freeze([]),ks=Object.freeze([9,13]),Cs=80,ws="^#[",$s="]#$",Es=function(e,t){switch(e.nodeName){case"INPUT":case"TEXTAREA":e.value+=t;break;case"BODY":break;default:console.log("Unhandled target in revert scan state:",e.nodeName,e)}},xs=function(e){var t,a="",i=!1,s=function(s){var n=!!t;t&&(clearTimeout(t),t=null);var r=function(e,i){console.debug("Traitement du scan interrompu: ".concat(i)),e&&Es(s.target,a),t=null,a=""},o=!1,l=s.which||s.keyCode;switch(!0){case i&&ks.includes(l):case!n&&ys.includes(l):return i=!1,s.preventDefault(),void s.stopImmediatePropagation();default:var c=bs(s,_.handScanner.inputLayout);if(null===c||""===c)return;if(!a.length&&ws.charAt(0)!==c)return;if(i=!1,s.preventDefault(),s.stopImmediatePropagation(),a+=c,a.length<=ws.length){var u=a.split("").some((function(e,t){return ws.charAt(t)!==e}));if(u)return void r(!0,"Préfixe invalide.")}var d=a.length>ws.length+$s.length;d&&a.slice(-$s.length)===$s&&(o=!0)}if(o){var m=a.slice(ws.length,-$s.length);a="";var p=m.split("/").join("|").split("|"),h=p.map((function(e){return parseInt(e,10)}));h.some((function(e){return Number.isNaN(e)}))?r(!1,"Code invalide (".concat(m,")")):e.apply(void 0,Object(st["a"])(h)),i=!0,setTimeout((function(){i=!1}),Cs)}else{if(a.length>50+(ws.length+$s.length))return void r(!1,"Code trop long");var f=a.length<ws.length,v=function(){r(f,"Délai d'entrée dépassé")};t=setTimeout(v,Cs)}};return console.debug("Début de l'observation des événements scanette"),document.addEventListener("keydown",s),function(){console.debug("Fin de l'observation des événements scanette"),document.removeEventListener("keydown",s)}},Ds=xs,Ms=a("ade3"),Ss=a("a2c8"),Ls=a.n(Ss),Is=new D["a"].Store({state:{materials:{}},mutations:{init:function(e,t){var a=function(e,t){var a=Object(st["a"])(t.pivot.units),i=t.pivot.quantity;return i<a.length&&(i=a.length),Object(g["a"])(Object(g["a"])({},e),{},Object(Ms["a"])({},t.id,{quantity:i,units:a}))};e.materials=t.reduce(a,{})},setQuantity:function(e,t){var a=this,i=t.material,s=t.quantity,n=i.id;e.materials[n]||(e.materials=Object(g["a"])(Object(g["a"])({},e.materials),{},Object(Ms["a"])({},n,{quantity:0,units:[]})));var r=e.materials[n].quantity,o=s-r;if(e.materials[n].quantity=s,i.is_unitary&&0!==o)if(o>0)Ls()(o,(function(){a.commit("selectNextUnit",i)}));else{var l,c=e.materials[n].units.length;l=Math.abs(o)-Math.max(r-c,0),l=Math.min(l,c),l>0&&Ls()(l,(function(){a.commit("unselectLastUnit",i)}))}},increment:function(e,t){var a=t.id;e.materials[a]||(e.materials=Object(g["a"])(Object(g["a"])({},e.materials),{},Object(Ms["a"])({},a,{quantity:0,units:[]}))),e.materials[a].quantity+=1,t.is_unitary&&this.commit("selectNextUnit",t)},decrement:function(e,t){var a=t.id;if(e.materials[a]&&0!==e.materials[a].quantity){e.materials[a].quantity-=1;var i=e.materials[a].quantity>=e.materials[a].units.length;t.is_unitary&&!i&&this.commit("unselectLastUnit",t)}},selectUnit:function(e,t){var a=t.material,i=t.unitId,s=a.id;if(!a.is_unitary)throw new Error("Le matériel n'est pas unitaire, impossible d'ajouter/supprimer une unité.");e.materials[s]||(e.materials=Object(g["a"])(Object(g["a"])({},e.materials),{},Object(Ms["a"])({},s,{quantity:0,units:[]}))),e.materials[s].units.includes(i)||(e.materials[s].quantity+=1,e.materials[s].units.push(i))},toggleUnit:function(e,t){var a=t.material,i=t.unitId,s=a.id;if(!a.is_unitary)throw new Error("Le matériel n'est pas unitaire, impossible d'ajouter/supprimer une unité.");if(e.materials[s]||(e.materials=Object(g["a"])(Object(g["a"])({},e.materials),{},Object(Ms["a"])({},s,{quantity:0,units:[]}))),e.materials[s].units.includes(i))return e.materials[s].quantity-=1,void(e.materials[s].units=e.materials[s].units.filter((function(e){return e!==i})));e.materials[s].quantity+=1,e.materials[s].units.push(i)},selectNextUnit:function(e,t){var a=t.id;if(!t.is_unitary)throw new Error("Le matériel n'est pas unitaire, impossible d'ajouter une unité.");var i=t.units.find((function(t){return!e.materials[a].units.includes(t.id)&&!(!t.is_available||t.is_broken)}));i&&e.materials[a].units.push(i.id)},unselectLastUnit:function(e,t){var a=t.id;if(!t.is_unitary)throw new Error("Le matériel n'est pas unitaire, impossible de supprimer une unité.");var i=Object(st["a"])(t.units).reverse().find((function(t){return e.materials[a].units.includes(t.id)}));i&&(e.materials[a].units=e.materials[a].units.filter((function(e){return e!==i.id})))}},getters:{getQuantity:function(e){return function(t){var a;return(null===(a=e.materials[t])||void 0===a?void 0:a.quantity)||0}},getUnits:function(e){return function(t){var a;return(null===(a=e.materials[t])||void 0===a?void 0:a.units)||[]}}}}),Ts=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialsListQuantity"},[a("button",{class:{info:e.quantity>0},attrs:{type:"button",role:"button",disabled:0===e.quantity},on:{click:function(t){return e.$emit("decrement")}}},[a("i",{staticClass:"fas fa-minus"})]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"quantity"}],staticClass:"MaterialsListQuantity__number",domProps:{value:e.quantity},on:{input:[function(t){t.target.composing||(e.quantity=t.target.value)},e.updateQuantityDebounced],focus:function(e){return e.target.select()}}}),a("button",{class:{info:e.quantity<e.material.remaining_quantity},attrs:{type:"button",role:"button"},on:{click:function(t){return e.$emit("increment")}}},[a("i",{staticClass:"fas fa-plus"})])])},As=[],Os={name:"MaterialsListQuantity",props:{material:Object,initialQuantity:Number},data:function(e){return{quantity:e.initialQuantity}},methods:{updateQuantityDebounced:Hi()((function(){this.$emit("setQuantity",this.material,this.quantity)}),300)}},js=Os,Fs=(a("4def"),Object(ge["a"])(js,Ts,As,!1,null,null,null)),qs=Fs.exports,Ps=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialsListUnits"},[e.units.length>0?a("div",{staticClass:"MaterialsListUnits__tables"},[a("table",{staticClass:"MaterialsListUnits__table MaterialsListUnits__table--header"},[a("thead",[a("tr",[a("th",{staticClass:"MaterialsListUnits__heading MaterialsListUnits__heading--selector"}),a("th",{staticClass:"MaterialsListUnits__heading MaterialsListUnits__heading--reference"},[e._v(" "+e._s(e.$t("reference"))+" ")]),a("th",{staticClass:"MaterialsListUnits__heading MaterialsListUnits__heading--is-broken"},[e._v(" "+e._s(e.$t("is-broken"))+" "),a("button",{staticClass:"MaterialsListUnits__mini-action-button",on:{click:e.toggleWithUnavailable}},[e.withUnavailable?a("i",{staticClass:"fas fa-eye-slash"}):a("i",{staticClass:"fas fa-eye"})])]),a("th",{staticClass:"MaterialsListUnits__heading MaterialsListUnits__heading--is-lost"},[e._v(" "+e._s(e.$t("is-lost"))+" "),a("button",{staticClass:"MaterialsListUnits__mini-action-button",on:{click:e.toggleWithUnavailable}},[e.withUnavailable?a("i",{staticClass:"fas fa-eye-slash"}):a("i",{staticClass:"fas fa-eye"})])]),a("th",{staticClass:"MaterialsListUnits__heading MaterialsListUnits__heading--state"},[e._v(" "+e._s(e.$t("state"))+" ")]),a("th",{staticClass:"MaterialsListUnits__heading MaterialsListUnits__heading--park"},[e._v(" "+e._s(e.$t("park"))+" ")])])])]),a("div",{staticClass:"MaterialsListUnits__body"},[a("table",{staticClass:"MaterialsListUnits__table MaterialsListUnits__table--body"},[a("tbody",e._l(e.units,(function(t){return a("Unit",{key:t.id,attrs:{data:t,isSelected:e.selected.includes(t.id)},on:{toggle:function(a){return e.handleToggleUnit(t.id)}}})})),1)])])]):e._e(),0===e.units.length?a("p",{staticClass:"MaterialsListUnits__empty"},[e._v(" "+e._s(e.$t("page-events.no-units-available"))+" ")]):e._e()])},Bs=[],Rs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",{class:e.classNames,on:{click:e.handleToggle}},[a("td",{staticClass:"MaterialsListUnit__col MaterialsListUnit__col--selector"},[a("input",{attrs:{type:"checkbox",disabled:!e.isAvailable&&!e.isSelected},domProps:{checked:e.isSelected},on:{input:e.handleCheckbox}})]),a("td",{staticClass:"MaterialsListUnit__col MaterialsListUnit__col--reference"},[e._v(" "+e._s(e.data.reference)+" ")]),a("td",{staticClass:"MaterialsListUnit__col MaterialsListUnit__col--is-broken"},[e._v(" "+e._s(e.data.is_broken?e.$t("yes"):e.$t("no"))+" ")]),a("td",{staticClass:"MaterialsListUnit__col MaterialsListUnit__col--is-lost"},[e._v(" "+e._s(e.data.is_lost?e.$t("yes"):e.$t("no"))+" ")]),a("td",{staticClass:"MaterialsListUnit__col MaterialsListUnit__col--state"},[e._v(" "+e._s(e.unitState)+" ")]),a("td",{staticClass:"MaterialsListUnit__col MaterialsListUnit__col--park"},[e._v(" "+e._s(e.park)+" ")])])},Us=[],Ns={name:"MaterialsListUnit",props:{data:Object,isSelected:Boolean},mounted:function(){this.$store.dispatch("parks/fetch")},computed:{park:function(){var e=this.data.park_id;return this.$store.getters["parks/parkName"](e)},isAvailable:function(){return this.data.is_available},classNames:function(){var e=["MaterialsListUnit"];return this.isSelected&&e.push("MaterialsListUnit--selected"),this.isAvailable||e.push("MaterialsListUnit--unavailable"),this.data.is_broken&&e.push("MaterialsListUnit--broken"),this.data.is_lost&&e.push("MaterialsListUnit--lost"),e.join(" ")},unitState:function(){var e=this.data.state;return e?e.name:null}},methods:{handleToggle:function(){(this.isAvailable||this.isSelected)&&this.$emit("toggle")},handleCheckbox:function(e){e.preventDefault(),e.target.checked=this.isSelected}}},Vs=Ns,Hs=(a("6f18"),Object(ge["a"])(Vs,Rs,Us,!1,null,null,null)),zs=Hs.exports,Qs={name:"MaterialsListUnits",components:{Unit:zs},props:{event:Object,material:Object,filters:Object},data:function(){var e,t=this,a=null===(e=this.event.materials)||void 0===e?void 0:e.find((function(e){var a=e.id;return a===t.material.id})),i=a?Object(st["a"])(a.pivot.units):[];return{initialUnits:i,withUnavailable:!1}},watch:{event:function(e){var t,a,i=this,s=null===(t=e.materials)||void 0===t?void 0:t.find((function(e){var t=e.id;return t===i.material.id}));if(s){var n=Object(st["a"])(s.pivot.units).filter((function(e){return!i.initialUnits.includes(e)}));(a=this.initialUnits).push.apply(a,Object(st["a"])(n))}}},computed:{selected:function(){return Is.getters.getUnits(this.material.id)},units:function(){var e=this;return this.material.units.filter((function(t){return!!e.initialUnits.includes(t.id)||(!e.filters.park||t.park_id===e.filters.park)&&(e.withUnavailable||t.is_available&&!t.is_broken)}))}},methods:{handleToggleUnit:function(e){Is.commit("toggleUnit",{material:this.material,unitId:e}),this.$emit("change")},toggleWithUnavailable:function(e){e.preventDefault(),e.stopPropagation(),this.withUnavailable=!this.withUnavailable}}},Gs=Qs,Ys=(a("de98"),Object(ge["a"])(Gs,Ps,Bs,!1,null,null,null)),Ws=Ys.exports,Ks=(a("8ba4"),function(e){return"number"===typeof e?!Number.isNaN(e)&&Number.isInteger(parseFloat(e)):/^-?[0-9]+$/.test(e)}),Xs=Ks,Zs=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t?{park:null,category:null,subCategory:null,tags:[]}:{};return"onlySelected"in e&&(a.onlySelected=!!e.onlySelected),"tags"in e&&Array.isArray(e.tags)&&(a.tags=e.tags),["park","category","subCategory"].forEach((function(t){t in e&&Xs(e[t])&&(a[t]=parseInt(e[t],10))})),a},Js=1e5,en={name:"MaterialsList",components:{MaterialsFilter:vs,SwitchToggle:Ve,Quantity:qs,Units:Ws},props:{event:Object},data:function(){var e=this,t=["child-toggler","qty","reference","name","remaining_quantity","price","quantity","amount","actions"].filter((function(t){return!("none"===_.billingMode||!e.event.is_billable)||!["price","amount"].includes(t)})),a=this.event.materials.length>0;return{error:null,renderId:1,hasMaterial:a,showSelectedOnly:a,isLoading:!0,columns:t,materials:[],manualOrder:[],tableOptions:{columnsDropdown:!1,preserveState:!1,orderBy:{column:"custom",ascending:!0},initialPage:1,perPage:a?Js:_.defaultPaginationLimit,showChildRowToggler:!1,columnsClasses:{"child-toggler":"MaterialsList__child-toggler",qty:"MaterialsList__qty",reference:"MaterialsList__ref",name:"MaterialsList__name",remaining_quantity:"MaterialsList__remaining",price:"MaterialsList__price",quantity:"MaterialsList__quantity",amount:"MaterialsList__amount",actions:"MaterialsList__actions"},initFilters:this.getFilters(!0,!0),customSorting:{custom:function(t){return function(a,i){var s=null;if(e.showSelectedOnly){var n=e.manualOrder.indexOf(a.id),r=e.manualOrder.indexOf(i.id);-1===n&&-1===r||(s=n>r?-1:1)}return null===s&&(s=a.reference.localeCompare(i.reference,{ignorePunctuation:!0})),t||0===s?s:-s}}},customFilters:[{name:"park",callback:function(e,t){return e.is_unitary?e.units.some((function(e){return e.park_id===t})):e.park_id===t}},{name:"category",callback:function(e,t){return e.category_id===t}},{name:"subCategory",callback:function(e,t){return e.sub_category_id===t}},{name:"tags",callback:function(e,t){return 0===t.length||e.tags.some((function(e){return t.includes(e.name)}))}},{name:"onlySelected",callback:function(t,a){return!a||e.getQuantity(t)>0}}]}}},created:function(){Is.commit("init",this.event.materials)},mounted:function(){this.fetchMaterials(),this.cancelScanObservation=Ds(this.handleScan)},beforeDestroy:function(){this.cancelScanObservation&&this.cancelScanObservation()},computed:{isFiltered:function(){return 0!==Object.keys(this.getFilters(!1)).length}},methods:{fetchMaterials:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,e.$refs.DataTable.setLoadingState(!0),t.next=5,e.$http.get("materials/while-event/".concat(e.event.id));case 5:a=t.sent,i=a.data,e.materials=i,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.showError(t.t0);case 13:return t.prev=13,e.isLoading=!1,e.$refs.DataTable.setLoadingState(!1),t.finish(13);case 17:case"end":return t.stop()}}),t,null,[[0,10,13,17]])})))()},handleScan:function(e,t){if(e&&t){var a=this.materials.find((function(t){return t.id===e}));if(a&&a.is_unitary){var i=a.units.find((function(e){return e.id===t}));if(i&&i.is_available){this.setSelectedOnly(!0),this.isFiltered&&this.$refs.filters.clearFilters();var s=Is.getters.getUnits(a.id),n=s.includes(i.id);n||(Is.commit("selectUnit",{material:a,unitId:i.id}),this.handleChanges());var r=this.manualOrder.indexOf(a.id);-1!==r&&this.manualOrder.splice(r,1),this.manualOrder.push(a.id),document.querySelector(".content").scrollTo(0,0)}}}},getFilters:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={};return t&&(i.onlySelected=a?this.event.materials.length:this.showSelectedOnly),["park","category","subCategory"].forEach((function(t){t in e.$route.query&&(i[t]=e.$route.query[t])})),this.$route.query.tags&&(i.tags=JSON.parse(this.$route.query.tags)),Zs(i,t)},setSelectedOnly:function(e){this.$refs.DataTable.setCustomFilters(Object(g["a"])(Object(g["a"])({},this.getFilters()),{},{onlySelected:e})),this.$refs.DataTable.setLimit(e?Js:_.defaultPaginationLimit),this.showSelectedOnly=e},toggleChild:function(e){this.$refs.DataTable.toggleChildRow(e)},isChildOpen:function(e){var t=this.$refs.DataTable.$refs.table;return t.openChildRows.includes(e)},getQuantity:function(e){return Is.getters.getQuantity(e.id)},getRemainingQuantity:function(e){if(!e.is_unitary)return e.remaining_quantity-this.getQuantity(e);var t=this.getFilters(),a=Is.getters.getUnits(e.id),i=e.units.filter((function(e){return!(!e.is_available||e.is_broken)&&!(t.park&&e.park_id!==t.park&&!a.includes(e.id))}));return i.length-a.length},setQuantity:function(e,t){var a=parseInt(t,10)||0;Is.commit("setQuantity",{material:e,quantity:a}),this.handleChanges()},decrement:function(e){Is.commit("decrement",e),this.handleChanges()},increment:function(e){Is.commit("increment",e),this.handleChanges()},handleFiltersChanges:function(e){var t=this.showSelectedOnly,a=Zs(Object(g["a"])(Object(g["a"])({},e),{},{onlySelected:t}));this.$refs.DataTable.setCustomFilters(a)},handleChanges:function(){this.renderId+=1;var e=Object.keys(Is.state.materials);this.hasMaterial=e.length>0,this.hasMaterial||this.setSelectedOnly(!1);var t=Object.entries(Is.state.materials).map((function(e){var t=Object(T["a"])(e,2),a=t[0],i=t[1],s=i.quantity,n=i.units;return{id:parseInt(a,10),quantity:s,units:Object(st["a"])(n)}}));this.$emit("change",t)},formatAmount:function(e){return St(e)},showError:function(e){this.isLoading=!1,this.error=e.message}}},tn=en,an=(a("d0bc"),Object(ge["a"])(tn,cs,us,!1,null,null,null)),sn=an.exports,nn=function(e){return function(t){if(e.id!==t.id)return!1;var a=e.units.filter((function(e){return!t.units.includes(e)})).concat(t.units.filter((function(t){return!e.units.includes(t)})));return!(a.length>0)&&e.quantity===t.quantity}},rn=function(e){return e.map((function(e){var t=e.id,a=e.is_unitary,i=e.pivot,s={id:t,quantity:(null===i||void 0===i?void 0:i.quantity)||0,units:[]};return a?Object(g["a"])(Object(g["a"])({},s),{},{units:(null===i||void 0===i?void 0:i.units)||[]}):s}))},on=function(e,t){var a=t.filter((function(t){return 0!==t.quantity&&!e.some(nn(t))}));if(a.length>0)return!0;var i=e.filter((function(e){return 0!==e.quantity&&!t.some(nn(e))}));return i.length>0},ln={name:"EventStep4",components:{MaterialsList:sn},props:{event:Object},data:function(){return{materials:rn(this.event.materials)}},methods:{handleChange:function(e){this.materials=e;var t=rn(this.event.materials),a=on(t,e);_i.commit("setIsSaved",!a),a&&this.debouncedSave()},saveAndBack:function(e){e.preventDefault(),this.save({gotoStep:!1})},saveAndNext:function(e){e.preventDefault(),this.save({gotoStep:5})},displayError:function(e){var t,a;this.$emit("error",e);var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},debouncedSave:Object(Vi["debounce"])((function(){this.save({gotoStep:4})}),se),save:function(e){var t=this;this.$emit("loading");var a=this.event.id,i=this.$route.meta.resource,s=this.materials.filter((function(e){var t=e.quantity;return t>0}));this.$http.put("".concat(i,"/").concat(a),{materials:s}).then((function(a){var i=a.data,s=e.gotoStep;s?(_i.commit("setIsSaved",!0),t.$emit("updateEvent",i),t.$emit("gotoStep",s)):t.$router.push("/")})).catch(this.displayError)}}},cn=ln,un=(a("f8c6"),Object(ge["a"])(cn,os,ls,!1,null,null,null)),dn=un.exports,mn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EventStep5"},[a("EventOverview",{attrs:{event:e.event}}),e.event.materials.length>0?a("section",{staticClass:"EventStep5__confirmation"},[a("h3",{staticClass:"EventStep5__confirmation__title"},[e._v(" "+e._s(e.$t("page-events.event-confirmation"))+" ")]),a("div",{staticClass:"EventStep5__confirmation__help",class:{"EventStep5__confirmation__help--confirmed":e.event.is_confirmed}},[e.event.is_confirmed?e._e():a("p",[e.isConfirming?e._e():a("i",{staticClass:"fas fa-hourglass-half"}),e._v(" "+e._s(e.$t("page-events.event-not-confirmed-help"))+" ")]),e.event.is_confirmed?a("p",[e.isConfirming?e._e():a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(e.$t("page-events.event-confirmed-help"))+" ")]):e._e()]),a("div",{staticClass:"EventStep5__confirmation__actions"},[e.event.is_confirmed?e._e():a("button",{staticClass:"success",on:{click:e.confirmEvent}},[e.isConfirming?a("i",{staticClass:"fas fa-circle-notch fa-spin"}):e._e(),e.isConfirming?e._e():a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(e.$t("confirm-event"))+" ")]),e.event.is_confirmed?a("button",{staticClass:"warning",on:{click:e.unconfirmEvent}},[e.isConfirming?a("i",{staticClass:"fas fa-circle-notch fa-spin"}):e._e(),e.isConfirming?e._e():a("i",{staticClass:"fas fa-hourglass-half"}),e._v(" "+e._s(e.$t("unconfirm-event"))+" ")]):e._e(),e.event.beneficiaries.length>0?a("a",{staticClass:"button outline",attrs:{href:e.eventSummaryPdfUrl,target:"_blank"}},[a("i",{staticClass:"fas fa-print"}),e._v(" "+e._s(e.$t("print-summary"))+" ")]):e._e()])]):e._e(),a("section",[a("router-link",{attrs:{to:"/",exact:"",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"EventStep5__back-btn info",on:{click:i}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("page-events.back-to-calendar"))+" ")])]}}])})],1)],1)},pn=[],hn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EventOverview"},[a("h1",{staticClass:"EventOverview__title"},[e._v(e._s(e.event.title))]),a("div",{staticClass:"EventOverview__header"},[a("section",{staticClass:"EventOverview__section"},[a("h2",{staticClass:"EventOverview__dates-location"},[a("i",{staticClass:"fas fa-map-marker-alt"}),e.event.location?a("span",[e._v(" "+e._s(e.$t("in"))+" "+e._s(e.event.location)+", ")]):e._e(),e._v(" "+e._s(e.$t("from-date-to-date",e.fromToDates))+" ")])]),a("section",{staticClass:"EventOverview__section"},[a("h2",{staticClass:"EventOverview__duration"},[a("i",{staticClass:"far fa-clock"}),e._v(" "+e._s(e.$t("duration"))+" "+e._s(e.$t("days-count",{duration:e.duration},e.duration))+" ")])])]),e.event.description?a("p",{staticClass:"EventOverview__description"},[a("i",{staticClass:"fas fa-clipboard"}),e._v(" "+e._s(e.event.description)+" ")]):e._e(),a("div",{staticClass:"EventOverview__main"},[e.event.beneficiaries.length>0?a("section",{staticClass:"EventOverview__section"},[a("dl",{staticClass:"EventOverview__info EventOverview__info--vertical"},[a("dt",{staticClass:"EventOverview__info__term"},[a("i",{staticClass:"fas fa-address-book"}),e._v(" "+e._s(e.$t("page-events.event-beneficiaries"))+" ")]),a("dd",{staticClass:"EventOverview__info__value"},[a("ul",{staticClass:"EventOverview__info__list"},e._l(e.event.beneficiaries,(function(t){return a("li",{key:t.id,staticClass:"EventOverview__info__list-item"},[a("router-link",{attrs:{to:"/beneficiaries/"+t.id,title:e.$t("action-edit")}},[e._v(" "+e._s(t.full_name)+" ")]),t.company?a("router-link",{attrs:{to:"/companies/"+t.company_id,title:e.$t("action-edit")}},[e._v(" ("+e._s(t.company.legal_name)+") ")]):e._e()],1)})),0)])])]):e._e(),e.event.assignees.length>0?a("section",{staticClass:"EventOverview__section"},[a("dl",{staticClass:"EventOverview__info EventOverview__info--vertical"},[a("dt",{staticClass:"EventOverview__info__term"},[a("i",{staticClass:"fas fa-people-carry"}),e._v(" "+e._s(e.$t("page-events.event-technicians"))+" ")]),a("dd",{staticClass:"EventOverview__info__value"},[a("ul",{staticClass:"EventOverview__info__list"},e._l(e.event.assignees,(function(t){return a("li",{key:t.id,staticClass:"EventOverview__info__list-item"},[a("router-link",{key:t.id,staticClass:"EventOverview__info__link",attrs:{to:"/technicians/"+t.id,title:e.$t("action-edit")}},[e._v(" "+e._s(t.full_name)+" ")]),t.pivot.position?a("span",[e._v(" − "+e._s(t.pivot.position)+" ")]):e._e()],1)})),0)])])]):e._e()]),a("div",{staticClass:"EventOverview__materials"},[a("h3",{staticClass:"EventOverview__materials__title"},[a("i",{staticClass:"fas fa-box"}),e._v(" "+e._s(e.$t("page-events.event-materials"))+" ")]),e.hasMaterials?a("EventMaterials",{attrs:{materials:e.event.materials,start:e.startDate,end:e.endDate,withRentalPrices:e.showBilling&&e.event.is_billable,hideDetails:e.showBilling&&e.event.is_billable}}):e._e()],1),e.showBilling&&e.event.is_billable?a("h3",{staticClass:"EventOverview__billing-title"},[a("i",{staticClass:"fas fa-file-invoice-dollar"}),e._v(" "+e._s(e.$t("billing"))+" ")]):e._e(),a("div",{staticClass:"EventOverview__billing"},[e.hasMaterials?a("EventTotals",{attrs:{materials:e.event.materials,withRentalPrices:e.showBilling&&e.event.is_billable,discountRate:e.discountRate,start:e.startDate,end:e.endDate}}):e._e(),e.showBilling&&e.hasMaterials&&e.event.is_billable?a("tabs",{staticClass:"EventOverview__billing__tabs",attrs:{defaultIndex:e.lastBill?1:0,onSelect:e.handleChangeBillingTab}},[a("tab",{attrs:{"title-slot":"estimates"}},[a("EventEstimates",{attrs:{beneficiaries:e.event.beneficiaries,materials:e.event.materials,estimates:e.event.estimates,lastBill:e.lastBill,start:e.startDate,end:e.endDate,loading:e.isCreating,deletingId:e.deletingId},on:{discountRateChange:e.handleChangeDiscountRate,createEstimate:e.handleCreateEstimate,deleteEstimate:e.handleDeleteEstimate}}),a("Help",{attrs:{message:{type:"success",text:e.successMessage},error:e.error}})],1),a("tab",{attrs:{"title-slot":"bill"}},[a("Help",{attrs:{message:{type:"success",text:e.successMessage},error:e.error}}),a("EventBilling",{attrs:{beneficiaries:e.event.beneficiaries,lastBill:e.lastBill,lastEstimate:e.lastEstimate,allBills:e.event.bills,materials:e.event.materials,start:e.startDate,end:e.endDate,loading:e.isCreating},on:{discountRateChange:e.handleChangeDiscountRate,createBill:e.handleCreateBill}})],1),a("template",{slot:"estimates"},[a("i",{staticClass:"fas fa-file-signature"}),e._v(" "+e._s(e.$t("estimates"))+" ")]),a("template",{slot:"bill"},[a("i",{staticClass:"fas fa-file-invoice-dollar"}),e._v(" "+e._s(e.$t("bill"))+" ")])],2):e._e(),e.hasMaterials?e._e():a("p",{staticClass:"EventOverview__materials__empty"},[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.$t("page-events.warning-no-material"))+" ")])],1),a("div",{staticClass:"EventOverview__missing-materials"},[a("EventMissingMaterials",{attrs:{eventId:e.event.id}})],1)])},fn=[],vn={name:"EventOverview",components:{Tabs:pt["b"],Tab:pt["a"],Help:Be,EventMaterials:jt,EventMissingMaterials:Ut,EventBilling:wa,EventEstimates:da,EventTotals:Ma},props:{event:Object},data:function(){var e=Object(T["a"])(this.event.bills,1),t=e[0],a=Object(T["a"])(this.event.estimates,1),i=a[0];return{showBilling:"none"!==_.billingMode,lastBill:t?Object(g["a"])(Object(g["a"])({},t),{},{date:r()(t.date)}):null,lastEstimate:i?Object(g["a"])(Object(g["a"])({},i),{},{date:r()(i.date)}):null,isCreating:!1,deletingId:null,successMessage:null,error:null,discountRate:ft(t,i)}},computed:{startDate:function(){return r()(this.event.start_date)},endDate:function(){return r()(this.event.end_date)},hasMaterials:function(){return this.event.materials.length>0},fromToDates:function(){return{from:this.startDate.format("L"),to:this.endDate.format("L")}},duration:function(){var e=this.event,t=e.start_date,a=e.end_date;return t&&a?r()(a).diff(t,"days")+1:0}},methods:{handleChangeDiscountRate:function(e){this.discountRate=e},handleChangeBillingTab:function(){this.successMessage=null,this.updateDiscountRate()},handleCreateEstimate:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isCreating&&!t.deletingId){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,t.error=null,t.successMessage=null,t.isCreating=!0,i=t.event.id,a.next=9,t.$http.post("events/".concat(i,"/estimate"),{discountRate:e});case 9:s=a.sent,n=s.data,t.event.estimates.unshift(n),t.lastEstimate=Object(g["a"])(Object(g["a"])({},n),{},{date:r()(n.date)}),t.updateDiscountRate(),t.successMessage=t.$t("estimate-created"),a.next=20;break;case 17:a.prev=17,a.t0=a["catch"](2),t.error=a.t0;case 20:return a.prev=20,t.isCreating=!1,a.finish(20);case 23:case"end":return a.stop()}}),a,null,[[2,17,20,23]])})))()},handleDeleteEstimate:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,o,l,c,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.deletingId&&!t.isCreating){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,ut.ConfirmDelete(t.$t,"estimate");case 4:if(i=a.sent,s=i.value,s){a.next=8;break}return a.abrupt("return");case 8:return a.prev=8,t.error=null,t.successMessage=null,t.deletingId=e,a.next=14,t.$http.delete("estimates/".concat(e));case 14:n=a.sent,o=n.data,l=t.event.estimates,c=l.filter((function(e){return e.id!==o.id})),t.event.estimates=c,u=Object(T["a"])(c,1),d=u[0],t.lastEstimate=d?Object(g["a"])(Object(g["a"])({},d),{},{date:r()(d.date)}):null,t.updateDiscountRate(),t.successMessage=t.$t("estimate-deleted"),a.next=28;break;case 25:a.prev=25,a.t0=a["catch"](8),t.error=a.t0;case 28:return a.prev=28,t.deletingId=null,a.finish(28);case 31:case"end":return a.stop()}}),a,null,[[8,25,28,31]])})))()},handleCreateBill:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isCreating&&!t.deletingId){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,t.error=null,t.successMessage=null,t.isCreating=!0,i=t.event.id,a.next=9,t.$http.post("events/".concat(i,"/bill"),{discountRate:e});case 9:s=a.sent,n=s.data,t.event.bills.unshift(n),t.lastBill=Object(g["a"])(Object(g["a"])({},n),{},{date:r()(n.date)}),t.updateDiscountRate(),t.successMessage=t.$t("bill-created"),a.next=20;break;case 17:a.prev=17,a.t0=a["catch"](2),t.error=a.t0;case 20:return a.prev=20,t.isCreating=!1,a.finish(20);case 23:case"end":return a.stop()}}),a,null,[[2,17,20,23]])})))()},updateDiscountRate:function(){this.discountRate=ft(this.lastBill,this.lastEstimate)}}},_n=vn,gn=(a("6aae"),Object(ge["a"])(_n,hn,fn,!1,null,null,null)),bn=gn.exports,yn={name:"EventStep5",components:{EventOverview:bn},props:{event:Object},data:function(){return{isConfirming:!1}},computed:{eventSummaryPdfUrl:function(){var e=_.baseUrl,t=this.event||{id:null},a=t.id;return"".concat(e,"/events/").concat(a,"/pdf")}},methods:{confirmEvent:function(){this.setEventConfirmation(!0)},unconfirmEvent:function(){this.setEventConfirmation(!1)},setEventConfirmation:function(e){var t=this,a=this.$props.event.id,i="".concat(this.$route.meta.resource,"/").concat(a);this.isConfirming=!0,this.$http.put(i,{id:a,is_confirmed:e}).then((function(e){var a=e.data;t.$emit("updateEvent",a)})).catch((function(e){t.$emit("error",e)})).finally((function(){t.isConfirming=!1}))}}},kn=yn,Cn=(a("95a4"),Object(ge["a"])(kn,mn,pn,!1,null,null,null)),wn=Cn.exports,$n={name:"Event",components:{Help:Be,Breadcrumb:wi,MiniSummary:Si,EventStep1:Fi,EventStep2:es,EventStep3:rs,EventStep4:dn,EventStep5:wn},data:function(){var e=this.$store.state.auth.user;return{help:"page-events.help-edit",error:null,isLoading:!1,steps:[{id:1,name:this.$t("page-events.event-informations"),fields:["title","start_date","end_date"]},{id:2,name:this.$t("page-events.event-beneficiaries"),fields:["beneficiaries"]},{id:3,name:this.$t("page-events.event-technicians"),fields:["assignees"]},{id:4,name:this.$t("page-events.event-materials"),fields:["materials"]},{id:5,name:this.$t("page-events.event-summary"),fields:["title","start_date","end_date","beneficiaries","materials"]}],currentStep:1,event:{id:this.$route.params.id||null,title:"",start_date:this.$route.query.startDate||"",end_date:"",location:"",description:"",is_confirmed:!1,user_id:e.id,is_billable:!0,beneficiaries:[],technicians:[],materials:[]}}},mounted:function(){this.getEventData(),_i.commit("reset")},methods:{getEventData:function(){var e=this,t=this.event.id;if(t&&"new"!==t){this.startLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setEventData(a,{from:"get"}),e.stopLoading()})).catch(this.displayError)}},setEventData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:"save"};"get"===t.from?this.help="page-events.help-edit":this.help={type:"success",text:"page-events.saved"},this.error=null,this.isLoading=!1,this.event=e,this.$store.commit("setPageSubTitle",this.event.title),_i.commit("init",this.event)},openStep:function(e){this.currentStep=e},startLoading:function(){this.isLoading=!0},stopLoading:function(){this.isLoading=!1},displayError:function(e){this.error=e,this.isLoading=!1}}},En=$n,xn=(a("b0bc"),Object(ge["a"])(En,pi,hi,!1,null,null,null)),Dn=xn.exports,Mn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EventReturn"},[a("EventReturnHeader",{attrs:{isLoading:e.isLoading,error:e.error,help:e.help,eventData:e.event},on:{displayGroupChange:e.setDisplayGroup}}),a("div",{staticClass:"EventReturn__list"},[e.isLoading||e.isPast?e._e():a("div",{staticClass:"EventReturn__error"},[e.error?e._e():a("p",[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.$t("page-event-return.this-event-is-not-past"))+" ")]),a("router-link",{attrs:{to:"/",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",attrs:{type:"button"},on:{click:i}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("back-to-calendar"))+" ")])]}}],null,!1,2268013829)})],1),!e.isLoading&&e.isPast?[a("MaterialsList",{attrs:{materials:this.event.materials,displayGroup:this.displayGroup,quantities:e.quantities,errors:e.validationErrors,isLocked:e.isDone},on:{change:e.handleChange}}),a("div",{staticClass:"EventReturn__footer"},[e.isDone?a("div",{staticClass:"EventReturn__done"},[e._v(" "+e._s(e.$t("page-event-return.inventory-done"))+" ")]):e._e(),a("router-link",{attrs:{to:"/"}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("back-to-calendar"))+" ")]),e.isDone?e._e():[a("button",{staticClass:"EventReturn__action success",attrs:{type:"button",disabled:e.isSaving||e.isTerminating},on:{click:e.save}},[e.isSaving?a("span",[a("i",{staticClass:"fas fa-circle-notch fa-spin"}),e._v(" "+e._s(e.$t("saving"))+" ")]):a("span",[a("i",{staticClass:"fas fa-save"}),e._v(" "+e._s(e.$t("save-draft"))+" ")])]),a("button",{staticClass:"EventReturn__action info",attrs:{type:"button",disabled:e.isSaving||e.isTerminating,title:e.$t("warning-terminate-inventory")},on:{click:e.terminate}},[e.isTerminating?a("span",[a("i",{staticClass:"fas fa-circle-notch fa-spin"}),e._v(" "+e._s(e.$t("saving"))+" ")]):a("span",[a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(e.$t("terminate-inventory"))+" ")])])]],2)]:e._e()],2)],1)},Sn=[],Ln=(a("5857"),function(e){var t=e.title,a=e.text,i=e.confirmButtonText,n=e.type,r=void 0===n?"info":n,o=s["default"].i18n.translate;return rt.a.fire({icon:"warning",title:null!==t&&void 0!==t?t:o("please-confirm"),text:a,showCancelButton:!0,customClass:{confirmButton:"swal2-confirm--".concat(r)},confirmButtonText:i,cancelButtonText:o("cancel")})}),In=(a("4cbf"),a("7f42"),{name:"MultiSwitch",props:{options:Array,value:String},render:function(){var e=this,t=arguments[0],a=this.options,i=this.value;return a&&0!==a.length?t("div",{class:"MultiSwitch"},[a.map((function(a){var s=a.value,n=a.label,r=a.isDisplayed,o=void 0===r||r;return o&&t("button",{key:n,on:{click:function(){e.$emit("change",s)}},class:{MultiSwitch__option:!0,"MultiSwitch__option--active":i===s}},[n])}))]):null}}),Tn=In,An={name:"EventReturnHeader",components:{Help:Be,MultiSwitch:Tn},props:{isLoading:Boolean,error:Error,help:String,eventData:Object},data:function(){return{displayGroup:"categories"}},computed:{hasMultipleParks:function(){return this.$store.state.parks.list.length>1},endDate:function(){return this.eventData.id?r()(this.eventData.end_date):null}},created:function(){this.$store.dispatch("categories/fetch"),this.$store.dispatch("parks/fetch")},methods:{setDisplayGroup:function(e){this.displayGroup=e,this.$emit("displayGroupChange",e)}},render:function(){var e=arguments[0],t=this.isLoading,a=this.eventData,i=this.error;if(t||!a.id)return e("div",{class:"EventReturnHeader"},[e(Be,{attrs:{message:"",error:i,isLoading:t}})]);var s=this.$t,n=this.help,r=this.endDate,o=this.displayGroup,l=this.setDisplayGroup;return e("div",{class:"EventReturnHeader"},[e("div",{class:"EventReturnHeader__infos"},[e("div",{class:"EventReturnHeader__info"},[s("return-scheduled-on"),e("br"),e("strong",{class:"EventReturnHeader__info__important"},[r?r.format("LL"):""])]),e("div",{class:"EventReturnHeader__info"},[s("beneficiary"),e("br"),e("strong",{class:"EventReturnHeader__info__important"},[a.beneficiaries[0]?a.beneficiaries[0].full_name:""])]),a.location&&e("div",{class:"EventReturnHeader__info"},[s("location"),e("br"),e("strong",{class:"EventReturnHeader__info__important"},[a.location])])]),e(Be,{attrs:{message:n,error:i}}),e("div",{class:"EventReturnHeader__actions"},[e("div",{class:"EventReturnHeader__group-by"},[e("span",{class:"EventReturnHeader__group-by__label"},[s("grouped-by")]),e(Tn,{attrs:{options:[{value:"categories",label:s("categories")},{value:null,label:s("not-grouped")}],value:o},on:{change:l}})])])])}},On=An,jn=(a("6580"),a("4453"),a("40b6")),Fn=a.n(jn),qn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=e.is_unitary,i=e.awaited_units,s=void 0===i?[]:i;if(!a)return[];var n=s.map((function(e){var a,i,s,n=e.id,r=e.state,o=t.find((function(e){return e.id===n}));if(!o)return{id:n,state:r,isLost:!0,isBroken:!1};var l=null!==(a=o.isBroken)&&void 0!==a&&a,c=!l&&(null===(i=o.isLost)||void 0===i||i),u=c?r:null!==(s=o.state)&&void 0!==s?s:r;return{id:n,state:u,isLost:c,isBroken:l}}));return n},Pn=(a("2736"),a("53ca")),Bn=(a("f00c"),a("4d21"),{name:"QuantityInput",props:{quantity:Number,limit:[Number,Object]},computed:{min:function(){var e,t;return"object"!==Object(Pn["a"])(this.limit)?0:null!==(e=null===(t=this.limit)||void 0===t?void 0:t.min)&&void 0!==e?e:0},max:function(){var e;return"object"!==Object(Pn["a"])(this.limit)?this.limit:null===(e=this.limit)||void 0===e?void 0:e.max}},methods:{handleInputChange:function(e){var t=Number.parseInt(e.target.value,10);(!t&&0!==t||Number.isNaN(t)||!Number.isFinite(t))&&(t=this.min),t<this.min&&(t=this.min),null!=this.max&&t>this.limit&&(t=this.max),this.$emit("quantityChange",t)},handleDecrement:function(){var e=this.quantity-1;e<this.min||this.$emit("quantityChange",e)},handleIncrement:function(){var e=this.quantity+1;null!=this.max&&e>this.max||this.$emit("quantityChange",e)}},render:function(){var e=arguments[0],t=this.min,a=this.max,i=this.quantity,s=this.handleDecrement,n=this.handleIncrement,r=this.handleInputChange;return e("div",{class:"QuantityInput"},[e("button",{attrs:{type:"button",role:"button",disabled:i<=t},class:"QuantityInput__button",on:{click:s}},[e("i",{class:"fas fa-minus"})]),e("input",{attrs:{type:"number",step:1,min:t,max:a},class:"QuantityInput__input",domProps:{value:i},on:{input:r,focus:function(e){e.target.select()}}}),e("button",{attrs:{type:"button",role:"button",disabled:null!=a&&i>=a},class:{QuantityInput__button:!0,info:null==a||i<a},on:{click:n}},[e("i",{class:"fas fa-plus"})])])}}),Rn=Bn,Un={name:"InventoryItemMaterial",props:{material:{type:Object,required:!0},quantities:{type:Object,required:!0},locked:{type:Boolean,default:!1},strict:{type:Boolean,default:!1},error:Object},computed:{id:function(){return this.material.id},awaitedUnits:function(){var e,t=this.material;return t.is_unitary&&null!==(e=null===t||void 0===t?void 0:t.awaited_units)&&void 0!==e?e:[]},awaitedUnitsQuantity:function(){return this.awaitedUnits.length},awaitedQuantity:function(){var e,t=this.material,a=null!==(e=this.material.awaited_quantity)&&void 0!==e?e:0;return this.locked?a:t.is_unitary&&a<this.awaitedUnitsQuantity?(this.quantityWarning("La quantité totale attendue est inférieure à la quantité d'unités attendue."),this.awaitedUnitsQuantity):a},awaitedExternalQuantity:function(){var e=this.material;return e.is_unitary?this.awaitedQuantity-this.awaitedUnitsQuantity:this.awaitedQuantity},units:function(){var e;return null!==(e=this.quantities.units)&&void 0!==e?e:[]},actualUnitsQuantity:function(){var e=this.material.is_unitary;return e?this.units.filter((function(e){return!e.isLost})).length:0},actualQuantity:function(){var e,t,a=this.material.is_unitary,i=null!==(e=null===(t=this.quantities)||void 0===t?void 0:t.actual)&&void 0!==e?e:0;if(this.locked)return i;if(i<0)return this.quantityWarning("La quantité présente est inférieure à zéro."),0;if(this.strict&&i>this.awaitedQuantity)return this.quantityWarning("La quantité présente totale est supérieure à la quantité totale attendue en mode strict."),this.awaitedQuantity;if(a){if(i<this.actualUnitsQuantity)return this.quantityWarning("La quantité d'unités présentes est supérieure à la quantité présente totale."),this.actualUnitsQuantity;var s=i-this.actualUnitsQuantity;if(s>this.awaitedExternalQuantity)return this.quantityWarning("La quantité externe présente est supérieure à la quantité externe totale attendue."),this.actualUnitsQuantity+this.awaitedExternalQuantity}return i},currentlyAwaitedActualQuantity:function(){var e=this.material.is_unitary;return e?this.awaitedExternalQuantity+this.actualUnitsQuantity:this.awaitedQuantity},brokenUnitsQuantity:function(){return this.units.filter((function(e){return e.isBroken})).length},brokenQuantity:function(){var e,t,a=this.material.is_unitary,i=null!==(e=null===(t=this.quantities)||void 0===t?void 0:t.broken)&&void 0!==e?e:0;if(this.locked)return i;if(i<0)return this.quantityWarning("La quantité en panne totale est inférieure à zéro."),0;if(i>this.actualQuantity)return this.quantityWarning("La quantité en panne totale est supérieure à la quantité présente totale."),this.actualQuantity;if(a){if(i<this.brokenUnitsQuantity)return this.quantityWarning("La quantité d'unités en panne est supérieure à la quantité en panne totale."),this.brokenUnitsQuantity;var s=i-this.brokenUnitsQuantity;if(s>this.awaitedExternalQuantity)return this.quantityWarning("La quantité externe en panne est supérieure à la quantité externe totale attendue."),this.brokenUnitsQuantity+this.awaitedExternalQuantity}return i},currentlyAwaitedBrokenQuantity:function(){var e=this.material.is_unitary;return e?this.awaitedExternalQuantity+this.brokenUnitsQuantity:this.awaitedQuantity},isComplete:function(){return this.actualQuantity>=this.awaitedQuantity},isReadOnly:function(){var e=this.material.is_unitary;return this.locked||!e?this.locked:this.awaitedQuantity<=this.awaitedUnitsQuantity},hasBroken:function(){return this.brokenQuantity>0}},methods:{handleActualQuantityChange:function(e){if(!this.isReadOnly){var t=this.material.is_unitary,a=this.strict||t;if(e<0&&(e=0),a&&e>this.awaitedQuantity&&(e=this.awaitedQuantity),t){e<this.actualUnitsQuantity&&(e=this.actualUnitsQuantity);var i=e-this.actualUnitsQuantity;i>this.awaitedExternalQuantity&&(e=this.actualUnitsQuantity+this.awaitedExternalQuantity)}var s=this.brokenQuantity>e?e:this.brokenQuantity;this.$emit("change",{actual:e,broken:s,units:this.units})}},handleBrokenQuantityChange:function(e){if(!this.isReadOnly){var t=this.material.is_unitary,a=this.strict||t;if(e<0&&(e=0),a&&e>this.awaitedQuantity&&(e=this.awaitedQuantity),t){e<this.brokenUnitsQuantity&&(e=this.brokenUnitsQuantity);var i=e-this.brokenUnitsQuantity;i>this.awaitedExternalQuantity&&(e=this.brokenUnitsQuantity+this.awaitedExternalQuantity)}var s=this.actualQuantity<e?e:this.actualQuantity;this.$emit("change",{actual:s,broken:e,units:this.units})}},quantityWarning:function(e){console.warn("Quantités inventaire invalides pour le matériel ".concat(this.id," : ").concat(e))}},render:function(){var e=arguments[0],t=this.$t,a=this.material,i=this.error,s=this.locked,n=this.strict,r=this.isComplete,o=this.isReadOnly,l=this.hasBroken,c=this.awaitedQuantity,u=this.brokenQuantity,d=this.actualQuantity,m=this.actualUnitsQuantity,p=this.brokenUnitsQuantity,h=this.handleActualQuantityChange,f=this.handleBrokenQuantityChange,v=this.currentlyAwaitedActualQuantity,_=this.currentlyAwaitedBrokenQuantity,g=a.reference,b=a.name,y=a.is_unitary,k={InventoryItemMaterial:!0,"InventoryItemMaterial--read-only":o,"InventoryItemMaterial--complete":r&&d>0,"InventoryItemMaterial--warning":l,"InventoryItemMaterial--error":!!i||s&&!r};return e("div",{class:k},[e("div",{class:"InventoryItemMaterial__reference"},[g]),e("div",{class:"InventoryItemMaterial__name"},[b]),e("div",{class:"InventoryItemMaterial__error"},[null===i||void 0===i?void 0:i.message]),e("div",{class:"InventoryItemMaterial__awaited-quantity"},[t("awaited-quantity"),e("strong",{class:"InventoryItemMaterial__awaited-quantity__count"},[c])]),e("div",{class:"InventoryItemMaterial__actual-quantity",attrs:{title:t("actual-quantity")}},[o?d:e(Rn,{attrs:{quantity:d,limit:n||y?{min:y?m:0,max:v}:void 0},on:{quantityChange:h}})]),e("div",{class:"InventoryItemMaterial__quantity-broken",attrs:{title:t("quantity-out-of-order")}},[o?u:e(Rn,{attrs:{quantity:u,limit:n||y?{min:y?p:0,max:_}:void 0},on:{quantityChange:f}})])])}},Nn=Un,Vn=(a("b3cc"),a("8866"),a("3f08")),Hn={name:"InventoryItemUnitsItem",props:{unit:{type:Object,required:!0},locked:{type:[Boolean,Array],default:!1},values:Object},computed:{id:function(){return this.unit.id},isBroken:function(){var e,t;return null!==(e=null===(t=this.values)||void 0===t?void 0:t.isBroken)&&void 0!==e&&e},isLost:function(){var e,t;return!this.isBroken&&(null===(e=null===(t=this.values)||void 0===t?void 0:t.isLost)||void 0===e||e)},state:function(){var e,t;return this.isLost?this.unit.state:null!==(e=null===(t=this.values)||void 0===t?void 0:t.state)&&void 0!==e?e:this.unit.state},readableState:function(){return this.$store.getters["unitStates/unitStateName"](this.state)||"?"},isStateLocked:function(){return Array.isArray(this.locked)?this.locked.includes("unit-state"):this.locked},barcodeUrl:function(){var e=_.baseUrl;return"".concat(e,"/material-units/").concat(this.id,"/barcode")},statesOptions:function(){return this.$store.getters["unitStates/options"]}},mounted:function(){this.$store.dispatch("unitStates/fetch")},methods:{handleFoundChange:function(e){var t=!!e&&this.isBroken;this.$emit("change",this.id,{isLost:!e,isBroken:t,state:this.state})},handleBrokenChange:function(e){var t=!e&&this.isLost;this.$emit("change",this.id,{isLost:t,isBroken:e,state:this.state})},handleStateChange:function(e){var t=this.isLost,a=this.isBroken;if(this.isStateLocked||t)this.$forceUpdate();else{var i=e.currentTarget.value;this.$emit("change",this.id,{isLost:t,isBroken:a,state:i}),this.$forceUpdate()}},handleCheckbox:function(e){e.preventDefault(),e.target.checked=!this.isLost,this.locked||this.handleFoundChange(this.isLost)}},render:function(){var e=arguments[0],t=this.$t,a=this.unit,i=this.locked,s=this.state,n=this.isLost,r=this.isBroken,o=this.readableState,l=this.isStateLocked,c=this.barcodeUrl,u=this.statesOptions,d=this.handleCheckbox,m=this.handleStateChange,p=this.handleFoundChange,h=this.handleBrokenChange,f=a.reference,v=a.owner;return e("tr",{class:"InventoryItemUnitsItem"},[e("td",{class:"InventoryItemUnitsItem__col InventoryItemUnitsItem__col--checkbox"},[e("input",{attrs:{type:"checkbox",disabled:!0===i},class:"InventoryItemUnitsItem__checkbox",domProps:{checked:!n},on:{input:d}})]),e("td",{class:"InventoryItemUnitsItem__col"},[f]),e("td",{class:"InventoryItemUnitsItem__col InventoryItemUnitsItem__col--owner"},[!!v&&e(Vn["a"],[e("strong",[t("owner-key")])," ",v.full_name])]),e("td",{class:"InventoryItemUnitsItem__col InventoryItemUnitsItem__col--state InventoryItemUnitsItem__state"},[e("strong",{class:"InventoryItemUnitsItem__state__label"},[t("state")," :"]),l&&e("span",{class:"InventoryItemUnitsItem__state__value"},[o]),!l&&e("select",{domProps:{value:s},attrs:{disabled:n},on:{change:m},class:"InventoryItemUnitsItem__state__select"},[u.map((function(t){var a=t.value,i=t.label;return e("option",{key:a,domProps:{value:a}},[i])}))])]),e("td",{class:"InventoryItemUnitsItem__col InventoryItemUnitsItem__col--actions"},[!0!==i&&e("a",{attrs:{target:"_blank",href:c,download:!0},class:"button InventoryItemUnits__button"},[e("i",{class:"fas fa-barcode"})])]),e("td",{class:["InventoryItemUnitsItem__col","InventoryItemUnitsItem__col--switch","InventoryItemUnitsItem__col--switch--found"]},[!0!==i&&e(Ve,{attrs:{value:!n,hideLabel:!0},on:{input:p}}),!0===i&&e("span",{class:["InventoryItemUnitsItem__state",{"InventoryItemUnitsItem__state--error":n}]},[t(n?"no":"yes")])]),e("td",{class:["InventoryItemUnitsItem__col","InventoryItemUnitsItem__col--switch","InventoryItemUnitsItem__col--switch--broken"]},[!0!==i&&e(Ve,{attrs:{value:r,hideLabel:!0},on:{input:h}}),!0===i&&e("span",{class:["InventoryItemUnitsItem__state",{"InventoryItemUnitsItem__state--error":r}]},[t(r?"yes":"no")])])])}},zn=Hn,Qn={name:"InventoryItemUnits",props:{material:{type:Object,required:!0},quantities:{type:Object,required:!0},locked:{type:[Boolean,Array],default:!1},strict:{type:Boolean,default:!1}},computed:{id:function(){return this.material.id},awaitedUnits:function(){var e;return null!==(e=this.material.awaited_units)&&void 0!==e?e:[]},units:function(){var e;return null!==(e=this.quantities.units)&&void 0!==e?e:[]}},methods:{getValues:function(e){var t,a,i,s=this.awaitedUnits.find((function(t){var a=t.id;return a===e}));Fn()(s,"L'unité demandée ne fait pas partie du matériel de l'inventaire.");var n=s.state,r=this.units.find((function(t){var a=t.id;return a===e}));if(!r)return{id:e,state:n,isLost:!0,isBroken:!1};var o=null!==(t=r.isBroken)&&void 0!==t&&t,l=!o&&(null===(a=r.isLost)||void 0===a||a),c=l?n:null!==(i=r.state)&&void 0!==i?i:n;return{id:e,state:c,isLost:l,isBroken:o}},handleChange:function(e,t){var a=this;if(!0!==this.locked){var i=this.quantities,s=i.actual,n=void 0===s?0:s,r=i.broken,o=void 0===r?0:r,l=this.awaitedUnits.map((function(i){var s=a.getValues(i.id);if(i.id!==e)return Object(g["a"])({id:i.id},s);s.isLost!==t.isLost&&(n+=t.isLost?-1:1),s.isBroken!==t.isBroken&&(o+=t.isBroken?1:-1);var r=("unit-state"!==a.locked?t:s).state;return Object(g["a"])(Object(g["a"])({id:i.id},t),{},{state:r})}));this.$emit("change",{actual:n,broken:o,units:l})}}},render:function(){var e=this,t=arguments[0],a=this.locked,i=this.awaitedUnits,s=this.handleChange;return t("div",{class:"InventoryItemUnits"},[t("table",{class:"InventoryItemUnits__table"},[t("tbody",[i.map((function(i){return t(zn,{key:i.id,attrs:{unit:i,locked:a,values:e.getValues(i.id)},on:{change:s}})}))])])])}},Gn=Qn,Yn={name:"InventoryItem",props:{material:{type:Object,required:!0},quantities:{type:Object,required:!0},error:Object,locked:{type:[Boolean,Array],default:!1},strict:{type:Boolean,default:!1}},computed:{id:function(){return this.material.id}},methods:{handleChange:function(e){!0!==this.locked&&this.$emit("change",this.id,e)},scrollIntoView:function(){this.$refs.container.scrollIntoView({behavior:"smooth",block:"center"})}},render:function(){var e=arguments[0],t=this.material,a=this.error,i=this.locked,s=this.strict,n=this.quantities,r=this.handleChange,o=t.is_unitary;return e("div",{class:"InventoryItem",ref:"container"},[e(Nn,{attrs:{material:t,quantities:n,error:a,strict:s,locked:!0===i},on:{change:r}}),o&&e(Gn,{attrs:{material:t,quantities:n,locked:i},on:{change:r}})])}},Wn=Yn,Kn={name:"Inventory",props:{materials:{type:Array,required:!0},quantities:{type:Array,required:!0},errors:{type:Array,default:function(){return[]}},locked:{type:[Boolean,Array],default:!1},strict:{type:Boolean,default:!1},displayGroup:{default:"categories",validator:function(e){return["categories","parks","none"].includes(e)}}},computed:{list:function(){var e=this.$store.getters["categories/categoryName"],t=this.$store.getters["parks/parkName"];switch(this.displayGroup){case"categories":return Ot(this.materials,"category_id",e);case"parks":return Ot(this.materials,"park_id",t);default:return[{id:"flat",name:null,materials:this.materials}]}}},mounted:function(){this.$store.dispatch("categories/fetch"),this.$store.dispatch("parks/fetch"),this.cancelScanObservation=Ds(this.handleScan)},beforeDestroy:function(){this.cancelScanObservation&&this.cancelScanObservation()},methods:{handleChange:function(e,t){!0!==this.locked&&this.$emit("change",e,t)},handleScan:function(e,t){var a;if(e&&t){var i=this.materials.find((function(t){return t.id===e}));if(i&&i.is_unitary){var s=null!==(a=null===i||void 0===i?void 0:i.awaited_units)&&void 0!==a?a:[];if(0!==s.length&&s.find((function(e){return e.id===t}))){var n=this.getMaterialQuantities(e),r=n.units.findIndex((function(e){return e.id===t}));if(!(r<0)){!0!==this.locked&&n.units[r].isLost&&(n.actual+=1,n.units[r].isLost=!1,this.$emit("change",e,n));var o=this.$refs["items[".concat(e,"]")];o&&o.scrollIntoView()}}}}},getMaterialQuantities:function(e){var t,a,i=this.materials.find((function(t){return t.id===e}));Fn()(i,"Le matériel demandé ne fait pas partie du matériel de l'inventaire.");var s=this.quantities.find((function(t){var a=t.id;return a===e}));return{actual:null!==(t=null===s||void 0===s?void 0:s.actual)&&void 0!==t?t:0,broken:null!==(a=null===s||void 0===s?void 0:s.broken)&&void 0!==a?a:0,units:Object(st["a"])(qn(i,null===s||void 0===s?void 0:s.units))}},getError:function(e){return this.errors?this.errors.find((function(t){var a=t.id;return a===e})):null}},render:function(){var e=arguments[0],t=this.$t,a=this.list,i=this.locked,s=this.strict,n=this.getMaterialQuantities,r=this.getError,o=this.handleChange;return e("div",{class:"Inventory"},[a.map((function(a){var l=a.id,c=a.name,u=a.materials;return e("div",{key:l,class:"Inventory__section"},[e("div",{class:"Inventory__section__header"},[e("h3",{class:"Inventory__section__title"},["flat"!==l?c:""]),e("h3",{class:"Inventory__section__quantity-title"},[t("actual-quantity")]),e("h3",{class:"Inventory__section__quantity-title"},[t("quantity-out-of-order")])]),e("div",{class:"Inventory__list"},[u.map((function(t){return e(Wn,{ref:"items[".concat(t.id,"]"),key:t.id,attrs:{material:t,quantities:n(t.id),error:r(t.id),locked:i,strict:s},on:{change:o}})}))])])}))])}},Xn=Kn,Zn={name:"EventReturnMaterialsList",props:{materials:Array,quantities:Array,errors:Array,isLocked:Boolean,displayGroup:{default:"categories",validator:function(e){return["categories","parks","none"].includes(e)}}},computed:{awaitedMaterials:function(){return this.materials.map((function(e){var t=e.pivot,a=Object(Ti["a"])(e,["pivot"]),i=[];return a.is_unitary&&(i=a.units.filter((function(e){return t.units.includes(e.id)}))),Object(g["a"])(Object(g["a"])({},a),{},{awaited_quantity:t.quantity,awaited_units:i})}))},isAllReturned:function(){var e=this;return this.materials.every((function(t){var a=e.quantities.find((function(e){var a=e.id;return t.id===a}));return!!a&&a.actual===a.awaited_quantity}))},hasBroken:function(){return this.quantities.some((function(e){var t=e.broken;return t>0}))}},methods:{handleChange:function(e,t){this.$emit("change",e,t)}},render:function(){var e=arguments[0],t=this.$t,a=this.quantities,i=this.awaitedMaterials,s=this.isLocked,n=this.isAllReturned,r=this.displayGroup,o=this.hasBroken,l=this.handleChange;return e("div",{class:"EventReturnMaterialsList"},[s&&!n&&e("div",{class:"EventReturnMaterialsList__missing"},[t("page-event-return.some-material-is-missing")]),e(Xn,{attrs:{quantities:a,materials:i,displayGroup:r,errors:this.errors,locked:s||["unit-state"],strict:!0},on:{change:l}}),n&&e("div",{class:"EventReturnMaterialsList__all-returned"},[t("page-event-return.all-material-returned")]),o&&e("div",{class:"EventReturnMaterialsList__has-broken"},[e("i",{class:"fas fa-exclamation-triangle"})," ",t("page-event-return.some-material-came-back-broken")])])}},Jn={name:"EventReturn",components:{EventReturnHeader:On,MaterialsList:Zn},data:function(){return{help:"page-event-return.help",error:null,validationErrors:null,isLoading:!1,isSaving:!1,isTerminating:!1,displayGroup:"categories",event:{id:this.$route.params.id||null,materials:[],beneficiaries:[]},endDate:null,quantities:[]}},computed:{isPast:function(){return!!this.endDate&&this.endDate.isSameOrBefore(new Date,"day")},isDone:function(){return!!this.event.is_return_inventory_done}},mounted:function(){this.getEventData()},methods:{formatAmount:function(e){return St(e)},getEventData:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.event.id,a){t.next=3;break}return t.abrupt("return");case 3:return e.isLoading=!0,t.prev=4,t.next=7,e.$http.get("events/".concat(a));case 7:i=t.sent,s=i.data,e.setEventData(s),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](4),e.event.id=null,e.displayError(t.t0);case 16:case"end":return t.stop()}}),t,null,[[4,12]])})))()},setEventData:function(e){this.help="page-event-return.help",this.error=null,this.validationErrors=null,this.isLoading=!1,this.isSaving=!1,this.isTerminating=!1,this.event=e,this.endDate=r()(e.end_date),this.initQuantities(),this.$store.commit("setPageSubTitle",e.title)},initQuantities:function(){var e=this.event.materials;this.quantities=e.map((function(e){var t=e.id,a=e.is_unitary,i=e.pivot;return{id:t,awaited_quantity:i.quantity||0,actual:i.quantity_returned||0,broken:i.quantity_broken||0,is_unitary:a,units:i.units_with_return.map((function(e){return{id:e.id,isLost:!e.is_returned,isBroken:!!e.is_returned_broken}}))}}))},handleChange:function(e,t){var a=this.quantities.findIndex((function(t){var a=t.id;return e===a}));if(!(a<0)){var i=this.quantities[a];this.$set(this.quantities,a,Object(g["a"])(Object(g["a"])({},i),t))}},setDisplayGroup:function(e){this.displayGroup=e},save:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.event.id,a){t.next=3;break}return t.abrupt("return");case 3:return e.isSaving=!0,e.validationErrors=null,t.prev=5,t.next=8,e.$http.put("events/".concat(a,"/return"),e.quantities);case 8:i=t.sent,s=i.data,e.setEventData(s),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),e.displayError(t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))()},terminate:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.event.id,a){t.next=3;break}return t.abrupt("return");case 3:return i=e.quantities.some((function(e){var t=e.broken;return t>0})),t.next=6,Ln({title:e.$t("page-event-return.confirm-terminate-title"),text:i?e.$t("page-event-return.confirm-terminate-text-with-broken"):e.$t("page-event-return.confirm-terminate-text"),confirmButtonText:e.$t("terminate-inventory")});case 6:if(s=t.sent,s.isConfirmed){t.next=9;break}return t.abrupt("return");case 9:return e.isSaving=!0,e.isTerminating=!0,e.validationErrors=null,t.prev=12,t.next=15,e.$http.put("events/".concat(a,"/terminate"),e.quantities);case 15:n=t.sent,r=n.data,e.setEventData(r),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](12),e.displayError(t.t0);case 23:case"end":return t.stop()}}),t,null,[[12,20]])})))()},displayError:function(e){if(this.isLoading=!1,this.isSaving=!1,this.isTerminating=!1,400===e.response.status)return this.error=new Error(this.$t("inventory-validation-error")),void(this.validationErrors=e.response.data.error.details);this.error=e}}},er=Jn,tr=er,ar=Object(ge["a"])(tr,Mn,Sn,!1,null,null,null),ir=ar.exports,sr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Users"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("div",{staticClass:"header-page__actions"},[a("router-link",{attrs:{to:"/users/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"Users__create success",on:{click:i}},[a("i",{staticClass:"fas fa-user-plus"}),e._v(" "+e._s(e.$t("page-users.action-add"))+" ")])]}}])})],1)]),a("div",{staticClass:"content__main-view"},[a("v-server-table",{ref:"DataTable",attrs:{name:"UsersTable",columns:e.columns,options:e.options},scopedSlots:e._u([{key:"pseudo",fn:function(t){return a("div",{},[a("i",{staticClass:"fas",class:t.row.id===e.currentUserId?"fa-user-circle":"fa-user"}),e._v(" "+e._s(t.row.pseudo)+" ")])}},{key:"full_name",fn:function(t){return a("div",{},[t.row.person?a("span",[e._v(" "+e._s(t.row.person.first_name)+" "+e._s(t.row.person.last_name)+" ")]):a("span",{staticClass:"Users__no-profile"},[e._v(" "+e._s(e.$t("page-users.profile-missing-or-deleted"))+" ")])])}},{key:"group_id",fn:function(t){return a("div",{},[e._v(" "+e._s(e.$t(t.row.group_id))+" ")])}},{key:"email",fn:function(t){return a("div",{},[t.row.id!==e.currentUserId?a("a",{attrs:{href:"mailto:"+t.row.email}},[e._v(" "+e._s(t.row.email)+" ")]):a("span",[e._v(e._s(t.row.email))])])}},{key:"phone",fn:function(t){return a("div",{},[t.row.person?a("span",[e._v(" "+e._s(t.row.person.phone)+" ")]):e._e()])}},{key:"address",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.person.street)),a("br"),e._v(" "+e._s(t.row.person.postal_code)+" "+e._s(t.row.person.locality)+" ")])}},{key:"actions",fn:function(t){return a("div",{staticClass:"Users__actions"},[t.row.id===e.currentUserId?a("div",[a("router-link",{attrs:{to:"/profile",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",on:{click:i}},[a("i",{staticClass:"fas fa-edit"}),e._v(" "+e._s(e.$t("your-profile"))+" ")])]}}],null,!0)})],1):a("div",[e.isTrashDisplayed?e._e():a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/users/"+t.row.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button info",on:{click:t}},[a("i",{staticClass:"fas fa-edit"})])]}}],null,!0)}),e.isTrashDisplayed||"admin"===t.row.group_id?e._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"item-actions__button warning",on:{click:function(a){return e.deleteUser(t.row.id)}}},[a("i",{staticClass:"fas fa-trash"})]),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-restore"),expression:"$t('action-restore')"}],staticClass:"item-actions__button info",on:{click:function(a){return e.restoreUser(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-restore"})]):e._e(),e.isTrashDisplayed&&"admin"!==t.row.group_id?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"item-actions__button danger",on:{click:function(a){return e.deleteUser(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})]):e._e()],1)])}}])})],1),a("div",{staticClass:"content__footer"},[a("button",{staticClass:"Users__show-trashed",class:e.isTrashDisplayed?"info":"warning",on:{click:function(t){return e.showTrashed()}}},[e.isTrashDisplayed?e._e():a("span",[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("open-trash-bin"))+" ")]),e.isTrashDisplayed?a("span",[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("display-not-deleted-items"))+" ")]):e._e()])])])},nr=[],rr={name:"Users",components:{Help:Be},data:function(){var e=this;return{help:"page-users.help",error:null,isLoading:!1,isDisplayTrashed:!1,isTrashDisplayed:!1,columns:["pseudo","full_name","group_id","email","phone","address","actions"],options:{columnsDropdown:!0,preserveState:!0,orderBy:{column:"pseudo",ascending:!0},initialPage:this.$route.query.page||1,sortable:["pseudo","group_id","email"],columnsDisplay:{address:"mobile"},headings:{pseudo:this.$t("pseudo"),full_name:this.$t("name"),group_id:this.$t("group"),email:this.$t("email"),phone:this.$t("phone"),address:this.$t("address"),actions:""},columnsClasses:{pseudo:"Users__pseudo",full_name:"Users__name",group_id:"Users__group",email:"Users__email",phone:"Users__phone",address:"Users__address"},requestFunction:function(t){e.error=null,e.isLoading=!0;var a=Object(g["a"])(Object(g["a"])({},t),{},{deleted:e.isDisplayTrashed?"1":"0"});return e.$http.get(e.$route.meta.resource,{params:a}).catch(e.showError).finally((function(){e.isTrashDisplayed=e.isDisplayTrashed,e.isLoading=!1}))}}}},computed:{currentUserId:function(){return this.$store.state.auth.user.id}},methods:{deleteUser:function(e){var t=this,a=!this.isTrashDisplayed;ut.ConfirmDelete(this.$t,"users",a).then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.delete("".concat(t.$route.meta.resource,"/").concat(e)).then(t.refreshTable).catch(t.showError))}))},restoreUser:function(e){var t=this;ut.ConfirmRestore(this.$t,"users").then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.put("".concat(t.$route.meta.resource,"/restore/").concat(e)).then(t.refreshTable).catch(t.showError))}))},refreshTable:function(){this.help="page-users.help",this.error=null,this.isLoading=!0,this.$refs.DataTable.refresh()},showTrashed:function(){this.isDisplayTrashed=!this.isDisplayTrashed,this.refreshTable()},showError:function(e){this.error=e,this.isLoading=!1}}},or=rr,lr=(a("235b"),Object(ge["a"])(or,sr,nr,!1,null,null,null)),cr=lr.exports,ur=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"User"},[a("form",{staticClass:"Form",attrs:{method:"POST"},on:{submit:e.saveUser}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("connexion-infos"))+" ")]),a("FormField",{attrs:{name:"pseudo",label:"pseudo",required:"",errors:e.errors.pseudo},model:{value:e.user.pseudo,callback:function(t){e.$set(e.user,"pseudo",t)},expression:"user.pseudo"}}),a("FormField",{attrs:{name:"email",label:"email",type:"email",required:"",errors:e.errors.email},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}}),e.user.id?e._e():a("FormField",{attrs:{name:"password",label:"password",type:"password",required:"",errors:e.errors.password},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),a("FormField",{attrs:{name:"group_id",label:"group",type:"select",required:"",options:e.groupOptions,errors:e.errors.group_id},on:{change:e.handleUserGroupChange},model:{value:e.user.group_id,callback:function(t){e.$set(e.user,"group_id",t)},expression:"user.group_id"}})],1),!e.isAdmin&&e.hasMultipleParks?a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("page-users.parks-access"))+" ")]),a("FormField",{attrs:{label:"page-users.restrict-access-to-parks",type:"switch"},on:{change:function(t){return e.setParksSelection([])}},model:{value:e.hasParksRestriction,callback:function(t){e.hasParksRestriction=t},expression:"hasParksRestriction"}}),e.hasParksRestriction?a("ParkChooser",{attrs:{initialSelection:e.user.restricted_parks},on:{updateParksSelection:e.setParksSelection}}):e._e()],1):e._e(),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("personnal-infos"))+" ")]),a("FormField",{attrs:{name:"first_name",label:"first-name",errors:e.errors.first_name},model:{value:e.user.person.first_name,callback:function(t){e.$set(e.user.person,"first_name",t)},expression:"user.person.first_name"}}),a("FormField",{attrs:{name:"last_name",label:"last-name",errors:e.errors.last_name},model:{value:e.user.person.last_name,callback:function(t){e.$set(e.user.person,"last_name",t)},expression:"user.person.last_name"}}),a("FormField",{attrs:{name:"nickname",label:"nickname",errors:e.errors.nickname},model:{value:e.user.person.nickname,callback:function(t){e.$set(e.user.person,"nickname",t)},expression:"user.person.nickname"}}),a("FormField",{attrs:{name:"phone",label:"phone",type:"tel",errors:e.errors.phone},model:{value:e.user.person.phone,callback:function(t){e.$set(e.user.person,"phone",t)},expression:"user.person.phone"}}),a("FormField",{attrs:{name:"street",label:"street",errors:e.errors.street},model:{value:e.user.person.street,callback:function(t){e.$set(e.user.person,"street",t)},expression:"user.person.street"}}),a("FormField",{staticClass:"User__postal-code",attrs:{name:"postal_code",label:"postal-code",errors:e.errors.postal_code},model:{value:e.user.person.postal_code,callback:function(t){e.$set(e.user.person,"postal_code",t)},expression:"user.person.postal_code"}}),a("FormField",{attrs:{name:"locality",label:"city",errors:e.errors.locality},model:{value:e.user.person.locality,callback:function(t){e.$set(e.user.person,"locality",t)},expression:"user.person.locality"}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("save"))+" ")])])]),a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1)])])},dr=[],mr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"ParkChooser"},e._l(e.allParks,(function(t){return a("li",{key:t.id,staticClass:"ParkChooser__park",class:{"ParkChooser__park--selected":e.selectedParks.includes(t.id)},attrs:{role:"button"},on:{click:function(a){return e.handleSelect(t.id)}}},[e.selectedParks.includes(t.id)?a("i",{staticClass:"fas fa-ban"}):a("i",{staticClass:"fas fa-check"}),e._v(" "+e._s(t.name)+" ")])})),0)},pr=[],hr={name:"ParkChooser",props:{initialSelection:Array},data:function(){return{selectedParks:[]}},computed:{allParks:function(){return this.$store.state.parks.list}},mounted:function(){this.$store.dispatch("parks/fetch"),this.selectedParks=this.initialSelection},methods:{handleSelect:function(e){var t=this.selectedParks.findIndex((function(t){return t===e}));-1===t?this.selectedParks.push(e):this.selectedParks.splice(t,1),this.$emit("updateParksSelection",this.selectedParks)}}},fr=hr,vr=(a("95f8"),Object(ge["a"])(fr,mr,pr,!1,null,null,null)),_r=vr.exports,gr={name:"User",components:{Help:Be,FormField:ze,ParkChooser:_r},data:function(){return{help:"page-users.help-edit",error:null,isLoading:!1,hasParksRestriction:!1,user:{id:this.$route.params.id||null,pseudo:"",email:"",password:"",group_id:"member",restricted_parks:[],person:{first_name:"",last_name:"",nickname:"",phone:"",street:"",postal_code:"",locality:""}},errors:{pseudo:null,email:null,password:null,group_id:null,person:{first_name:null,last_name:null,nickname:null,phone:null,street:null,postal_code:null,locality:null}},groupOptions:[{value:"admin",label:"admin"},{value:"member",label:"member"},{value:"visitor",label:"visitor"}]}},computed:{isAdmin:function(){return"admin"===this.user.group_id},hasMultipleParks:function(){return this.$store.state.parks.list.length>1}},mounted:function(){this.$store.dispatch("parks/fetch"),this.getUserData()},methods:{getUserData:function(){var e=this,t=this.user.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setUserData(a),e.hasParksRestriction=a.restricted_parks.length>0,e.isLoading=!1})).catch(this.displayError)}},saveUser:function(e){var t=this;e.preventDefault(),this.resetHelpLoading();var a=this.user.id,i=this.$route.meta.resource,s=this.$http.post,n="users/signup";this.user.id&&(s=this.$http.put,n="".concat(i,"/").concat(a));var r=Object(g["a"])(Object(g["a"])({},this.user),{},{restricted_parks:this.user.restricted_parks});s(n,r).then((function(e){var a=e.data;t.isLoading=!1,t.help={type:"success",text:"page-users.saved"},t.setUserData(a),setTimeout((function(){t.$router.push("/users")}),300)})).catch(this.displayError)},handleUserGroupChange:function(){this.isAdmin&&(this.hasParksRestriction=!1,this.user.restricted_parks=[])},setParksSelection:function(e){this.user.restricted_parks=e},resetHelpLoading:function(){this.help="page-users.help-edit",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-users.help-edit",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setUserData:function(e){this.user=e,e.person||(this.user.person={first_name:"",last_name:"",nickname:"",phone:"",street:"",postal_code:"",locality:""}),this.$store.commit("setPageSubTitle",this.user.pseudo)}}},br=gr,yr=(a("50b8"),Object(ge["a"])(br,ur,dr,!1,null,null,null)),kr=yr.exports,Cr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Beneficiaries"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("div",{staticClass:"header-page__actions"},[a("router-link",{attrs:{to:"/beneficiaries/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"Beneficiaries__create success",on:{click:i}},[a("i",{staticClass:"fas fa-user-plus"}),e._v(" "+e._s(e.$t("page-beneficiaries.action-add"))+" ")])]}}])})],1)]),a("div",{staticClass:"content__main-view"},[a("v-server-table",{ref:"DataTable",attrs:{name:"BeneficiariesTable",columns:e.columns,options:e.options},scopedSlots:e._u([{key:"company",fn:function(t){return a("div",{},[t.row.company?a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/companies/"+t.row.company.id}},[e._v(" "+e._s(t.row.company.legal_name)+" "),a("i",{staticClass:"fas fa-edit"})]):e._e()],1)}},{key:"email",fn:function(t){return a("div",{},[a("a",{attrs:{href:"mailto:"+t.row.email}},[e._v(e._s(t.row.email))])])}},{key:"phone",fn:function(t){return a("div",{},[t.row.phone?a("div",[e._v(" "+e._s(t.row.phone)+" ")]):e._e(),t.row.company?a("div",[e._v(" "+e._s(t.row.company.phone)+" ")]):e._e()])}},{key:"address",fn:function(t){return a("div",{},[e._v(" "+e._s(e.getBeneficiaryAddress(t.row))+" ")])}},{key:"note",fn:function(t){return a("div",{},[t.row.company?a("pre",[e._v(e._s(t.row.company.note))]):a("pre",[e._v(e._s(t.row.note))])])}},{key:"actions",fn:function(t){return a("div",{staticClass:"Beneficiaries__actions"},[e.isTrashDisplayed?e._e():a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/beneficiaries/"+t.row.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button info",on:{click:t}},[a("i",{staticClass:"fas fa-edit"})])]}}],null,!0)}),e.isTrashDisplayed?e._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"item-actions__button warning",on:{click:function(a){return e.deleteBeneficiary(t.row.id)}}},[a("i",{staticClass:"fas fa-trash"})]),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-restore"),expression:"$t('action-restore')"}],staticClass:"item-actions__button info",on:{click:function(a){return e.restoreBeneficiary(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-restore"})]):e._e(),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"item-actions__button danger",on:{click:function(a){return e.deleteBeneficiary(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})]):e._e()],1)}}])})],1),a("div",{staticClass:"content__footer"},[a("button",{staticClass:"Beneficiaries__show-trashed",class:e.isTrashDisplayed?"info":"warning",on:{click:function(t){return e.showTrashed()}}},[e.isTrashDisplayed?e._e():a("span",[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("open-trash-bin"))+" ")]),e.isTrashDisplayed?a("span",[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("display-not-deleted-items"))+" ")]):e._e()])])])},wr=[],$r=(a("498a"),{name:"Beneficiaries",components:{Help:Be},data:function(){var e=this;return{help:"page-beneficiaries.help",error:null,isLoading:!1,isDisplayTrashed:!1,isTrashDisplayed:!1,columns:["last_name","first_name","reference","company","email","phone","address","note","actions"],options:{columnsDropdown:!0,preserveState:!0,orderBy:{column:"last_name",ascending:!0},initialPage:this.$route.query.page||1,sortable:["last_name","first_name","reference","company","email"],columnsDisplay:{note:"mobile"},headings:{last_name:this.$t("last-name"),first_name:this.$t("first-name"),reference:this.$t("reference"),company:this.$t("company"),email:this.$t("email"),phone:this.$t("phone"),address:this.$t("address"),note:this.$t("notes"),actions:""},columnsClasses:{company:"Beneficiaries__company",email:"Beneficiaries__email",address:"Beneficiaries__address",note:"Beneficiaries__note"},requestFunction:function(t){e.isLoading=!0,e.error=null;var a=Object(g["a"])(Object(g["a"])({},t),{},{tags:[_.beneficiaryTagName],deleted:e.isDisplayTrashed?"1":"0"});return e.$http.get(e.$route.meta.resource,{params:a}).catch(e.showError).finally((function(){e.isTrashDisplayed=e.isDisplayTrashed,e.isLoading=!1}))}}}},methods:{getBeneficiaryAddress:function(e){var t=function(e){var t=e.street,a=e.postal_code,i=e.locality,s=[a,i].filter(Boolean).join(" ");return[t,s].map((function(e){return e?e.trim():e})).filter(Boolean).join("\n")};return e.street||e.postal_code||e.locality?t(e):t(e.company||{})},deleteBeneficiary:function(e){var t=this,a=!this.isTrashDisplayed;ut.ConfirmDelete(this.$t,"beneficiaries",a).then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.delete("".concat(t.$route.meta.resource,"/").concat(e)).then(t.refreshTable).catch(t.showError))}))},restoreBeneficiary:function(e){var t=this;ut.ConfirmRestore(this.$t,"beneficiaries").then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.put("".concat(t.$route.meta.resource,"/restore/").concat(e)).then(t.refreshTable).catch(t.showError))}))},refreshTable:function(){this.error=null,this.isLoading=!0,this.$refs.DataTable.refresh()},showTrashed:function(){this.isDisplayTrashed=!this.isDisplayTrashed,this.refreshTable()},showError:function(e){this.isLoading=!1,this.error=e}}}),Er=$r,xr=(a("b574"),Object(ge["a"])(Er,Cr,wr,!1,null,null,null)),Dr=xr.exports,Mr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view Beneficiary"},[a("div",{staticClass:"Beneficiary__main"},[a("PersonForm",{attrs:{person:e.person,errors:e.errors,withCompany:"",withReference:""},on:{submit:e.saveBeneficiary}}),a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1)])])},Sr=[],Lr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"Form PersonForm",attrs:{method:"POST"},on:{submit:e.doSubmit}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("personnal-infos"))+" ")]),a("FormField",{attrs:{name:"first_name",label:"first-name",required:"",errors:e.errors.first_name},model:{value:e.person.first_name,callback:function(t){e.$set(e.person,"first_name",t)},expression:"person.first_name"}}),a("FormField",{attrs:{name:"last_name",label:"last-name",required:"",errors:e.errors.last_name},model:{value:e.person.last_name,callback:function(t){e.$set(e.person,"last_name",t)},expression:"person.last_name"}}),e.withReference?a("FormField",{attrs:{name:"reference",label:"reference",errors:e.errors.reference},model:{value:e.person.reference,callback:function(t){e.$set(e.person,"reference",t)},expression:"person.reference"}}):e._e(),e.withCompany?e._e():a("FormField",{attrs:{name:"nickname",label:"nickname",errors:e.errors.nickname},model:{value:e.person.nickname,callback:function(t){e.$set(e.person,"nickname",t)},expression:"person.nickname"}})],1),e.withCompany?a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("company"))+" ")]),a("div",{staticClass:"PersonForm__company"},[a("FormField",{attrs:{name:"company_id",label:"company",type:"select",options:e.companiesOptions,errors:e.errors.company_id},model:{value:e.person.company_id,callback:function(t){e.$set(e.person,"company_id",t)},expression:"person.company_id"}}),e.person.company_id?a("router-link",{attrs:{to:"/companies/"+e.person.company_id,custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"PersonForm__company__edit-btn info",on:{click:i}},[a("i",{staticClass:"fas fa-edit"}),e._v(" "+e._s(e.$t("page-companies.edit-btn"))+" ")])]}}],null,!1,770691493)}):e._e()],1),a("router-link",{staticClass:"PersonForm__add-company",attrs:{to:"/companies/new"}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-companies.create-new"))+" ")])],1):e._e(),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("contact"))+" ")]),a("FormField",{staticClass:"PersonForm__phone",attrs:{name:"phone",label:"phone",type:"tel",errors:e.errors.phone},model:{value:e.person.phone,callback:function(t){e.$set(e.person,"phone",t)},expression:"person.phone"}}),a("FormField",{attrs:{name:"email",label:"email",type:"email",errors:e.errors.email},model:{value:e.person.email,callback:function(t){e.$set(e.person,"email",t)},expression:"person.email"}}),a("FormField",{attrs:{name:"street",label:"street",errors:e.errors.street},model:{value:e.person.street,callback:function(t){e.$set(e.person,"street",t)},expression:"person.street"}}),a("FormField",{staticClass:"PersonForm__postal-code",attrs:{name:"postal_code",label:"postal-code",errors:e.errors.postal_code},model:{value:e.person.postal_code,callback:function(t){e.$set(e.person,"postal_code",t)},expression:"person.postal_code"}}),a("FormField",{attrs:{name:"locality",label:"city",errors:e.errors.locality},model:{value:e.person.locality,callback:function(t){e.$set(e.person,"locality",t)},expression:"person.locality"}}),a("FormField",{attrs:{name:"country_id",label:"country",type:"select",options:e.countriesOptions,errors:e.errors.country_id},model:{value:e.person.country_id,callback:function(t){e.$set(e.person,"country_id",t)},expression:"person.country_id"}})],1),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("other-infos"))+" ")]),a("FormField",{staticClass:"PersonForm__notes",attrs:{label:"notes",name:"note",type:"textarea",errors:e.errors.note},model:{value:e.person.note,callback:function(t){e.$set(e.person,"note",t)},expression:"person.note"}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[a("i",{staticClass:"fas fa-save"}),e._v(" "+e._s(e.$t("save"))+" ")]),a("button",{attrs:{type:"button"},on:{click:e.goBack}},[a("i",{staticClass:"fas fa-ban"}),e._v(" "+e._s(e.$t("cancel"))+" ")])])])},Ir=[],Tr={name:"PersonForm",components:{FormField:ze},props:{person:Object,errors:Object,withCompany:Boolean,withReference:Boolean},computed:{countriesOptions:function(){return this.$store.getters["countries/options"]},companiesOptions:function(){return this.$store.getters["companies/options"]}},mounted:function(){this.$store.dispatch("countries/fetch"),this.$store.dispatch("companies/fetch")},methods:{doSubmit:function(e){this.$emit("submit",e)},goBack:function(){this.$router.back()}}},Ar=Tr,Or=(a("704a"),Object(ge["a"])(Ar,Lr,Ir,!1,null,null,null)),jr=Or.exports,Fr={name:"Beneficiary",components:{Help:Be,PersonForm:jr},data:function(){return{help:"page-beneficiaries.help-edit",error:null,isLoading:!1,person:{id:this.$route.params.id||null,email:"",first_name:"",last_name:"",reference:"",company_id:"",nickname:"",phone:"",street:"",postal_code:"",locality:"",country_id:"",note:""},errors:{first_name:null,last_name:null,reference:null,nickname:null,phone:null,street:null,postal_code:null,locality:null,note:null}}},mounted:function(){this.getBeneficiaryData()},methods:{getBeneficiaryData:function(){var e=this,t=this.person.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setPerson(a),e.isLoading=!1})).catch(this.displayError)}},saveBeneficiary:function(e){var t=this;e.preventDefault(),this.resetHelpLoading();var a=this.person.id,i=this.$route.meta.resource,s=this.$http.post,n=i;a&&(s=this.$http.put,n="".concat(i,"/").concat(a));var r=Object(g["a"])({},this.person);a||(r.tags=[_.beneficiaryTagName]),s(n,r).then((function(e){var a=e.data;t.isLoading=!1,t.help={type:"success",text:"page-beneficiaries.saved"},t.setPerson(a),setTimeout((function(){t.$router.push("/beneficiaries")}),300)})).catch(this.displayError)},resetHelpLoading:function(){this.help="page-beneficiaries.help-edit",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-beneficiaries.help-edit",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setPerson:function(e){this.person=e;var t=e.full_name||"".concat(e.first_name," ").concat(e.last_name);this.$store.commit("setPageSubTitle",t)}}},qr=Fr,Pr=(a("3cfd"),Object(ge["a"])(qr,Mr,Sr,!1,null,null,null)),Br=Pr.exports,Rr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view Company"},[a("div",{staticClass:"Company__main"},[a("CompanyForm",{attrs:{company:e.company,errors:e.errors},on:{submit:e.saveCompany}}),a("div",{staticClass:"Company__extras"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),e.persons.length>0?a("div",{staticClass:"Company__persons"},[a("h4",{staticClass:"Company__persons__title"},[e._v(" "+e._s(e.$t("page-companies.attached-persons"))+" ")]),a("ul",{staticClass:"Company__persons__list"},e._l(e.persons,(function(t){return a("li",{key:t.id,staticClass:"Company__persons__item"},[a("i",{staticClass:"fas fa-user"}),a("router-link",{attrs:{to:"/beneficiaries/"+t.id}},[e._v(" "+e._s(t.full_name)+" ")])],1)})),0)]):e._e()],1)],1)])])},Ur=[],Nr=(a("4082"),{name:"CompanyForm",props:{company:Object,errors:Object},computed:{countriesOptions:function(){return this.$store.getters["countries/options"]}},mounted:function(){this.$store.dispatch("countries/fetch")},methods:{doSubmit:function(e){e.preventDefault(),this.$emit("submit",e)},goBack:function(){this.$router.back()}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.company,s=this.errors,n=this.countriesOptions,r=this.doSubmit,o=this.goBack;return t("form",{class:"Form CompanyForm",on:{submit:r}},[t("section",{class:"Form__fieldset"},[t("h4",{class:"Form__fieldset__title"},[a("informations")]),t(ze,{attrs:{name:"legal_name",label:"legal-name",required:!0,errors:s.legal_name},model:{value:i.legal_name,callback:function(t){e.$set(i,"legal_name",t)}}}),t(ze,{attrs:{name:"phone",label:"phone",type:"tel",errors:s.phone},class:"CompanyForm__phone",model:{value:i.phone,callback:function(t){e.$set(i,"phone",t)}}})]),t("section",{class:"Form__fieldset"},[t("h4",{class:"Form__fieldset__title"},[a("address")]),t(ze,{attrs:{name:"street",label:"street",errors:s.street},model:{value:i.street,callback:function(t){e.$set(i,"street",t)}}}),t(ze,{attrs:{name:"postal_code",label:"postal-code",errors:s.postal_code},class:"CompanyForm__postal-code",model:{value:i.postal_code,callback:function(t){e.$set(i,"postal_code",t)}}}),t(ze,{attrs:{name:"locality",label:"city",errors:s.locality},model:{value:i.locality,callback:function(t){e.$set(i,"locality",t)}}}),t(ze,{attrs:{name:"country_id",label:"country",type:"select",options:n,errors:s.country_id},model:{value:i.country_id,callback:function(t){e.$set(i,"country_id",t)}}})]),t("section",{class:"Form__fieldset"},[t("h4",{class:"Form__fieldset__title"},[a("other-infos")]),t(ze,{attrs:{label:"notes",name:"note",type:"textarea",errors:s.note},class:"CompanyForm__notes",model:{value:i.note,callback:function(t){e.$set(i,"note",t)}}})]),t("section",{class:"Form__actions"},[t("button",{class:"Form__actions__save success",attrs:{type:"submit"}},[t("i",{class:"fas fa-save"})," ",a("save")]),t("button",{attrs:{type:"button"},on:{click:o}},[t("i",{class:"fas fa-ban"})," ",a("cancel")])])])}}),Vr={name:"Company",components:{Help:Be,CompanyForm:Nr},data:function(){return{help:"page-companies.help-edit",error:null,isLoading:!1,company:{id:this.$route.params.id||null,legal_name:"",street:"",postal_code:"",locality:"",country_id:"",phone:"",note:""},persons:[],errors:{legal_name:null,street:null,postal_code:null,locality:null,country_id:null,phone:null}}},mounted:function(){this.getCompanyData(),this.getCompanyPersons()},methods:{getCompanyData:function(){var e=this,t=this.company.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setCompany(a),e.isLoading=!1})).catch(this.displayError)}},getCompanyPersons:function(){var e=this,t=this.company.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t,"/persons")).then((function(t){var a=t.data;e.persons=a.data,e.isLoading=!1})).catch(this.displayError)}},saveCompany:function(){var e=this;this.resetHelpLoading();var t=this.company.id,a=this.$route.meta.resource,i=this.$http.post,s=a;t&&(i=this.$http.put,s="".concat(a,"/").concat(t));var n=Object(g["a"])({},this.company);t||(n.tags=[_.beneficiaryTagName]),i(s,n).then((function(t){var a=t.data;e.isLoading=!1,e.help={type:"success",text:"page-companies.saved"},e.setCompany(a),e.$store.dispatch("companies/refresh"),setTimeout((function(){e.$router.back()}),300)})).catch(this.displayError)},resetHelpLoading:function(){this.help="page-companies.help-edit",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-companies.help-edit",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setCompany:function(e){this.company=e,this.$store.commit("setPageSubTitle",e.legal_name)}}},Hr=Vr,zr=(a("a993"),Object(ge["a"])(Hr,Rr,Ur,!1,null,null,null)),Qr=zr.exports,Gr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Materials"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("div",{staticClass:"header-page__actions"},[a("router-link",{attrs:{to:"/materials/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"Materials__create success",on:{click:i}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-materials.action-add"))+" ")])]}}])}),a("router-link",{attrs:{to:"/inventories",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{on:{click:i}},[a("i",{staticClass:"fas fa-boxes"}),e._v(" "+e._s(e.$t("inventories"))+" ")])]}}])}),e.isAdmin?a("Dropdown",{attrs:{variant:"actions"},scopedSlots:e._u([{key:"items",fn:function(){return[a("router-link",{attrs:{to:"/attributes",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("li",{class:e.dropdownItemClass,on:{click:i}},[a("i",{staticClass:"fas fa-cog"}),e._v(" "+e._s(e.$t("page-materials.manage-attributes"))+" ")])]}}],null,!1,2231817545)}),a("a",{class:e.dropdownItemClass,attrs:{href:e.downloadListingUrl,target:"_blank"}},[a("i",{staticClass:"fas fa-print"}),e._v(" "+e._s(e.$t("page-materials.print-complete-list"))+" ")])]},proxy:!0}],null,!1,3000575449)}):e._e()],1)]),a("div",{staticClass:"content__main-view Materials__main-view"},[a("div",{staticClass:"Materials__filters"},[a("MaterialsFilters",{attrs:{baseRoute:"/materials"},on:{change:e.refreshTableAndPagination}}),a("div",{staticClass:"Materials__quantities-date"},[null===e.dateForQuantities?a("button",{staticClass:"Materials__quantities-date__button",on:{click:e.showQuantityAtDateModal}},[e._v(" "+e._s(e.$t("page-materials.display-quantities-at-date"))+" ")]):a("div",{staticClass:"Materials__quantities-date__displayed"},[a("p",{staticClass:"Materials__quantities-date__label"},[e._v(" "+e._s(e.$t("page-materials.remaining-quantities-on-date",{date:e.dateForQuantities.format("LL")}))+" ")]),a("button",{staticClass:"Materials__quantities-date__button warning",on:{click:e.removeDateForQuantities}},[e._v(" "+e._s(e.$t("reset-date"))+" ")])])])],1),a("v-server-table",{ref:"DataTable",attrs:{name:"materialsTable",columns:e.columns,options:e.options},scopedSlots:e._u([{key:"park",fn:function(t){return a("div",{},[e._v(" "+e._s(e.getParkName(t.row.park_id))+" ")])}},{key:"category",fn:function(t){return a("div",{},[a("i",{staticClass:"fas fa-folder-open"}),e._v(" "+e._s(e.getCategoryName(t.row.category_id))+" "),t.row.sub_category_id?a("div",[a("i",{staticClass:"fas fa-arrow-right"}),e._v(" "+e._s(e.getSubCategoryName(t.row.sub_category_id))+" ")]):e._e()])}},{key:"rental_price",fn:function(t){return a("div",{},[e._v(" "+e._s(e.formatAmount(t.row.rental_price))+" ")])}},{key:"replacement_price",fn:function(t){return a("div",{},[e._v(" "+e._s(e.formatAmount(t.row.replacement_price))+" ")])}},{key:"stock_quantity",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStockQuantity(a))+" ")]}},{key:"out_of_order_quantity",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.out_of_order_quantity||"")+" ")])}},{key:"tags",fn:function(t){return a("div",{staticClass:"Materials__tags-list",attrs:{role:"button"},on:{click:function(a){return e.setTags(t.row)}}},[a("MaterialTags",{attrs:{tags:t.row.tags}}),0!==t.row.tags.length||e.isTrashDisplayed?e._e():a("span",{staticClass:"Materials__add-tags"},[e._v(" "+e._s(e.$t("add-tags"))+" ")])],1)}},{key:"actions",fn:function(t){return a("div",{staticClass:"Materials__actions"},[a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-view"),expression:"$t('action-view')"}],attrs:{to:"/materials/"+t.row.id+"/view",custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button success",on:{click:t}},[a("i",{staticClass:"fas fa-eye"})])]}}],null,!0)}),e.isTrashDisplayed?e._e():a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/materials/"+t.row.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button info",on:{click:t}},[a("i",{staticClass:"fas fa-edit"})])]}}],null,!0)}),e.isTrashDisplayed?e._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"item-actions__button warning",on:{click:function(a){return e.deleteMaterial(t.row.id)}}},[a("i",{staticClass:"fas fa-trash"})]),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-restore"),expression:"$t('action-restore')"}],staticClass:"item-actions__button info",on:{click:function(a){return e.restoreMaterial(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-restore"})]):e._e(),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"item-actions__button danger",on:{click:function(a){return e.deleteMaterial(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})]):e._e()],1)}}])})],1),a("div",{staticClass:"content__footer"},[a("button",{staticClass:"Materials__show-trashed",class:e.isTrashDisplayed?"info":"warning",on:{click:function(t){return e.showTrashed()}}},[e.isTrashDisplayed?e._e():a("span",[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("open-trash-bin"))+" ")]),e.isTrashDisplayed?a("span",[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("display-not-deleted-items"))+" ")]):e._e()])])])},Yr=[],Wr=(a("ec09"),{name:"PromptDate",props:{title:String,defaultDate:[String,Date],format:String,placeholder:String},data:function(){var e=this.$store.state.i18n.locale;return{currentDate:this.defaultDate,datepickerLang:Ue[e]}},methods:{formatDate:function(e){return this.format||r()(e).format("LL")},handleChange:function(e){this.currentDate=e},handleSubmit:function(){this.$emit("close",{date:this.currentDate})},handleClose:function(){this.$emit("close")}},render:function(){var e=arguments[0],t=this.$t,a=this.title,i=this.currentDate,s=this.datepickerLang,n=this.formatDate,r=this.placeholder,o=this.handleChange,l=this.handleSubmit,c=this.handleClose;return e("div",{class:"PromptDate"},[e("div",{class:"PromptDate__header"},[e("h2",{class:"PromptDate__header__title"},[a]),e("button",{class:"PromptDate__header__btn-close",on:{click:c}},[e("i",{class:"fas fa-times"})])]),e("div",{class:"PromptDate__main"},[e(Re["a"],{attrs:{value:i,language:s,format:n,placeholder:t(r),"input-class":"PromptDate__datepicker__input","monday-first":!0},class:"PromptDate__datepicker",on:{input:o}})]),e("hr",{class:"PromptDate__separator"}),e("div",{class:"PromptDate__footer"},[e("button",{on:{click:l},class:"success"},[e("i",{class:"fas fa-check"})," ",t("choose-date")]),e("button",{on:{click:c}},[e("i",{class:"fas fa-times"})," ",t("close")])])])}}),Kr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"AssignTags"},[a("Header",{attrs:{title:e.title},on:{close:function(t){return e.$emit("close")}}}),a("div",{staticClass:"AssignTags__content"},[a("p",{staticClass:"AssignTags__help"},[e._v(e._s(e.$t("choose-tags-below")))]),a("div",{staticClass:"AssignTags__form"},[a("VueSelect",{attrs:{options:e.$store.getters["tags/options"],"close-on-select":!1,multiple:""},model:{value:e.tags,callback:function(t){e.tags=t},expression:"tags"}}),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("remove-all-tags"),expression:"$t('remove-all-tags')"}],staticClass:"AssignTags__form__remove-all",on:{click:e.removeAll}},[a("i",{staticClass:"fas fa-backspace"})])],1)]),a("div",{staticClass:"AssignTags__actions"},[e.error?a("p",{staticClass:"AssignTags__error"},[e._v(e._s(e.error))]):e._e(),a("button",{staticClass:"success",on:{click:e.save}},[e.isLoading?a("i",{staticClass:"fas fa-circle-notch fa-spin"}):e._e(),e.isLoading?a("span",[e._v(e._s(e.$t("saving")))]):a("span",[e._v(e._s(e.$t("save")))])]),a("button",{on:{click:function(t){return e.$emit("close")}}},[e._v(" "+e._s(e.$t("cancel"))+" ")])])],1)},Xr=[],Zr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"AssignTagsHeader"},[a("h4",{staticClass:"AssignTagsHeader__title"},[a("i",{staticClass:"fas fa-tags"}),e._v(" "+e._s(e.title)+" ")]),a("button",{staticClass:"close",on:{click:function(t){return e.$emit("close")}}},[a("i",{staticClass:"fas fa-times"})])])},Jr=[],eo={name:"AssignTagsHeader",props:["title"]},to=eo,ao=(a("56e7"),Object(ge["a"])(to,Zr,Jr,!1,null,null,null)),io=ao.exports,so={name:"AssignTags",components:{Header:io,VueSelect:Ni.a},props:["entity","id","name","initialTags"],data:function(){return{isLoading:!1,title:this.$t("entity-name-tags",{entityName:this.name||""}),tags:this.initialTags?this.initialTags.map((function(e){var t=e.id,a=e.name;return{label:a,value:t}})):[],error:null}},methods:{save:function(){var e=this;this.isLoading=!0;var t=this.tags.map((function(e){return e.label}));this.$http.put("".concat(this.entity,"/").concat(this.id),{tags:t}).then((function(){e.$emit("saved"),e.$emit("close")})).catch((function(t){if(t.response){var a=t.response.data.error.message;e.error=a}else e.error=t})).finally((function(){e.isLoading=!1}))},removeAll:function(){this.tags=[]}}},no=so,ro=(a("4a4d"),Object(ge["a"])(no,Kr,Xr,!1,null,null,null)),oo=ro.exports,lo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"MaterialTags"},e._l(e.tags,(function(t){return a("li",{key:t.id,staticClass:"MaterialTags__item"},[a("i",{staticClass:"fas fa-tag"}),e._v(" "+e._s(t.name)+" ")])})),0)},co=[],uo={name:"MaterialTags",props:{tags:Array}},mo=uo,po=(a("3da3"),Object(ge["a"])(mo,lo,co,!1,null,null,null)),ho=po.exports,fo={name:"Materials",components:{Help:Be,Dropdown:Fa,MaterialsFilters:vs,MaterialTags:ho},data:function(){var e=this,t=["reference","name","description","park","category","rental_price","replacement_price","stock_quantity","out_of_order_quantity","tags","actions"],a=_.billingMode;"none"===a&&(t=t.filter((function(e){return"rental_price"!==e})));var i=t.findIndex((function(e){return"stock_quantity"===e}));return{help:"page-materials.help",error:null,isLoading:!1,isDisplayTrashed:!1,isTrashDisplayed:!1,quantityColumnIndex:i,dateForQuantities:null,columns:t,options:{columnsDropdown:!0,preserveState:!0,orderBy:{column:"name",ascending:!0},initialPage:this.$route.query.page||1,sortable:["reference","name","description","rental_price","replacement_price","stock_quantity","out_of_order_quantity"],columnsDisplay:{park:"mobile",description:"mobile",replacement_price:"mobile",out_of_order_quantity:"mobile"},headings:{reference:this.$t("ref"),name:this.$t("name"),description:this.$t("description"),park:this.$t("park"),category:this.$t("category"),rental_price:this.$t("rent-price"),replacement_price:this.$t("repl-price"),stock_quantity:this.$t("quantity"),remaining_quantity:this.$t("remaining-quantity"),out_of_order_quantity:this.$t("quantity-out-of-order"),tags:this.$t("tags"),actions:""},columnsClasses:{reference:"Materials__ref",name:"Materials__name",park:"Materials__park",category:"Materials__category",description:"Materials__description",rental_price:"Materials__rental-price",replacement_price:"Materials__replacement-price",stock_quantity:"Materials__quantity",remaining_quantity:"Materials__remaining-quantity",out_of_order_quantity:"Materials__quantity-out",tags:"Materials__tags"},requestFunction:function(t){e.isLoading=!0;var a=e.getFilters(),i=Object(g["a"])(Object(g["a"])(Object(g["a"])({},t),a),{},{deleted:e.isDisplayTrashed?"1":"0"});return e.$http.get("materials",{params:i}).catch(e.showError).finally((function(){e.isTrashDisplayed=e.isDisplayTrashed,e.isLoading=!1}))}}}},computed:{isAdmin:function(){return this.$store.getters["auth/is"]("admin")},downloadListingUrl:function(){var e=_.baseUrl;return"".concat(e,"/materials/pdf")},dropdownItemClass:function(){return ja()}},mounted:function(){this.$store.dispatch("categories/fetch"),this.$store.dispatch("tags/fetch")},methods:{getParkName:function(e){return this.$store.getters["parks/parkName"](e)||"--"},getCategoryName:function(e){return this.$store.getters["categories/categoryName"](e)},getSubCategoryName:function(e){return this.$store.getters["categories/subCategoryName"](e)},getFilters:function(){var e={};return this.$route.query.park&&Xs(this.$route.query.park)&&(e.park=parseInt(this.$route.query.park,10)),this.$route.query.category&&(e.category=this.$route.query.category),this.$route.query.subCategory&&(e.subCategory=this.$route.query.subCategory),this.$route.query.tags&&(e.tags=JSON.parse(this.$route.query.tags)),this.dateForQuantities&&(e.dateForQuantities=this.dateForQuantities.format("YYYY-MM-DD")),e},deleteMaterial:function(e){var t=this,a=!this.isTrashDisplayed;ut.ConfirmDelete(this.$t,"materials",a).then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.delete("materials/".concat(e)).then(t.refreshTable).catch(t.showError))}))},restoreMaterial:function(e){var t=this;ut.ConfirmRestore(this.$t,"materials").then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.put("materials/restore/".concat(e)).then(t.refreshTable).catch(t.showError))}))},setTags:function(e){var t=this,a=e.id,i=e.name,s=e.tags;if(!this.isTrashDisplayed){var n=Object(g["a"])(Object(g["a"])({},xe),{},{width:600,draggable:!0,clickToClose:!1});this.$modal.show(oo,{entity:"materials",id:a,name:i,initialTags:s},n,{"before-close":function(){t.refreshTable()}})}},refreshTable:function(){this.error=null,this.isLoading=!0,this.$refs.DataTable.getData()},refreshTableAndPagination:function(){this.error=null,this.isLoading=!0,this.$refs.DataTable.refresh()},showTrashed:function(){this.isDisplayTrashed=!this.isDisplayTrashed,this.refreshTableAndPagination()},showError:function(e){this.isLoading=!1,this.error=e},formatAmount:function(e){return null!==e?St(e):""},getStockQuantity:function(e){if(!e.is_unitary)return e.stock_quantity;var t=this.getFilters();if(!t.park)return e.units.length;var a=e.units.filter((function(e){return e.park_id===t.park}));return a.length},showQuantityAtDateModal:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.dateForQuantities){t.next=2;break}return t.abrupt("return");case 2:a=Object(g["a"])(Object(g["a"])({},xe),{},{width:600,draggable:!0,clickToClose:!1}),e.$modal.show(Wr,{title:e.$t("page-materials.display-quantities-at-date"),defaultDate:new Date},a,{"before-close":function(t){var a=t.params;a&&(e.dateForQuantities=r()(a.date),e.refreshTable(),e.columns.splice(e.quantityColumnIndex,1,"remaining_quantity"))}});case 4:case"end":return t.stop()}}),t)})))()},removeDateForQuantities:function(){this.dateForQuantities=null,this.columns.splice(this.quantityColumnIndex,1,"stock_quantity"),this.refreshTable()}}},vo=fo,_o=(a("0e0d"),Object(ge["a"])(vo,Gr,Yr,!1,null,null,null)),go=_o.exports,bo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"Material"},[a("form",{key:e.entitiesState,staticClass:"Form Form--fixed-actions Material__form",attrs:{method:"POST"},on:{submit:e.saveMaterial}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("minimal-infos"))+" "),a("span",{staticClass:"FormField__label__required"},[e._v("*")])]),a("FormField",{attrs:{name:"name",label:"name",required:"",errors:e.errors.name},model:{value:e.material.name,callback:function(t){e.$set(e.material,"name",t)},expression:"material.name"}}),a("FormField",{staticClass:"Material__ref",attrs:{name:"reference",label:"reference",required:"",errors:e.errors.reference},model:{value:e.material.reference,callback:function(t){e.$set(e.material,"reference",t)},expression:"material.reference"}}),a("FormField",{attrs:{required:"",type:"switch",name:"is_unitary",label:"is-unitary"},on:{input:e.handleUnitaryChange},model:{value:e.material.is_unitary,callback:function(t){e.$set(e.material,"is_unitary",t)},expression:"material.is_unitary"}}),a("FormField",{directives:[{name:"show",rawName:"v-show",value:!e.material.is_unitary,expression:"!material.is_unitary"}],attrs:{name:"park_id",label:"park",type:"select",required:"",options:e.parksOptions,errors:e.errors.park_id},model:{value:e.material.park_id,callback:function(t){e.$set(e.material,"park_id",t)},expression:"material.park_id"}}),a("FormField",{attrs:{name:"category_id",label:"category",type:"select",required:"",options:e.categoriesOptions,errors:e.errors.category_id},on:{change:e.handleCategoryChange},model:{value:e.material.category_id,callback:function(t){e.$set(e.material,"category_id",t)},expression:"material.category_id"}}),a("FormField",{attrs:{name:"sub_category_id",label:"sub-category",type:"select",options:e.subCategoriesOptions,errors:e.errors.sub_category_id},model:{value:e.material.sub_category_id,callback:function(t){e.$set(e.material,"sub_category_id",t)},expression:"material.sub_category_id"}}),a("FormField",{directives:[{name:"show",rawName:"v-show",value:e.showBilling,expression:"showBilling"}],staticClass:"Material__price",attrs:{name:"rental_price",label:"rental-price",type:"number",addon:e.currency,required:"",errors:e.errors.rental_price},on:{input:e.updateRentalPrice},model:{value:e.material.rental_price,callback:function(t){e.$set(e.material,"rental_price",t)},expression:"material.rental_price"}}),a("FormField",{directives:[{name:"show",rawName:"v-show",value:!e.material.is_unitary,expression:"!material.is_unitary"}],staticClass:"Material__quantity",attrs:{name:"stock_quantity",label:"quantity",type:"number",step:1,required:"",errors:e.errors.stock_quantity},model:{value:e.material.stock_quantity,callback:function(t){e.$set(e.material,"stock_quantity",t)},expression:"material.stock_quantity"}})],1),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("extra-infos"))+" ")]),a("FormField",{attrs:{name:"description",label:"description",type:"textarea",errors:e.errors.description},model:{value:e.material.description,callback:function(t){e.$set(e.material,"description",t)},expression:"material.description"}}),a("FormField",{staticClass:"Material__price",attrs:{name:"replacement_price",label:"replacement-price",type:"number",addon:e.currency,errors:e.errors.replacement_price},model:{value:e.material.replacement_price,callback:function(t){e.$set(e.material,"replacement_price",t)},expression:"material.replacement_price"}}),a("FormField",{directives:[{name:"show",rawName:"v-show",value:!e.material.is_unitary,expression:"!material.is_unitary"}],staticClass:"Material__quantity",attrs:{name:"out_of_order_quantity",label:"quantity-out-of-order",type:"number",step:1,errors:e.errors.out_of_order_quantity},model:{value:e.material.out_of_order_quantity,callback:function(t){e.$set(e.material,"out_of_order_quantity",t)},expression:"material.out_of_order_quantity"}}),a("FormField",{attrs:{name:"note",label:"notes",type:"textarea",errors:e.errors.note},model:{value:e.material.note,callback:function(t){e.$set(e.material,"note",t)},expression:"material.note"}})],1),e.showBilling?a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("billing-infos"))+" ")]),a("FormField",{attrs:{name:"is_discountable",label:"discountable",type:"switch",errors:e.errors.is_discountable},model:{value:e.material.is_discountable,callback:function(t){e.$set(e.material,"is_discountable",t)},expression:"material.is_discountable"}}),a("FormField",{attrs:{name:"is_hidden_on_bill",disabled:e.material.rental_price>0,disabledReason:e.$t("price-must-be-zero"),label:"hidden-on-bill",type:"switch",errors:e.errors.is_hidden_on_bill},model:{value:e.material.is_hidden_on_bill,callback:function(t){e.$set(e.material,"is_hidden_on_bill",t)},expression:"material.is_hidden_on_bill"}})],1):e._e(),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("special-attributes"))+" ")]),0===e.extraAttributes.length?a("p",{staticClass:"Material__no-attribute-help"},[e._v(" "+e._s(e.$t("page-attributes.no-attribute-yet"))+" ")]):e._e(),e.extraAttributes.length>0?a("div",{staticClass:"Material__attributes"},e._l(e.extraAttributes,(function(t){return a("FormField",{key:t.id,attrs:{name:t.name,label:t.name,addon:t.unit,type:e.getAttributeType(t.type),datepickerOptions:{format:"dd/MM/yyyy"}},on:{change:e.handleAttributeChange},model:{value:e.materialAttributes[t.id],callback:function(a){e.$set(e.materialAttributes,t.id,a)},expression:"materialAttributes[extraAttribute.id]"}})})),1):e._e(),e.isAdmin?a("router-link",{staticClass:"Material__modify-attribute-link",attrs:{to:"/attributes"}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-attributes.add-attributes"))+" ")]):e._e()],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("save"))+" ")])])]),a("section",{staticClass:"Material__side"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),a("ImageWithUpload",{attrs:{url:e.pictureUrl,name:e.material.picture,isLoading:e.isUploading,error:e.uploadError},on:{changePicture:e.handleChangePicture,resetPicture:e.handleResetPicture}}),e.isUploading?a("Progressbar",{attrs:{percent:e.uploadProgress}}):e._e()],1)])])])},yo=[],ko=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ImageWithUpload",class:{"ImageWithUpload--empty":!e.url}},[a("img",{staticClass:"ImageWithUpload__img",attrs:{src:e.imageSrc,alt:e.name||"No image"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"ImageWithUpload__actions"},[a("input",{ref:"chooseFilesButton",staticClass:"ImageWithUpload__upload-input",attrs:{type:"file",accept:"image/*"},on:{change:e.addFile}}),a("button",{staticClass:"info",on:{click:e.openFilesBrowser}},[e.name?[a("i",{staticClass:"fas fa-sync"}),e._v(" "+e._s(e.$t("change-the-picture"))+" ")]:[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("add-a-picture"))+" ")]],2),e.newPicture||e.deletedPicture?a("button",{staticClass:"warning",on:{click:e.cancelChangePicture}},[a("i",{staticClass:"fas fa-ban"}),e._v(" "+e._s(e.$t("cancel"))+" ")]):e._e(),e.name?a("button",{staticClass:"danger",on:{click:e.removePicture}},[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("remove-the-picture"))+" ")]):e._e()]),e.fileError?a("div",{staticClass:"ImageWithUpload__file-error"},[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.fileError)+" ")]):e._e(),a("Help",{attrs:{message:"",error:e.error,isLoading:e.isLoading}})],1)},Co=[],wo=(a("2b3d"),a("b680"),function(e){if(0===e)return"0 Bytes";var t=1024,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(t)),s=parseFloat((e/Math.pow(t,i)).toFixed(1));return"".concat(s," ").concat(a[i])}),$o=wo,Eo=a("154f"),xo=a.n(Eo),Do={name:"ImageWithUpload",components:{Help:Be},props:{url:String,name:String,isLoading:Boolean,error:null},data:function(){return{fileError:null,newPicture:null,deletedPicture:!1}},computed:{imageSrc:function(){return this.newPicture?URL.createObjectURL(this.newPicture):this.url||xo.a}},methods:{openFilesBrowser:function(){var e=this.$refs.chooseFilesButton;e.click()},addFile:function(e){e.preventDefault(),this.fileError=null;var t=e.dataTransfer?e.dataTransfer.files:e.target.files;if(t&&0!==t.length){var a=t[0],i=a.type,s=a.size;re.includes(i)?s>oe?this.fileError=this.$t("errors.file-size-exceeded",{max:$o(oe)}):(this.newPicture=a,this.$emit("changePicture",this.newPicture)):this.fileError=this.$t("errors.file-type-not-allowed",{type:i})}},cancelChangePicture:function(){this.newPicture=null,this.deletedPicture=!1,this.$emit("resetPicture")},removePicture:function(){this.fileError=null,this.newPicture=null,this.deletedPicture=!0,this.$emit("changePicture",null)}}},Mo=Do,So=(a("0b2c"),Object(ge["a"])(Mo,ko,Co,!1,null,null,null)),Lo=So.exports,Io=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Progressbar"},[a("div",{staticClass:"Progressbar__progress",style:{width:e.percent+"%"}},[e.percent<100?a("span",[e._v(e._s(e.humanPercent)+"%")]):e._e(),100===e.percent?a("span",[e._v(e._s(e.$t("almost-done")))]):e._e()])])},To=[],Ao={name:"Progressbar",props:{percent:{type:Number,required:!0}},computed:{humanPercent:function(){return Math.round(this.percent)}}},Oo=Ao,jo=(a("e3e6"),Object(ge["a"])(Oo,Io,To,!1,null,null,null)),Fo=jo.exports,qo={name:"Material",components:{Help:Be,FormField:ze,ImageWithUpload:Lo,Progressbar:Fo},data:function(){var e="none"!==_.billingMode;return{help:"page-materials.help-edit",error:null,isLoading:!1,extraAttributes:[],showBilling:e,material:{id:this.$route.params.id||null,name:"",reference:"",park_id:this.$route.query.parkId||"",category_id:"",is_unitary:!1,rental_price:e?"":0,stock_quantity:"1",description:"",sub_category_id:"",replacement_price:"",out_of_order_quantity:"0",picture:null,note:"",is_hidden_on_bill:!1,is_discountable:!0,attributes:[]},materialAttributes:{},initialPicture:null,newPicture:null,isUploading:!1,uploadProgress:0,uploadError:null,errors:{name:null,reference:null,park_id:null,category_id:null,rental_price:null,stock_quantity:null},currency:_.currency.symbol,subCategoriesOptions:[{value:"",label:this.$t("please-choose")}]}},computed:{entitiesState:function(){var e=this.$store.state,t=e.parks,a=e.categories;return t.isFetched&&a.isFetched?"ready":"fetching"},parksOptions:function(){return this.$store.getters["parks/options"]},firstPark:function(){return this.$store.getters["parks/firstPark"]},categoriesOptions:function(){return this.$store.getters["categories/options"]},isAdmin:function(){return this.$store.getters["auth/is"]("admin")},pictureUrl:function(){var e=_.baseUrl,t=this.material,a=t.id,i=t.picture;return i?"".concat(e,"/materials/").concat(a,"/picture"):null}},mounted:function(){this.$store.dispatch("parks/fetch"),this.$store.dispatch("categories/fetch"),this.fetchMaterial(),this.setDefaultPark()},watch:{firstPark:function(){this.setDefaultPark()}},methods:{fetchMaterial:function(){var e=this,t=this.material.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setMaterialData(a),e.fetchAttributes(),e.isLoading=!1})).catch(this.displayError)}else this.fetchAttributes()},setDefaultPark:function(){var e;null===this.material.id&&1===this.parksOptions.length&&(this.material.park_id=(null===(e=this.firstPark)||void 0===e?void 0:e.id)||"")},fetchAttributes:function(){var e=this;this.extraAttributes=[];var t=this.material.category_id;t&&this.$http.get("attributes?category=".concat(t)).then((function(t){var a=t.data;e.extraAttributes=a})).catch(this.displayError)},getAttributeType:function(e){switch(e){case"integer":case"float":return"number";case"boolean":return"switch";case"date":return"date";default:return"text"}},handleAttributeChange:function(e){var t=e.field,a=e.newValue,i=this.extraAttributes.find((function(e){return e.name===t}));i&&(this.materialAttributes=Object(g["a"])(Object(g["a"])({},this.materialAttributes),{},Object(Ms["a"])({},i.id,a)))},handleUnitaryChange:function(e){e&&(this.material.park_id=null)},saveMaterial:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r,o,l,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.preventDefault(),t.resetHelpLoading(),i=t.material.id,s=i?t.$http.put:t.$http.post,n=i?"materials/".concat(i):"materials",r=Object.keys(t.materialAttributes).map((function(e){return{id:e,value:t.materialAttributes[e]}})),o=Object(g["a"])(Object(g["a"])({},t.material),{},{attributes:r}),o.is_unitary&&(o.stock_quantity=null,o.out_of_order_quantity=null),a.prev=8,a.next=11,s(n,o);case 11:return l=a.sent,c=l.data,t.setMaterialData(c),a.next=16,t.uploadNewPicture();case 16:t.isLoading=!1,t.help={type:"success",text:"page-materials.saved"},setTimeout((function(){t.$router.push("/materials/".concat(c.id,"/view"))}),300),a.next=24;break;case 21:a.prev=21,a.t0=a["catch"](8),t.displayError(a.t0);case 24:case"end":return a.stop()}}),a,null,[[8,21]])})))()},uploadNewPicture:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.newPicture){t.next=2;break}return t.abrupt("return");case 2:if(a=e.material.id,a){t.next=5;break}throw new Error("Cannot upload picture to anonymous material. Please save it before.");case 5:return e.isUploading=!0,e.uploadError=null,i=new FormData,i.append("picture-0",e.newPicture),s=function(t){if(t.lengthComputable){var a=t.loaded,i=t.total;e.uploadProgress=a/i*100}},t.prev=10,t.next=13,e.$http.post("materials/".concat(a,"/picture"),i,{onUploadProgress:s});case 13:t.next=19;break;case 15:throw t.prev=15,t.t0=t["catch"](10),e.uploadError=t.t0,new Error("Upload failed.");case 19:return t.prev=19,e.isUploading=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[10,15,19,22]])})))()},handleChangePicture:function(e){this.material.picture=(null===e||void 0===e?void 0:e.name)||null,this.newPicture=e},handleResetPicture:function(){this.material.picture=this.initialPicture,this.newPicture=null},resetHelpLoading:function(){this.help="page-materials.help-edit",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-materials.help-edit",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setMaterialData:function(e){this.material=e,this.initialPicture=e.picture,this.$store.commit("setPageSubTitle",this.material.name),this.updateSubCategories(),this.setMaterialAttributes()},updateRentalPrice:function(){this.material.rental_price>0&&(this.material.is_hidden_on_bill=!1)},handleCategoryChange:function(){this.fetchAttributes(),this.updateSubCategories()},updateSubCategories:function(){var e=this,t=this.$store.state.categories.list,a=t.find((function(t){return parseInt(t.id,10)===parseInt(e.material.category_id,10)}));a&&(this.subCategoriesOptions=S(a.sub_categories,null,this.$t("please-choose")),this.refreshSubCategorySelect())},setMaterialAttributes:function(){var e=this;this.materialAttributes={},this.material.attributes.forEach((function(t){e.materialAttributes[t.id]=t.value}))},refreshSubCategorySelect:function(){var e=this,t=parseInt(this.material.sub_category_id,10)||"";if(t){var a=this.subCategoriesOptions.find((function(e){return e.value===t}));a&&(this.material.sub_category_id="",setTimeout((function(){e.material.sub_category_id=t}),0))}}}},Po=qo,Bo=(a("4863"),Object(ge["a"])(Po,bo,yo,!1,null,null,null)),Ro=Bo.exports,Uo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"MaterialUnit"},[a("form",{staticClass:"Form",attrs:{method:"POST"},on:{submit:e.handleSubmit}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("informations"))+" ")]),a("FormField",{attrs:{name:"reference",label:"reference",errors:e.errors.reference,required:""},model:{value:e.unit.reference,callback:function(t){e.$set(e.unit,"reference",t)},expression:"unit.reference"}}),a("FormField",{attrs:{name:"park_id",label:"park",type:"select",options:e.parksOptions,errors:e.errors.park_id,required:""},model:{value:e.unit.park_id,callback:function(t){e.$set(e.unit,"park_id",t)},expression:"unit.park_id"}}),a("SelectSearch",{key:e.renderKey,attrs:{selectedItemLabel:e.unit.owner?e.unit.owner.full_name:null,label:"owner",formatOptions:e.formatOwnerOptions,fetchEntity:"persons"},model:{value:e.unit.person_id,callback:function(t){e.$set(e.unit,"person_id",t)},expression:"unit.person_id"}}),a("FormField",{attrs:{name:"serial_number",label:"serial-number",errors:e.errors.serial_number},model:{value:e.unit.serial_number,callback:function(t){e.$set(e.unit,"serial_number",t)},expression:"unit.serial_number"}}),a("FormField",{attrs:{name:"is_broken",label:"is-broken",type:"switch",errors:e.errors.is_broken},model:{value:e.unit.is_broken,callback:function(t){e.$set(e.unit,"is_broken",t)},expression:"unit.is_broken"}}),a("FormField",{attrs:{name:"is_lost",label:"is-lost",type:"switch",errors:e.errors.is_lost},model:{value:e.unit.is_lost,callback:function(t){e.$set(e.unit,"is_lost",t)},expression:"unit.is_lost"}}),a("FormField",{attrs:{name:"state",label:"state",type:"select",options:e.statesOptions,errors:e.errors.state},model:{value:e.unit.state,callback:function(t){e.$set(e.unit,"state",t)},expression:"unit.state"}}),a("FormField",{attrs:{name:"purchase_date",label:"purchase-date",type:"date",errors:e.errors.purchase_date,"datepicker-options":e.datepickerOptions},model:{value:e.unit.purchase_date,callback:function(t){e.$set(e.unit,"purchase_date",t)},expression:"unit.purchase_date"}}),a("FormField",{attrs:{name:"notes",label:"notes",type:"textarea",errors:e.errors.notes},model:{value:e.unit.notes,callback:function(t){e.$set(e.unit,"notes",t)},expression:"unit.notes"}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("save"))+" ")]),a("router-link",{attrs:{to:"/materials/"+e.materialId+"/view#units",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"Form__actions__cancel",attrs:{type:"button"},on:{click:i}},[e._v(" "+e._s(e.$t("cancel"))+" ")])]}}])})],1)]),a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1)])])},No=[],Vo=(a("08cb"),{name:"SelectSearch",props:{value:[String,Number],label:String,selectedItemLabel:String,formatOptions:{type:Function,required:!0},fetchEntity:{type:String,required:!0},fetchParams:Object},data:function(){var e=null;return this.value&&(e={value:this.value,label:this.selectedItemLabel||"??"}),{options:[],currentValue:e,error:null,minSearchCharacters:2}},methods:{handleSearch:function(e,t){e.length<this.minSearchCharacters||this.search(t,e)},search:Object(Vi["debounce"])(function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,a){var i,s,n,r,o,l,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.error=null,t(!0),i=this.fetchParams,s=void 0===i?{}:i,n=this.$http,r=this.fetchEntity,o=this.formatOptions,e.prev=3,l=Object(g["a"])(Object(g["a"])({},s),{},{search:a,limit:10}),e.next=7,n.get(r,{params:l});case 7:c=e.sent,u=c.data,this.options=o(u.data),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),this.error=e.t0.message;case 15:return e.prev=15,t(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[3,12,15,18]])})));return function(t,a){return e.apply(this,arguments)}}(),se),handleChange:function(e){var t=e||{value:null},a=t.value;this.$emit("input",a)}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.label,s=this.options,n=this.handleSearch,r=this.handleChange,o=this.error;return t("div",{class:"SelectSearch"},[i&&t("label",{class:"SelectSearch__label"},[a(i)]),t(Ni.a,{attrs:{filterable:!1,options:s,placeholder:a("start-typing-to-search")},on:{search:n,input:r},model:{value:e.currentValue,callback:function(t){e.currentValue=t}}},[t("p",{slot:"no-options"},[a("no-result-found-try-another-search")])]),o&&t("div",{class:"SelectSearch__error"},[o])])}}),Ho={name:"MaterialUnit",components:{FormField:ze,SelectSearch:Vo,Help:Be},data:function(){return{help:"page-material-units.help-edit",error:null,isLoading:!1,material:null,ongoingPersist:null,datepickerOptions:{format:"d MMMM yyyy",disabled:{from:new Date}},unit:{reference:"",serial_number:"",park_id:"",person_id:null,is_broken:!1,is_lost:!1,state:"state-of-use",purchase_date:"",notes:"",owner:null},errors:{reference:null,serial_number:null,park_id:null,person_id:null,is_broken:null,is_lost:null,state:null,purchase_date:null,notes:null},renderKey:1}},computed:{id:function(){var e=this.$route.params.id;return!Number.isNaN(e)&&Number.isFinite(parseInt(e,10))&&(e=parseInt(e,10)),e&&"new"!==e?e:null},materialId:function(){var e=this.$route.params.materialId;return!Number.isNaN(e)&&Number.isFinite(parseInt(e,10))&&(e=parseInt(e,10)),e||null},parksOptions:function(){return this.$store.getters["parks/options"]},statesOptions:function(){return this.$store.getters["unitStates/options"]},firstPark:function(){return this.$store.getters["parks/firstPark"]}},mounted:function(){this.$store.dispatch("parks/fetch"),this.$store.dispatch("unitStates/fetch"),this.fetchData(),this.setDefaultPark()},watch:{firstPark:function(){this.setDefaultPark()},unit:function(){this.renderKey+=1}},methods:{handleSubmit:function(e){e.preventDefault(),this.persist()},fetchData:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isLoading=!0,e.error=null,e.help="page-material-units.help-edit",t.prev=3,e.id){t.next=9;break}return t.next=7,e.fetchMaterial();case 7:t.next=11;break;case 9:return t.next=11,e.fetchUnit();case 11:return t.prev=11,e.isLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[3,,11,14]])})))()},fetchUnit:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.id){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.$http.get("material-units/".concat(e.id));case 5:a=t.sent,i=a.data,s=i.material,n=Object(Ti["a"])(i,["material"]),e.$store.commit("setPageSubTitle","".concat(n.reference," (").concat(s.name,")")),e.material=s,e.unit=n,e.materialId!==s.id&&e.$router.replace("/materials/".concat(s.id,"/units/").concat(n.id)),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](2),e.error=t.t0;case 17:case"end":return t.stop()}}),t,null,[[2,14]])})))()},fetchMaterial:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.materialId){t.next=3;break}return e.$router.replace("/materials"),t.abrupt("return");case 3:return t.prev=3,t.next=6,e.$http.get("materials/".concat(e.materialId));case 6:a=t.sent,i=a.data,e.$store.commit("setPageSubTitle",i.name),e.material=i,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](3),e.error=t.t0,o=(null===(s=t.t0.response)||void 0===s||null===(n=s.data)||void 0===n||null===(r=n.error)||void 0===r?void 0:r.code)||0,o>=400&&o<=499&&e.$router.replace("/materials");case 17:case"end":return t.stop()}}),t,null,[[3,12]])})))()},persist:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,o,l,c,u,d,m,p,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.ongoingPersist){t.next=4;break}return t.next=3,e.ongoingPersist;case 3:return t.abrupt("return");case 4:return e.isLoading=!1,e.error=null,e.help="",a=e.id?"put":"post",i=e.id?"material-units/".concat(e.id):"materials/".concat(e.materialId,"/units"),t.prev=9,s=e.unit.purchase_date,n=Object(g["a"])(Object(g["a"])({},e.unit),{},{purchase_date:s?r()(s).format("YYYY-MM-DD"):null}),e.ongoingPersist=e.$http[a](i,n),t.next=15,e.ongoingPersist;case 15:o=t.sent,l=o.data,e.help={type:"success",text:"page-material-units.saved"},e.$store.commit("setPageSubTitle","".concat(l.reference," (").concat(e.material.name,")")),e.unit=l,c={path:"/materials/".concat(e.material.id,"/view"),hash:"#units"},setTimeout((function(){e.$router.push(c)}),300),t.next=29;break;case 24:t.prev=24,t.t0=t["catch"](9),e.error=t.t0,m=(null===(u=t.t0.response)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.error)||{code:0,details:{}},p=m.code,h=m.details,400===p&&(e.errors=Object(g["a"])({},h));case 29:return t.prev=29,e.isLoading=!1,e.ongoingPersist=null,t.finish(29);case 33:case"end":return t.stop()}}),t,null,[[9,24,29,33]])})))()},formatOwnerOptions:function(e){return S(e,Ki)},setDefaultPark:function(){var e;null===this.id&&1===this.parksOptions.length&&(this.unit.park_id=(null===(e=this.firstPark)||void 0===e?void 0:e.id)||"")}}},zo=Ho,Qo=(a("61c1"),Object(ge["a"])(zo,Uo,No,!1,null,null,null)),Go=Qo.exports,Yo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"MaterialView"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),e.isLoading?e._e():a("tabs",{staticClass:"MaterialView__body",attrs:{onSelect:e.onSelectTab,defaultIndex:e.selectedTabIndex},scopedSlots:e._u([{key:"right",fn:function(){return[1===e.selectedTabIndex?a("nav",{staticClass:"MaterialView__menu"},[a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-add"),expression:"$t('action-add')"}],attrs:{to:"/materials/"+e.material.id+"/units/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",on:{click:i}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-materials-view.add-unit"))+" ")])]}}],null,!1,1903950228)})],1):e._e()]},proxy:!0}],null,!1,4145705691)},[a("template",{slot:"infos"},[a("i",{staticClass:"fas fa-info-circle"}),e._v(" "+e._s(e.$t("informations"))+" ")]),a("template",{slot:"units"},[a("i",{staticClass:"fas fa-qrcode"}),e._v(" "+e._s(e.$t("units"))+" ")]),a("template",{slot:"documents"},[a("i",{staticClass:"fas fa-file-pdf"}),e._v(" "+e._s(e.$t("documents"))+" ")]),a("template",{slot:"availabilities"},[a("i",{staticClass:"far fa-calendar-alt"}),e._v(" "+e._s(e.$t("page-materials-view.booking-periods.title"))+" ")]),a("tab",{attrs:{"title-slot":"infos"}},[a("Infos",{attrs:{material:e.material}})],1),e.material.is_unitary?a("tab",{attrs:{"title-slot":"units"}},[a("Units",{attrs:{material:e.material},on:{error:e.displayError,outdated:e.fetchMaterial}})],1):e._e(),a("tab",{attrs:{"title-slot":"documents"}},[a("Documents",{attrs:{material:e.material}})],1),a("tab",{attrs:{"title-slot":"availabilities"}},[a("Availabilities",{attrs:{materialName:e.material.name,units:e.material.units}})],1)],2)],1)])])},Wo=[],Ko=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialViewInfos"},[a("section",{staticClass:"MaterialViewInfos__main"},[a("h2",[e._v(" "+e._s(e.material.reference)+" ")]),a("h3",[a("router-link",{attrs:{to:"/materials?"+e.queryStringCategory}},[e._v(" "+e._s(e.categoryName)+" ")]),e.subCategoryName?a("span",[e._v("/")]):e._e(),e.subCategoryName?a("router-link",{attrs:{to:"/materials?"+e.queryStringSubCategory}},[e._v(" "+e._s(e.subCategoryName)+" ")]):e._e(),e._v(" / "+e._s(e.material.name)+" ")],1),a("p",[e._v(e._s(e.material.description))]),a("h3",[e._v(e._s(e.$t("quantities")))]),a("ul",[a("li",{staticClass:"MaterialViewInfos__stock-quantity"},[e._v(" "+e._s(e.$t("stock-items-count",{count:e.material.stock_quantity||0}))+" ")]),e.material.out_of_order_quantity>0?a("li",{staticClass:"MaterialViewInfos__out-of-order"},[e._v(" "+e._s(e.$t("out-of-order-items-count",{count:e.material.out_of_order_quantity||0}))+" ")]):e._e()]),e.showBilling?a("div",{staticClass:"MaterialViewInfos__billing"},[a("h3",[e._v(e._s(e.$t("prices")))]),a("ul",[a("li",{staticClass:"MaterialViewInfos__rental-price"},[e._v(" "+e._s(e.$t("value-per-day",{value:e.rentalPrice}))+" ")]),e.replacementPrice?a("li",[e._v(" "+e._s(e.$t("replacement-price"))+" "+e._s(e.replacementPrice)+" ")]):e._e()]),a("h3",[e._v(e._s(e.$t("billing")))]),e.material.is_hidden_on_bill?a("p",[e._v(" "+e._s(e.$t("material-not-displayed-on-bill"))+" ")]):e._e(),e.material.is_discountable?a("p",[e._v(" "+e._s(e.$t("material-is-discountable"))+" ")]):e._e()]):e._e(),e.material.attributes.length>0?a("Attributes",{attrs:{attributes:e.material.attributes}}):e._e(),e.material.note?a("div",{staticClass:"MaterialViewInfos__notes"},[a("h3",[e._v(e._s(e.$t("notes")))]),a("p",{staticClass:"MaterialViewInfos__notes"},[e._v(e._s(e.material.note))])]):e._e()],1),e.material.picture?a("section",{staticClass:"MaterialViewInfos__picture"},[a("a",{attrs:{href:e.pictureUrl,target:"blank",title:e.$t("page-materials-view.infos.click-to-open-image")}},[a("img",{staticClass:"MaterialViewInfos__picture__img",attrs:{src:e.pictureUrl,alt:e.material.picture}})])]):e._e(),a("section",{staticClass:"MaterialViewInfos__extras"},[a("div",{staticClass:"MaterialViewInfos__actions"},[a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/materials/"+e.material.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"info",on:{click:i}},[a("i",{staticClass:"fas fa-edit"}),e._v(" "+e._s(e.$t("action-edit"))+" ")])]}}])})],1),a("div",{staticClass:"MaterialViewInfos__categories"},[a("p",[e._v(e._s(e.$t("category"))+": "),a("strong",[e._v(e._s(e.categoryName))])]),e.subCategoryName?a("p",[e._v(" "+e._s(e.$t("sub-category"))+": "),a("strong",[e._v(e._s(e.subCategoryName))])]):e._e()]),a("MaterialTags",{attrs:{tags:e.material.tags}}),a("div",{staticClass:"MaterialViewInfos__dates"},[a("p",[e._v(e._s(e.$t("created-at"))+" "+e._s(e.createDate))]),a("p",[e._v(e._s(e.$t("updated-at"))+" "+e._s(e.updateDate))])])],1)])},Xo=[],Zo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialViewInfosAttributes"},[a("h3",[e._v(e._s(e.$t("special-attributes")))]),e.attributes.length>0?a("ul",{staticClass:"MaterialViewInfosAttributes__list"},e._l(e.attributes,(function(t){return a("li",{key:t.id,staticClass:"MaterialViewInfosAttributes__list__item"},[e._v(" "+e._s(t.name)+": "),["boolean","date"].includes(t.type)?e._e():a("span",{staticClass:"MaterialViewInfosAttributes__list__item__value"},[e._v(" "+e._s(t.value)+" "+e._s(t.unit)+" ")]),"date"===t.type?a("span",{staticClass:"MaterialViewInfosAttributes__list__item__value"},[e._v(" "+e._s(e.formatDate(t.value))+" ")]):e._e(),"boolean"===t.type?a("span",{staticClass:"MaterialViewInfosAttributes__list__item__value"},[e._v(" "+e._s(t.value?e.$t("yes"):e.$t("no"))+" ")]):e._e()])})),0):e._e()])},Jo=[],el={name:"MaterialViewInfosAttributes",props:{attributes:{required:!0,type:Array}},methods:{formatDate:function(e){return r()(e).format("DD/MM/yyyy")}}},tl=el,al=(a("f0d4"),Object(ge["a"])(tl,Zo,Jo,!1,null,null,null)),il=al.exports,sl={name:"MaterialViewInfos",components:{Attributes:il,MaterialTags:ho},props:{material:{required:!0,type:Object}},data:function(){return{showBilling:"none"!==_.billingMode}},computed:{createDate:function(){var e=this.material.created_at;return e?r()(e).format("L"):null},updateDate:function(){var e=this.material.updated_at;return e?r()(e).format("L"):null},categoryName:function(){var e=this.material.category_id,t=this.$store.getters["categories/categoryName"];return t(e)},subCategoryName:function(){var e=this.material.sub_category_id,t=this.$store.getters["categories/subCategoryName"];return t(e)},rentalPrice:function(){var e=this.material.rental_price;return e?St(e):null},replacementPrice:function(){var e=this.material.replacement_price;return e?St(e):null},queryStringCategory:function(){return"category=".concat(this.material.category_id)},queryStringSubCategory:function(){return"category=".concat(this.material.category_id,"&subCategory=").concat(this.material.sub_category_id)},pictureUrl:function(){var e=_.baseUrl,t=this.material,a=t.id,i=t.picture;return i?"".concat(e,"/materials/").concat(a,"/picture"):null}},mounted:function(){this.$store.commit("setPageSubTitle",this.material.name)}},nl=sl,rl=(a("7f15"),Object(ge["a"])(nl,Ko,Xo,!1,null,null,null)),ol=rl.exports,ll=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialViewDocuments"},[a("section",{staticClass:"MaterialViewDocuments__main"},[0===e.documents.length?a("p",{staticClass:"MaterialViewDocuments__no-document"},[e._v(" "+e._s(e.$t("page-materials-view.documents.no-document"))+" ")]):e._e(),e.documents.length>0?a("ul",{staticClass:"MaterialViewDocuments__list"},e._l(e.documents,(function(t){return a("DocumentItem",{key:t.id,attrs:{file:t},on:{remove:e.removeDocument}})})),1):e._e(),a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("DocumentUpload",{attrs:{materialId:e.materialId},on:{uploadSuccess:e.handleUploadSuccess}})],1)},cl=[],ul=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"MaterialViewDocumentsItem",class:{"MaterialViewDocumentsItem--with-link":!!e.file.id}},[a("div",{staticClass:"MaterialViewDocumentsItem__icon"},[e.file.id?a("a",{staticClass:"MaterialViewDocumentsItem__link",attrs:{href:e.fileUrl,target:"_blank",title:e.$t("page-materials-view.documents.click-to-open")}},[a("i",{staticClass:"fas",class:e.iconName})]):a("span",{staticClass:"MaterialViewDocumentsItem__no-link"},[a("i",{staticClass:"fas",class:e.iconName})])]),a("div",{staticClass:"MaterialViewDocumentsItem__name"},[e.file.id?a("a",{staticClass:"MaterialViewDocumentsItem__link",attrs:{href:e.fileUrl,target:"_blank",title:e.$t("page-materials-view.documents.click-to-open")}},[e._v(" "+e._s(e.file.name)+" ")]):a("span",{staticClass:"MaterialViewDocumentsItem__no-link"},[e._v(" "+e._s(e.file.name)+" ")])]),a("div",{staticClass:"MaterialViewDocumentsItem__size"},[e._v(" "+e._s(e.fileSize)+" ")]),a("div",{staticClass:"MaterialViewDocumentsItem__actions"},[a("button",{staticClass:"danger",on:{click:e.handleClickRemove}},[a("i",{staticClass:"fas fa-trash"})])])])},dl=[],ml=(a("2ca0"),function(e,t){return t.some((function(t){return e.includes(t)}))}),pl=ml,hl={name:"MaterialViewDocumentsItem",props:{file:{type:[File,Object],required:!0}},computed:{fileSize:function(){return $o(this.file.size)},fileUrl:function(){var e=_.baseUrl;return"".concat(e,"/documents/").concat(this.file.id,"/download")},iconName:function(){var e=this.file.type;return"application/pdf"===e?"fa-file-pdf":e.startsWith("image/")?"fa-file-image":e.startsWith("video/")?"fa-file-video":e.startsWith("audio/")?"fa-file-audio":e.startsWith("text/")?"fa-file-alt":pl(e,["zip","octet-stream","x-rar","x-tar","x-7z"])?"fa-file-archive":pl(e,["sheet","excel"])?"fa-file-excel":pl(e,["wordprocessingml.document","msword"])?"fa-file-word":pl(e,["presentation","powerpoint"])?"fa-file-powerpoint":"fa-file"}},methods:{handleClickRemove:function(){this.$emit("remove",this.file)}}},fl=hl,vl=(a("0e63"),Object(ge["a"])(fl,ul,dl,!1,null,null,null)),_l=vl.exports,gl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"MaterialViewDocumentsUpload",class:{"MaterialViewDocumentsUpload--drag-over":e.isDragging},on:{drop:function(t){return t.preventDefault(),e.addFiles(t)},dragover:function(t){return t.preventDefault(),e.handleDragover(t)},dragleave:function(t){return t.preventDefault(),e.handleDragleave(t)}}},[a("h2",{staticClass:"MaterialViewDocumentsUpload__title"},[e._v(" "+e._s(e.$t("page-materials-view.documents.drag-and-drop-files-here"))+" ")]),a("button",{staticClass:"MaterialViewDocumentsUpload__choose-files info",on:{click:e.openFilesBrowser}},[e._v(" "+e._s(e.$t("page-materials-view.documents.choose-files"))+" ")]),a("ul",{staticClass:"MaterialViewDocumentsUpload__send-list"},e._l(e.files,(function(t){return a("DocumentItem",{key:t.name,attrs:{file:t},on:{remove:e.removeFile}})})),1),e.fileErrors.length>0?a("ul",{staticClass:"MaterialViewDocumentsUpload__file-errors"},e._l(e.fileErrors,(function(t){return a("li",{key:t.fileName,staticClass:"MaterialViewDocumentsUpload__file-errors__item"},[a("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(t.fileName)+" → "+e._s(t.message)+" ")])})),0):e._e(),a("div",{staticClass:"MaterialViewDocumentsUpload__actions"},[e.files.length>0?a("button",{staticClass:"MaterialViewDocumentsUpload__actions__send-files success",attrs:{disabled:e.isLoading},on:{click:e.uploadFiles}},[a("i",{staticClass:"fas fa-upload"}),e._v(" "+e._s(e.$t("page-materials-view.documents.send-files",{count:e.files.length},e.files.length))+" ")]):e._e(),a("input",{ref:"chooseFilesButton",staticClass:"MaterialViewDocumentsUpload__actions__file-input",attrs:{type:"file",multiple:""},on:{change:e.addFiles}}),a("Help",{attrs:{message:"",error:e.error,isLoading:e.isLoading}})],1),e.uploadProgress>0?a("Progressbar",{attrs:{percent:e.uploadProgress}}):e._e()],1)},bl=[],yl={name:"MaterialViewDocumentsUpload",components:{Help:Be,DocumentItem:_l,Progressbar:Fo},props:{materialId:{type:String,required:!0}},data:function(){return{error:null,fileErrors:[],isDragging:!1,isLoading:!1,files:[],uploadProgress:0}},methods:{openFilesBrowser:function(){var e=this.$refs.chooseFilesButton;e.click()},handleDragover:function(){this.isDragging=!0},handleDragleave:function(){this.isDragging=!1},checkFile:function(e){var t=e.type,a=e.size,i=e.name;if(!ne.includes(t))return this.fileErrors.push({fileName:i,message:this.$t("errors.file-type-not-allowed",{type:t})}),!1;if(a>oe)return this.fileErrors.push({fileName:i,message:this.$t("errors.file-size-exceeded",{max:$o(oe)})}),!1;var s=this.files.some((function(e){var t=e.name;return t===i}));return!s||(this.fileErrors.push({fileName:i,message:this.$t("errors.file-already-exists")}),!1)},addFiles:function(e){e.preventDefault(),this.isDragging=!1,this.fileErrors=[],this.error=null;var t=e.dataTransfer?e.dataTransfer.files:e.target.files;if(t&&0!==t.length){var a=Object(st["a"])(t).filter(this.checkFile);this.files=[].concat(Object(st["a"])(this.files),Object(st["a"])(a)).sort((function(e,t){var a=e.name.toLowerCase(),i=t.name.toLowerCase();return a<i?-1:a>i?1:0}))}},removeFile:function(e){this.fileErrors=[],this.files=this.files.filter((function(t){var a=t.name;return a!==e.name}))},uploadFiles:function(){var e=this;this.fileErrors=[],this.error=null,this.isLoading=!0,this.uploadProgress=0;var t=new FormData;this.files.forEach((function(e,a){t.append("file-".concat(a),e)}));var a=function(t){if(t.lengthComputable){var a=t.loaded,i=t.total;e.uploadProgress=a/i*100}};this.$http.post("materials/".concat(this.materialId,"/documents"),t,{onUploadProgress:a}).then((function(){e.isLoading=!1,e.files=[],e.$emit("uploadSuccess"),e.uploadProgress=0})).catch(this.displayError)},displayError:function(e){this.error=e,this.isLoading=!1}}},kl=yl,Cl=(a("3a4c"),Object(ge["a"])(kl,gl,bl,!1,null,null,null)),wl=Cl.exports,$l={name:"MaterialViewDocuments",components:{Help:Be,DocumentItem:_l,DocumentUpload:wl},props:{material:{required:!0,type:Object}},data:function(){return{help:"",error:null,isLoading:!1,materialId:this.$route.params.id,documents:[]}},mounted:function(){this.$store.commit("setPageSubTitle",this.material.name),this.fetchDocuments()},methods:{fetchDocuments:function(){var e=this;this.isLoading=!0,this.error=null,this.$http.get("materials/".concat(this.materialId,"/documents")).then((function(t){var a=t.data;e.documents=a,e.isLoading=!1})).catch(this.displayError)},handleUploadSuccess:function(){this.help={type:"success",text:"page-materials-view.documents.saved"},this.fetchDocuments()},removeDocument:function(e){var t=this;this.help="",this.error=null,ut.ConfirmDelete(this.$t,"materials-view.documents",!1).then((function(a){var i=a.value;i&&(t.isLoading=!0,t.$http.delete("documents/".concat(e.id)).then((function(){t.isLoading=!1,t.help={type:"success",text:"page-materials-view.documents.deleted"},t.fetchDocuments()})).catch(t.displayError))}))},displayError:function(e){this.error=e,this.isLoading=!1}}},El=$l,xl=(a("a245"),Object(ge["a"])(El,ll,cl,!1,null,null,null)),Dl=xl.exports,Ml=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialViewUnits"},[a("v-client-table",{attrs:{data:e.material.units,columns:e.columns,options:e.options},scopedSlots:e._u([{key:"park",fn:function(t){return[e._v(" "+e._s(e.getParkName(t.row.park_id))+" ")]}},{key:"owner",fn:function(t){return[t.row.owner?a("span",[e._v(" "+e._s(t.row.owner.full_name)+" ")]):e._e()]}},{key:"is_broken",fn:function(t){return[t.row.is_broken?a("span",{staticClass:"MaterialViewUnits__yes-warning"},[e._v(" "+e._s(e.$t("yes"))+" ")]):a("span",{staticClass:"MaterialViewUnits__no-ok"},[e._v(e._s(e.$t("no")))])]}},{key:"is_lost",fn:function(t){return[t.row.is_lost?a("span",{staticClass:"MaterialViewUnits__yes-danger"},[e._v(" "+e._s(e.$t("yes"))+" ")]):a("span",{staticClass:"MaterialViewUnits__no-ok"},[e._v(e._s(e.$t("no")))])]}},{key:"state",fn:function(t){return[e._v(" "+e._s(e.getUnitStateName(t.row.state))+" ")]}},{key:"purchase_date",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.purchase_date))+" ")]}},{key:"actions",fn:function(t){return[a("a",{staticClass:"button item-actions__button info",attrs:{target:"_blank",href:e.getFileUrl(t.row.id)}},[a("i",{staticClass:"fas fa-barcode"})]),a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/materials/"+e.material.id+"/units/"+t.row.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button info",on:{click:t}},[a("i",{staticClass:"fas fa-edit"})])]}}],null,!0)}),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"item-actions__button danger",on:{click:function(a){return e.deleteUnit(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})])]}}])})],1)},Sl=[],Ll={name:"MaterialViewUnits",props:{material:{required:!0,type:Object}},data:function(){return{deleteRequests:new Map,columns:["reference","serial_number","park","owner","is_broken","is_lost","state","purchase_date","actions"],options:{columnsDropdown:!0,preserveState:!0,orderBy:{column:"reference",ascending:!0},sortable:["reference","serial_number","is_broken","state","purchase_date","is_lost"],headings:{reference:this.$t("reference"),serial_number:this.$t("serial-number"),park:this.$t("park"),owner:this.$t("owner"),is_broken:this.$t("is-broken"),is_lost:this.$t("is-lost"),state:this.$t("state"),purchase_date:this.$t("purchase-date"),actions:""}}}},mounted:function(){this.$store.commit("setPageSubTitle",this.material.name),this.$store.dispatch("parks/fetch"),this.$store.dispatch("unitStates/fetch")},methods:{getParkName:function(e){return this.$store.getters["parks/parkName"](e)},getUnitStateName:function(e){return this.$store.getters["unitStates/unitStateName"](e)||"?"},getFileUrl:function(e){var t=_.baseUrl;return"".concat(t,"/material-units/").concat(e,"/barcode")},deleteUnit:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,ut.ConfirmDelete(t.$t,"material-units",!1);case 2:if(i=a.sent,s=i.value,s){a.next=6;break}return a.abrupt("return");case 6:if(!t.deleteRequests.has(e)){a.next=10;break}return a.next=9,t.deleteRequests.get(e);case 9:return a.abrupt("return");case 10:return a.prev=10,t.deleteRequests.set(e,t.$http.delete("material-units/".concat(e))),a.next=14,t.deleteRequests.get(e);case 14:t.$emit("outdated"),a.next=20;break;case 17:a.prev=17,a.t0=a["catch"](10),t.$emit("error",a.t0);case 20:return a.prev=20,t.deleteRequests.delete(e),a.finish(20);case 23:case"end":return a.stop()}}),a,null,[[10,17,20,23]])})))()},formatDate:function(e){return e?r()(e).format("L"):null}}},Il=Ll,Tl=(a("a10b"),Object(ge["a"])(Il,Ml,Sl,!1,null,null,null)),Al=Tl.exports,Ol=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"MaterialViewAvailabilities"},[0===e.materialEvents.length?a("div",{staticClass:"MaterialViewAvailabilities__empty"},[a("Help",{attrs:{message:"",error:e.error,isLoading:e.isLoading}}),e.isLoading?e._e():a("p",[e._v(" "+e._s(e.$t("page-materials-view.booking-periods.this-material-has-never-been-out-yet"))+" ")])],1):e._e(),e.materialEvents.length>0?a("ul",{ref:"MaterialAvailabilitiesList",staticClass:"MaterialViewAvailabilities__listing"},e._l(e.materialEvents,(function(t){return a("MaterialAvailabilitiesItem",{key:t.id,attrs:{data:t,units:e.units},on:{click:e.handleClickItem,openEvent:e.openEventModal}})})),1):e._e(),a("i",{staticClass:"fas fa-circle-notch fa-3x fa-spin MaterialViewAvailabilities__loading"}),a("Timeline",{ref:"MaterialTimeline",staticClass:"MaterialViewAvailabilities__timeline",attrs:{items:e.materialEventsTimeline,options:e.timelineOptions},on:{"double-click":e.handleDoubleClickTimeline,click:e.handleClickTimeline}})],1)},jl=[],Fl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("li",{staticClass:"MaterialAvailabilitiesItem",class:e.classnames,attrs:{role:"button","data-item-id":e.data.id},on:{click:e.handleClick}},[a("h2",{staticClass:"MaterialAvailabilitiesItem__quantity"},[e._v(" "+e._s(e.materialQuantity)+" ")]),a("div",{staticClass:"MaterialAvailabilitiesItem__quantity-text"},[e._v(" "+e._s(e.$t("into"))+" ")]),a("div",{staticClass:"MaterialAvailabilitiesItem__icon"},[a("i",{class:"fas fa-"+e.mainIcon}),e.hasWarning?a("i",{staticClass:"fas fa-exclamation-triangle"}):e._e()]),a("div",{staticClass:"MaterialAvailabilitiesItem__main"},[a("h3",{staticClass:"MaterialAvailabilitiesItem__main__title"},[e._v(" "+e._s(e.data.title)+" "),e.data.location?a("span",[e._v("("+e._s(e.data.location)+")")]):e._e()]),a("div",{staticClass:"MaterialAvailabilitiesItem__main__dates"},[e.isMultipleDayLong?a("span",[e._v(" "+e._s(e.$t("from-date-to-date",e.fromToDates))+" ")]):a("span",[e._v(" "+e._s(e.$t("on-date",{date:e.start.format("L")}))+" ")])])]),e.data.pivot.units.length>0?a("div",{staticClass:"MaterialAvailabilitiesItem__units"},[a("span",{staticClass:"MaterialAvailabilitiesItem__units__title"},[e._v(" "+e._s(e.$t("page-materials-view.booking-periods.used-units"))+" ")]),a("br"),e._v(" "+e._s(e.unitsDisplay)+" ")]):e._e(),a("div",{staticClass:"MaterialAvailabilitiesItem__readable-state"},[e.isCurrent?a("span",[a("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" "+e._s(e.$t("page-materials-view.booking-periods.currently-out"))+" ")]):e._e(),e.isPast||e.isCurrent?e._e():a("span",[a("i",{staticClass:"fas fa-binoculars"}),e._v(" "+e._s(e.$t("page-materials-view.booking-periods.expected-to-be-out-on",{date:e.start.format("L")}))+" ")]),e.isPast?a("span",[e._v(" "+e._s(e.$t("page-materials-view.booking-periods.done"))+" ")]):e._e()]),a("div",{staticClass:"MaterialAvailabilitiesItem__actions"},[a("button",{staticClass:"info",on:{click:e.handleOpenEvent}},[e._v(e._s(e.$t("open")))])])])},ql=[],Pl={name:"MaterialAvailabilitiesItem",props:{data:Object,units:Array},computed:{start:function(){return r()(this.data.start_date)},end:function(){return r()(this.data.end_date)},fromToDates:function(){return{from:this.start.format("L"),to:this.end.format("L")}},isMultipleDayLong:function(){return!this.start.isSame(this.end,"day")},isPast:function(){return this.end.isBefore(r()(),"day")},isCurrent:function(){return r()().isBetween(this.start,this.end,"day","[]")},materialQuantity:function(){return this.data.pivot.quantity},classnames:function(){return{"MaterialAvailabilitiesItem--future":!this.isPast,"MaterialAvailabilitiesItem--current":this.isCurrent,"MaterialAvailabilitiesItem--confirmed":this.data.is_confirmed}},unitsDisplay:function(){var e=this,t=this.units.filter((function(t){return e.data.pivot.units.includes(t.id)}));return t.map((function(e){return e.reference})).join(", ")},mainIcon:function(){return Ta(this.data)},hasWarning:function(){var e=this;return!!this.data.hasNotReturnedMaterials||this.units.filter((function(t){return e.data.pivot.units.includes(t.id)})).some((function(e){return e.is_broken||e.is_lost}))}},methods:{handleClick:function(){this.$emit("click",this.data.id)},handleOpenEvent:function(){this.$emit("openEvent",this.data.id)}}},Bl=Pl,Rl=(a("5bd0"),Object(ge["a"])(Bl,Fl,ql,!1,null,null,null)),Ul=Rl.exports,Nl=function(e,t,a){var i=function(e,t){return e?'<i class="fas fa-'.concat(e,'"></i> ').concat(t):t},s=La(e),n=s.title,r=s.location,o=s.startDate,l=s.endDate,c=s.pivot,u=s.hasNotReturnedMaterials,d=!1;t&&t.length>0&&(d=t.filter((function(t){return e.pivot.units.includes(t.id)})).some((function(e){return e.is_broken||e.is_lost})));var m=c.quantity,p=a("used-count",{count:m},m),h="".concat(n," (").concat(p,")");(d||u)&&(h=i("exclamation-triangle",h));var f=i(Ta(s),h),v=i("map-marker-alt",r||"?"),_=i("clock",a("from-date-to-date",{from:o.format("L"),to:l.format("L")})),b=ni(Object(g["a"])(Object(g["a"])({},s),{},{hasMissingUnits:d})).map((function(e){var t=e.icon,s=e.i18nKey;return i(t,a("page-calendar.".concat(s)))})).join("\n");return Object(g["a"])(Object(g["a"])({},s),{},{hasMissingUnits:d,content:f,start:o,end:l,editable:!1,className:ii(s).join(" "),title:["<strong>".concat(n,"</strong>, ").concat(p),"",v,_,"",b].join("\n")})},Vl=Nl,Hl=864e5,zl={name:"MaterialViewAvailabilities",components:{Help:Be,Timeline:Ya,EventDetails:Va,MaterialAvailabilitiesItem:Ul},props:{units:Array,materialName:String},data:function(){var e=r()().subtract(7,"days").startOf("day"),t=r()().add(7,"days").endOf("day");return{error:null,isLoading:!1,isModalOpened:!1,materialId:this.$route.params.id,materialEvents:[],materialEventsTimeline:[],timelineOptions:{start:e,end:t,editable:!1,locale:this.$store.state.i18n.locale,height:"100%",orientation:"top",zoomMin:7*Hl,zoomMax:60*Hl}}},mounted:function(){this.$store.commit("setPageSubTitle",this.materialName),this.getMaterialEventsData()},methods:{getMaterialEventsData:function(){var e=this;this.error=null,this.isLoading=!0,this.isModalOpened=!1,this.$http.get("materials/".concat(this.materialId,"/events")).then((function(t){var a=t.data;e.materialEvents=a.map(La),e.materialEventsTimeline=a.map((function(t){return Vl(t,e.units,e.$t)})),e.isLoading=!1})).catch((function(t){e.showError(t)}))},handleClickItem:function(e){var t=this.materialEvents.find((function(t){return t.id===e}));if(t){var a=r()(null===t||void 0===t?void 0:t.start_date);this.$refs.MaterialTimeline.moveTo(a)}},openEventModal:function(e){var t=this;this.isModalOpened=!0,this.$modal.show(Va,{eventId:e},xe,{"before-close":function(){t.getMaterialEventsData()}})},handleDoubleClickTimeline:function(e){if(!this.isModalOpened){var t=e.item;t&&this.openEventModal(t)}},handleClickTimeline:function(e){var t=e.item;if(t){var a=document.querySelector('[data-item-id="'.concat(t,'"]'));a&&this.$refs.MaterialAvailabilitiesList.scroll({top:a.offsetTop-13,behavior:"smooth"})}},showError:function(e){this.error=e,this.isLoading=!1}}},Ql=zl,Gl=(a("6f5b"),Object(ge["a"])(Ql,Ol,jl,!1,null,null,null)),Yl=Gl.exports,Wl={name:"MaterialView",components:{Tabs:pt["b"],Tab:pt["a"],Help:Be,Infos:ol,Documents:Dl,Units:Al,Availabilities:Yl},data:function(){return{help:"",error:null,isLoading:!1,tabsIndexes:["#infos","#units","#documents","#availabilities"],selectedTabIndex:0,material:{id:this.$route.params.id,attributes:[]}}},created:function(){var e=this.$route.hash;e&&this.tabsIndexes.includes(e)&&(this.selectedTabIndex=this.tabsIndexes.findIndex((function(t){return t===e})))},mounted:function(){this.$store.dispatch("categories/fetch"),this.fetchMaterial()},methods:{onSelectTab:function(e,t){this.selectedTabIndex=t,this.$router.push(this.tabsIndexes[t])},fetchMaterial:function(){var e=this,t=this.material.id;this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setMaterialData(a),e.isLoading=!1})).catch(this.displayError)},resetHelpLoading:function(){this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setMaterialData:function(e){this.material=e,this.$store.commit("setPageSubTitle",this.material.name)}}},Kl=Wl,Xl=(a("f774"),Object(ge["a"])(Kl,Yo,Wo,!1,null,null,null)),Zl=Xl.exports,Jl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Attributes"},[a("div",{staticClass:"Attributes__header header-page"},[a("button",{staticClass:"info Attributes__back-button",on:{click:e.goBack}},[a("i",{staticClass:"fas fa-arrow-left"}),e._v(" "+e._s(e.$t("page-attributes.go-back-to-material"))+" ")]),a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"Attributes__content"},[a("table",{staticClass:"Attributes__items"},[a("thead",{staticClass:"Attributes__items__header"},[a("tr",[a("th",{staticClass:"Attributes__items__name"},[e._v(" "+e._s(e.$t("page-attributes.name"))+" ")]),a("th",{staticClass:"Attributes__items__type"},[e._v(" "+e._s(e.$t("page-attributes.type"))+" ")]),a("th",{staticClass:"Attributes__items__unit"},[e._v(" "+e._s(e.$t("page-attributes.unit"))+" ")]),a("th",{staticClass:"Attributes__items__max-length"},[e._v(" "+e._s(e.$t("page-attributes.max-length"))+" ")]),a("th",{staticClass:"Attributes__items__categories",attrs:{colspan:"2"}},[e._v(" "+e._s(e.$t("page-attributes.limited-to-categories"))+" ")])])]),a("tbody",e._l(e.attributes,(function(t){return a("tr",{key:t.id,staticClass:"Attributes__items__line"},[a("td",{staticClass:"Attributes__items__name"},[e.editAttribute===t.id?a("div",{staticClass:"Attributes__items__name__content"},[a("div",{staticClass:"Attributes__items__name__text"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.editAttributeName,expression:"editAttributeName"}],staticClass:"Attributes__items__name__input",attrs:{type:"text"},domProps:{value:e.editAttributeName},on:{input:function(t){t.target.composing||(e.editAttributeName=t.target.value)}}}),e.errors.name?a("div",{staticClass:"Attributes__items__name__error"},[e._v(" "+e._s(e.errors.name[0])+" ")]):e._e()]),a("div",{staticClass:"Attributes__items__name__actions"},[a("button",{on:{click:function(t){return e.cancelAttributeName()}}},[a("i",{staticClass:"fas fa-ban"})]),a("button",{staticClass:"success",on:{click:function(a){return e.saveAttributeName(t.id)}}},[a("i",{staticClass:"fas fa-check"})])])]):a("div",{staticClass:"Attributes__items__name__content"},[a("span",{staticClass:"Attributes__items__name__text"},[e._v(e._s(t.name))]),a("div",{staticClass:"Attributes__items__name__actions"},[e.editAttribute?e._e():a("button",{staticClass:"Attributes__items__name__edit-button info",on:{click:function(a){return e.startEditAttribute(t.id,t.name)}}},[a("i",{staticClass:"fas fa-pen"})])])])]),a("td",{staticClass:"Attributes__items__type"},[e._v(" "+e._s(e.$t("page-attributes.type-"+t.type))+" ")]),a("td",{staticClass:"Attributes__items__unit"},[e._v(" "+e._s(t.unit)+" ")]),a("td",{staticClass:"Attributes__items__max-length"},[e._v(" "+e._s(t.max_length||("string"===t.type?e.$t("page-attributes.no-limit"):""))+" ")]),a("td",{staticClass:"Attributes__items__categories"},[0===t.categories.length?a("span",{staticClass:"Attributes__items__categories__empty"},[e._v(" "+e._s(e.$t("all-categories"))+" ("+e._s(e.$t("not-limited"))+") ")]):e._e(),t.categories.length>0?a("span",[e._v(" "+e._s(t.categories.map((function(e){var t=e.name;return t})).join(", "))+" ")]):e._e()]),a("td",{staticClass:"Attributes__items__delete"},[e.editAttribute?e._e():a("button",{staticClass:"Attributes__items__delete__button danger",class:{"Attributes__items__delete__button--show":e.currentlyDeleting===t.id},on:{click:function(a){return e.deleteAttribute(t.id)}}},[a("i",{staticClass:"fas fa-trash"})])])])})),0)]),e.isAddingMode||0!==e.attributes.length?e._e():a("p",{staticClass:"Attributes__no-data"},[e._v(" "+e._s(e.$t("page-attributes.no-attribute-yet"))+" ")]),a("div",{staticClass:"Attributes__add-item"},[e.isAddingMode?a("AttributeEditForm",{ref:"AttributeEditForm",attrs:{errors:e.errors}}):e._e(),a("div",{staticClass:"Attributes__actions",class:{"Attributes__actions--add":e.isAddingMode}},[e.isAddingMode?a("button",{staticClass:"success",on:{click:e.saveAttribute}},[e._v(" "+e._s(e.$t("save"))+" ")]):e._e(),a("button",{class:{success:!e.isAddingMode},on:{click:e.toggleAddingMode}},[e.isAddingMode?e._e():a("span",[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-attributes.add-btn"))+" ")]),e.isAddingMode?a("span",[e._v(" "+e._s(e.$t("cancel"))+" ")]):e._e()])])],1)])])])},ec=[],tc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("table",{staticClass:"AttributeEditForm"},[a("tr",[a("td",{staticClass:"AttributeEditForm__name"},[a("input",{ref:"InputName",staticClass:"AttributeEditForm__input",attrs:{type:"text",placeholder:e.$t("page-attributes.name")}}),e.errors.name?a("div",{staticClass:"AttributeEditForm__error",staticStyle:{"word-break":"break-all"}},[e._v(" "+e._s(e.errors.name[0])+" ")]):e._e()]),a("td",{staticClass:"AttributeEditForm__type"},[a("select",{ref:"InputType",staticClass:"AttributeEditForm__select",on:{change:e.handleTypeChange}},[a("option",{attrs:{value:"integer"}},[e._v(e._s(e.$t("page-attributes.type-integer")))]),a("option",{attrs:{value:"float"}},[e._v(e._s(e.$t("page-attributes.type-float")))]),a("option",{attrs:{value:"date"}},[e._v(e._s(e.$t("page-attributes.type-date")))]),a("option",{attrs:{value:"string"}},[e._v(e._s(e.$t("page-attributes.type-string")))]),a("option",{attrs:{value:"boolean"}},[e._v(e._s(e.$t("page-attributes.type-boolean")))])]),e.errors.type?a("ul",{staticClass:"AttributeEditForm__error"},e._l(e.errors.type,(function(t){return a("li",{key:t},[e._v(" "+e._s(t)+" ")])})),0):e._e()]),a("td",{staticClass:"AttributeEditForm__unit"},[e.hasUnit?a("input",{ref:"InputUnit",staticClass:"AttributeEditForm__input",attrs:{type:"text",placeholder:e.$t("page-attributes.unit")}}):e._e(),e.errors.unit?a("div",{staticClass:"AttributeEditForm__error"},[e._v(" "+e._s(e.errors.unit[0])+" ")]):e._e()]),a("td",{staticClass:"AttributeEditForm__max-length"},[e.hasMaxLength?a("input",{ref:"InputMaxLength",staticClass:"AttributeEditForm__input",attrs:{type:"number",placeholder:e.$t("page-attributes.max-length")}}):e._e(),e.errors.max_length?a("div",{staticClass:"AttributeEditForm__error"},[e._v(" "+e._s(e.errors.max_length[0])+" ")]):e._e()]),a("td",{staticClass:"AttributeEditForm__categories"},e._l(e.categoriesOptions,(function(t){return a("button",{key:t.value,staticClass:"AttributeEditForm__categories__item",class:{"AttributeEditForm__categories__item--selected":e.isSelected(t.value)},on:{click:function(a){return e.toggleCategory(t.value)}}},[e._v(" "+e._s(t.label)+" ")])})),0)])])},ac=[],ic={name:"AttributeEditForm",props:{errors:Object},data:function(){return{hasUnit:!0,hasMaxLength:!1,categories:[]}},computed:{categoriesOptions:function(){return this.$store.getters["categories/options"].filter((function(e){var t=e.value;return""!==t}))}},mounted:function(){this.$store.dispatch("categories/fetch")},methods:{handleTypeChange:function(e){var t=e.currentTarget.value;this.hasUnit="integer"===t||"float"===t,this.hasMaxLength="string"===t},toggleCategory:function(e){var t=this.categories.findIndex((function(t){return t===e}));-1!==t?this.categories.splice(t,1):this.categories.push(e)},isSelected:function(e){return this.categories.includes(e)},getValues:function(){var e=this.$refs,t=e.InputName,a=e.InputType,i=e.InputUnit,s=e.InputMaxLength,n=t.value,r=a.value,o=i&&i.value||null,l=s&&s.value||null,c=[];return this.categories.length<this.categoriesOptions.length&&(c=this.categories),{name:n,type:r,unit:o,max_length:l,categories:c}},reset:function(){this.$refs.InputName.value="",this.$refs.InputType.value="",this.$refs.InputUnit&&(this.$refs.InputUnit.value=""),this.$refs.InputMaxLength&&(this.$refs.InputMaxLength.value="")}}},sc=ic,nc=(a("6564"),Object(ge["a"])(sc,tc,ac,!1,null,null,null)),rc=nc.exports,oc={name:"Attributes",components:{Help:Be,AttributeEditForm:rc},data:function(){return{attributes:[],isAddingMode:!1,errors:{},help:"page-attributes.help",error:null,isLoading:!1,editAttribute:null,editAttributeName:"",currentlyDeleting:null}},mounted:function(){this.fetchAttributes()},methods:{fetchAttributes:function(){var e=this;this.isLoading=!0,this.$http.get("attributes").then((function(t){var a=t.data;e.attributes=a,e.isLoading=!1})).catch(this.displayError)},toggleAddingMode:function(){this.isAddingMode=!this.isAddingMode,this.isAddingMode||this.resetForm()},handleTypeChange:function(e){var t=e.currentTarget.value;this.hasMaxLength="string"===t,this.hasUnit="integer"===t||"float"===t},saveAttribute:function(){var e=this;this.isLoading=!0,this.error=null,this.errors={};var t=this.$refs.AttributeEditForm.getValues();this.$http.post("/attributes",t).then((function(){e.resetForm(),e.fetchAttributes()})).catch(this.displayError)},startEditAttribute:function(e,t){this.editAttributeName=t,this.editAttribute=e},cancelAttributeName:function(){this.editAttributeName="",this.editAttribute=null},saveAttributeName:function(e){var t=this;this.isLoading=!0,this.error=null,this.errors={};var a=this.editAttributeName;this.$http.put("/attributes/".concat(e),{name:a}).then((function(){t.fetchAttributes(),t.editAttribute=null,t.editAttributeName=""})).catch(this.displayError)},deleteAttribute:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.currentlyDeleting=e,a.next=3,ut.ConfirmDelete(t.$t,"attributes",!1);case 3:if(i=a.sent,s=i.value,s){a.next=8;break}return t.currentlyDeleting=null,a.abrupt("return");case 8:return a.next=10,ut.ConfirmDelete(t.$t,"attributes.second-confirm",!1);case 10:if(n=a.sent,r=n.value,r){a.next=15;break}return t.currentlyDeleting=null,a.abrupt("return");case 15:return t.error=null,t.isLoading=!0,a.prev=17,a.next=20,t.$http.delete("attributes/".concat(e));case 20:t.fetchAttributes(),a.next=26;break;case 23:a.prev=23,a.t0=a["catch"](17),t.displayError(a.t0);case 26:return a.prev=26,t.currentlyDeleting=null,a.finish(26);case 29:case"end":return a.stop()}}),a,null,[[17,23,26,29]])})))()},displayError:function(e){var t,a;this.isLoading=!1,this.error=e;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},resetForm:function(){this.errors={},this.isLoading=!1,this.isAddingMode=!1,this.$refs.AttributeEditForm.reset()},goBack:function(){$u.back()}}},lc=oc,cc=(a("0b5f"),Object(ge["a"])(lc,Jl,ec,!1,null,null,null)),uc=cc.exports,dc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Tags"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),e.validationError?a("div",{staticClass:"header-page__error"},[e._v(" "+e._s(e.validationError)+" ")]):e._e()],1),a("div",{staticClass:"header-page__actions"},[a("button",{staticClass:"Tags__create success",on:{click:function(t){return e.addTag()}}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-tags.action-add"))+" ")])])]),e.isTrashDisplayed?e._e():a("div",{staticClass:"content__main-view Tags__items"},[0===e.tags.length?a("h3",{staticClass:"Tags__empty"},[e._v(" "+e._s(e.$t("page-tags.no-item"))+" ")]):e._e(),e._l(e.tags,(function(t){return a("div",{key:t.id,staticClass:"Tags__item"},[a("span",{staticClass:"Tags__item__name"},[a("i",{staticClass:"fas fa-tag"}),e._v(" "+e._s(t.name)+" ")]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],staticClass:"Tags__edit-button info",on:{click:function(a){return e.edit(t.id,t.name)}}},[a("i",{staticClass:"fas fa-edit"})]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"Tags__edit-button warning",on:{click:function(a){return e.remove(t.id)}}},[a("i",{staticClass:"fas fa-trash"})])])}))],2),e.isTrashDisplayed?a("div",{staticClass:"content__main-view Tags__items"},[0===e.deletedTags.length?a("h3",{staticClass:"Tags__empty"},[e._v(" "+e._s(e.$t("page-tags.no-item-in-trash"))+" ")]):e._e(),e._l(e.deletedTags,(function(t){return a("div",{key:t.id,staticClass:"Tags__item Tags__item--deleted"},[a("span",{staticClass:"Tags__item__name"},[a("i",{staticClass:"fas fa-tag"}),e._v(" "+e._s(t.name)+" ")]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-restore"),expression:"$t('action-restore')"}],staticClass:"Tags__edit-button info",on:{click:function(a){return e.restore(t.id)}}},[a("i",{staticClass:"fas fa-trash-restore"})]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"Tags__edit-button danger",on:{click:function(a){return e.remove(t.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})])])}))],2):e._e(),a("div",{staticClass:"content__footer"},[a("button",{staticClass:"Tags__show-trashed",class:e.isTrashDisplayed?"info":"warning",on:{click:function(t){return e.showTrashed()}}},[e.isTrashDisplayed?e._e():a("span",[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("open-trash-bin"))+" ")]),e.isTrashDisplayed?a("span",[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("display-not-deleted-items"))+" ")]):e._e()])])])},mc=[],pc={name:"Tags",components:{Help:Be},data:function(){return{help:"page-tags.help",error:null,isLoading:!1,validationError:null,isDisplayTrashed:!1,isTrashDisplayed:!1,deletedTags:[]}},computed:{tags:function(){return this.$store.getters["tags/publicList"]},isFetched:function(){return this.$store.state.tags.isFetched}},mounted:function(){this.$store.dispatch("tags/fetch")},methods:{addTag:function(){var e=this;ut.Prompt(this.$t,"page-tags.prompt-add",{placeholder:"page-tags.tag-name",confirmText:"page-tags.create"}).then((function(t){var a=t.value;a&&e.save(null,a)}))},edit:function(e,t){var a=this;ut.Prompt(this.$t,"page-tags.prompt-modify",{placeholder:t,confirmText:"save",inputValue:t}).then((function(t){var i=t.value;i&&a.save(e,i)}))},save:function(e,t){var a=this,i=this.$route.meta.resource,s=this.$http.post,n=i;e&&(s=this.$http.put,n="".concat(i,"/").concat(e)),this.resetHelpLoading(),s(n,{name:t}).then((function(){a.help={type:"success",text:"page-tags.saved"},a.isLoading=!1,a.$store.dispatch("tags/refresh")})).catch(this.displayError)},remove:function(e){var t=this,a=!this.isTrashDisplayed;ut.ConfirmDelete(this.$t,"tags",a).then((function(a){a.value&&(t.resetHelpLoading(),t.$http.delete("tags/".concat(e)).then((function(){t.help={type:"success",text:"page-tags.deleted"},t.isLoading=!1,t.isTrashDisplayed?t.fetchDeleted():t.$store.dispatch("tags/refresh")})).catch(t.displayError))}))},restore:function(e){var t=this;ut.ConfirmRestore(this.$t,"tags").then((function(a){a.value&&(t.resetHelpLoading(),t.$http.put("".concat(t.$route.meta.resource,"/restore/").concat(e)).then((function(){t.fetchDeleted(),t.$store.dispatch("tags/refresh")})).catch(t.showError))}))},showTrashed:function(){this.isDisplayTrashed=!this.isDisplayTrashed,this.isDisplayTrashed?this.fetchDeleted():(this.$store.dispatch("tags/refresh"),this.isTrashDisplayed=!1)},fetchDeleted:function(){var e=this;this.resetHelpLoading();var t={deleted:!0};this.$http.get(this.$route.meta.resource,{params:t}).then((function(t){var a=t.data;e.deletedTags=a.data,e.isLoading=!1})).catch(this.displayError).finally((function(){e.isTrashDisplayed=e.isDisplayTrashed}))},resetHelpLoading:function(){this.help="page-tags.help",this.error=null,this.isLoading=!0,this.validationError=null},displayError:function(e){var t,a;this.help="page-tags.help",this.isLoading=!1,this.error=e,this.validationError=null;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;if(400===s&&n.name){var r=Object(T["a"])(n.name,1);this.validationError=r[0]}}}},hc=pc,fc=(a("7794"),Object(ge["a"])(hc,dc,mc,!1,null,null,null)),vc=fc.exports,_c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Technicians"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("div",{staticClass:"header-page__actions"},[a("router-link",{attrs:{to:"/technicians/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"Technicians__create success",on:{click:i}},[a("i",{staticClass:"fas fa-user-plus"}),e._v(" "+e._s(e.$t("page-technicians.action-add"))+" ")])]}}])})],1)]),a("div",{staticClass:"content__main-view"},[a("v-server-table",{ref:"DataTable",attrs:{name:"techniciansTable",columns:e.columns,options:e.options},scopedSlots:e._u([{key:"email",fn:function(t){return a("div",{},[a("a",{attrs:{href:"mailto:"+t.row.email}},[e._v(e._s(t.row.email))])])}},{key:"phone",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.phone)+" ")])}},{key:"address",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.street)),a("br"),e._v(" "+e._s(t.row.postal_code)+" "+e._s(t.row.locality)+" ")])}},{key:"note",fn:function(t){return a("div",{},[a("pre",[e._v(e._s(t.row.note))])])}},{key:"actions",fn:function(t){return a("div",{staticClass:"Technicians__actions"},[e.isTrashDisplayed?e._e():a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/technicians/"+t.row.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button info",on:{click:t}},[a("i",{staticClass:"fas fa-edit"})])]}}],null,!0)}),e.isTrashDisplayed?e._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"item-actions__button warning",on:{click:function(a){return e.deleteTechnician(t.row.id)}}},[a("i",{staticClass:"fas fa-trash"})]),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-restore"),expression:"$t('action-restore')"}],staticClass:"item-actions__button info",on:{click:function(a){return e.restoreTechnician(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-restore"})]):e._e(),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"item-actions__button danger",on:{click:function(a){return e.deleteTechnician(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})]):e._e()],1)}}])})],1),a("div",{staticClass:"content__footer"},[a("button",{staticClass:"Technicians__show-trashed",class:e.isTrashDisplayed?"info":"warning",on:{click:function(t){return e.showTrashed()}}},[e.isTrashDisplayed?e._e():a("span",[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("open-trash-bin"))+" ")]),e.isTrashDisplayed?a("span",[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("display-not-deleted-items"))+" ")]):e._e()])])])},gc=[],bc={name:"Technicians",components:{Help:Be},data:function(){var e=this;return{help:"page-technicians.help",error:null,isLoading:!1,isDisplayTrashed:!1,isTrashDisplayed:!1,columns:["last_name","first_name","nickname","email","phone","address","note","actions"],options:{columnsDropdown:!0,preserveState:!0,orderBy:{column:"last_name",ascending:!0},initialPage:this.$route.query.page||1,sortable:["last_name","first_name","nickname","email"],columnsDisplay:{note:"mobile"},headings:{last_name:this.$t("last-name"),first_name:this.$t("first-name"),nickname:this.$t("nickname"),email:this.$t("email"),phone:this.$t("phone"),address:this.$t("address"),note:this.$t("notes"),actions:""},columnsClasses:{nickname:"Technicians__nickname",email:"Technicians__email",address:"Technicians__address",note:"Technicians__note"},requestFunction:function(t){e.error=null,e.isLoading=!0;var a=Object(g["a"])(Object(g["a"])({},t),{},{tags:[_.technicianTagName],deleted:e.isDisplayTrashed?"1":"0"});return e.$http.get(e.$route.meta.resource,{params:a}).catch(e.showError).finally((function(){e.isTrashDisplayed=e.isDisplayTrashed,e.isLoading=!1}))}}}},methods:{deleteTechnician:function(e){var t=this,a=!this.isTrashDisplayed;ut.ConfirmDelete(this.$t,"technicians",a).then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.delete("".concat(t.$route.meta.resource,"/").concat(e)).then(t.refreshTable).catch(t.showError))}))},restoreTechnician:function(e){var t=this;ut.ConfirmRestore(this.$t,"technicians").then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.put("".concat(t.$route.meta.resource,"/restore/").concat(e)).then(t.refreshTable).catch(t.showError))}))},refreshTable:function(){this.help="page-technicians.help",this.error=null,this.isLoading=!0,this.$refs.DataTable.refresh()},showTrashed:function(){this.isDisplayTrashed=!this.isDisplayTrashed,this.refreshTable()},showError:function(e){this.isLoading=!1,this.error=e}}},yc=bc,kc=(a("1669"),Object(ge["a"])(yc,_c,gc,!1,null,null,null)),Cc=kc.exports,wc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"Technician"},[a("PersonForm",{attrs:{person:e.person,errors:e.errors},on:{submit:e.saveTechnician}}),a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1)])])},$c=[],Ec={name:"Technician",components:{Help:Be,PersonForm:jr},data:function(){return{help:"page-technicians.help-edit",error:null,isLoading:!1,person:{id:this.$route.params.id||null,email:"",first_name:"",last_name:"",nickname:"",phone:"",street:"",postal_code:"",locality:"",note:""},errors:{first_name:null,last_name:null,nickname:null,phone:null,street:null,postal_code:null,locality:null,note:null}}},mounted:function(){this.getTechnicianData()},methods:{getTechnicianData:function(){var e=this,t=this.person.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setPerson(a),e.isLoading=!1})).catch(this.displayError)}},saveTechnician:function(e){var t=this;e.preventDefault(),this.resetHelpLoading();var a=this.person.id,i=this.$route.meta.resource,s=this.$http.post,n=i;a&&(s=this.$http.put,n="".concat(i,"/").concat(a));var r=Object(g["a"])({},this.person);a||(r.tags=[_.technicianTagName]),s(n,r).then((function(e){var a=e.data;t.isLoading=!1,t.help={type:"success",text:"page-technicians.saved"},t.setPerson(a),setTimeout((function(){t.$router.push("/technicians")}),300)})).catch(this.displayError)},resetHelpLoading:function(){this.help="page-technicians.help-edit",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-technicians.help-edit",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setPerson:function(e){this.person=e;var t=e.full_name||"".concat(e.first_name," ").concat(e.last_name);this.$store.commit("setPageSubTitle",t)}}},xc=Ec,Dc=(a("cb24"),Object(ge["a"])(xc,wc,$c,!1,null,null,null)),Mc=Dc.exports,Sc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Categories"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),e.validationError?a("div",{staticClass:"header-page__error"},[e._v(" "+e._s(e.validationError)+" ")]):e._e()],1),a("div",{staticClass:"header-page__actions"},[a("button",{staticClass:"Categories__create success",on:{click:function(t){return e.addCategory()}}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-categories.action-add"))+" ")])])]),a("div",{staticClass:"content__main-view Categories__items"},e._l(e.categories,(function(t){return a("div",{key:t.id,staticClass:"Categories__category"},[a("div",{staticClass:"Categories__category__name"},[a("i",{staticClass:"fas fa-folder-open"}),e._v(" "+e._s(t.name)+" "),a("div",{staticClass:"Categories__category__actions"},[a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("page-categories.display-materials"),expression:"$t('page-categories.display-materials')"}],staticClass:"Categories__link-button",attrs:{to:"/materials?category="+t.id}},[a("i",{staticClass:"fas fa-eye"})]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],staticClass:"Categories__edit-button info",on:{click:function(a){return e.editCategory(t.id,t.name)}}},[a("i",{staticClass:"fas fa-edit"})]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"Categories__edit-button warning",on:{click:function(a){return e.remove("categories",t.id)}}},[a("i",{staticClass:"fas fa-trash"})])],1)]),a("div",{staticClass:"Categories__sub-categories"},[e._l(t.sub_categories,(function(i){return a("div",{key:i.id,staticClass:"Categories__sub-category"},[a("div",{staticClass:"Categories__sub-category__name"},[a("i",{staticClass:"fas fa-arrow-right"}),e._v(" "+e._s(i.name)+" "),a("div",{staticClass:"Categories__sub-category__actions"},[a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("page-subcategories.display-materials"),expression:"$t('page-subcategories.display-materials')"}],staticClass:"Categories__link-button",attrs:{to:"/materials?category="+t.id+"&subCategory="+i.id}},[a("i",{staticClass:"fas fa-eye"})]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],staticClass:"Categories__edit-button info",on:{click:function(t){return e.editSubCategory(i.id,i.name)}}},[a("i",{staticClass:"fas fa-edit"})]),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"Categories__edit-button warning",on:{click:function(t){return e.remove("subcategories",i.id)}}},[a("i",{staticClass:"fas fa-trash"})])],1)])])})),a("a",{staticClass:"Categories__add-link",on:{click:function(a){return e.addSubCategory(t.id,t.name)}}},[a("i",{staticClass:"fas fa-plus"}),e._v(" "+e._s(e.$t("page-subcategories.add"))+" ")])],2)])})),0)])},Lc=[],Ic={name:"Categories",components:{Help:Be},data:function(){return{help:"page-categories.help",error:null,isLoading:!1,validationError:null}},computed:{categories:function(){return this.$store.state.categories.list},isFetched:function(){return this.$store.state.categories.isFetched}},mounted:function(){this.$store.dispatch("categories/fetch")},methods:{addCategory:function(){var e=this;ut.Prompt(this.$t,"page-categories.prompt-add",{placeholder:"page-categories.category-name",confirmText:"page-categories.create"}).then((function(t){var a=t.value;a&&e.save("categories",null,a)}))},editCategory:function(e,t){var a=this;ut.Prompt(this.$t,"page-categories.prompt-modify",{placeholder:t,confirmText:"save",inputValue:t}).then((function(t){var i=t.value;i&&a.save("categories",e,i)}))},addSubCategory:function(e,t){var a=this;ut.Prompt(this.$t,"page-subcategories.prompt-add",{titleData:{categoryName:t},placeholder:"page-subcategories.sub-category-name",confirmText:"page-subcategories.create"}).then((function(t){var i=t.value;i&&a.saveNewSubCategory(i,e)}))},editSubCategory:function(e,t){var a=this;ut.Prompt(this.$t,"page-subcategories.prompt-modify",{placeholder:t,confirmText:"save",inputValue:t}).then((function(t){var i=t.value;i&&a.save("subcategories",e,i)}))},save:function(e,t,a){var i=this;this.resetHelpLoading();var s=this.$http.post,n=e;t&&(s=this.$http.put,n="".concat(e,"/").concat(t));var r="page-categories.saved";"subcategories"===e&&(r="page-subcategories.saved"),s(n,{name:a}).then((function(){i.isLoading=!1,i.help={type:"success",text:r},i.$store.dispatch("categories/refresh")})).catch(this.displayError)},saveNewSubCategory:function(e,t){var a=this;this.resetHelpLoading(),this.$http.post("subcategories",{name:e,category_id:t}).then((function(){a.isLoading=!1,a.help={type:"success",text:"page-subcategories.saved"},a.$store.dispatch("categories/refresh")})).catch(this.displayError)},remove:function(e,t){var a=this,i="page-categories.deleted";"subcategories"===e&&(i="page-subcategories.deleted"),ut.ConfirmDelete(this.$t,e).then((function(s){s.value&&(a.resetHelpLoading(),a.isLoading=!1,a.$http.delete("".concat(e,"/").concat(t)).then((function(){a.help={type:"success",text:i},a.$store.dispatch("categories/refresh")})).catch(a.displayError))}))},resetHelpLoading:function(){this.help="page-categories.help",this.error=null,this.isLoading=!0,this.validationError=null},displayError:function(e){var t,a;this.help="page-categories.help",this.error=e,this.isLoading=!1,this.validationError=null;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;if(400===s&&n.name){var r=Object(T["a"])(n.name,1);this.validationError=r[0]}}}},Tc=Ic,Ac=(a("b0b8"),Object(ge["a"])(Tc,Sc,Lc,!1,null,null,null)),Oc=Ac.exports,jc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content Parks"},[a("div",{staticClass:"content__header header-page"},[a("div",{staticClass:"header-page__help"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}})],1),a("div",{staticClass:"header-page__actions"},[a("router-link",{attrs:{to:"/parks/new",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{staticClass:"success",on:{click:i}},[a("i",{staticClass:"fas fa-user-plus"}),e._v(" "+e._s(e.$t("page-parks.action-add"))+" ")])]}}])}),a("router-link",{attrs:{to:"/inventories",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate;return[a("button",{on:{click:i}},[a("i",{staticClass:"fas fa-boxes"}),e._v(" "+e._s(e.$t("inventories"))+" ")])]}}])})],1)]),a("div",{staticClass:"content__main-view"},[a("v-server-table",{ref:"DataTable",attrs:{name:"ParksTable",columns:e.columns,options:e.options},scopedSlots:e._u([{key:"name",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.name)+" ")])}},{key:"address",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.street)),a("br"),e._v(" "+e._s(t.row.postal_code)+" "+e._s(t.row.locality)+" ")])}},{key:"totalItems",fn:function(t){return a("div",{},[t.row.total_items>0?a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("page-parks.display-materials-of-this-park"),expression:"$t('page-parks.display-materials-of-this-park')"}],attrs:{to:"/materials?park="+t.row.id}},[e._v(" "+e._s(e.$t("items-count",{count:t.row.total_items},t.row.total_items))+" ")]):a("span",{staticClass:"Parks__no-items"},[e._v(e._s(e.$t("no-items")))]),t.row.total_items>0?a("span",{staticClass:"Parks__total-stock"},[e._v(" ("+e._s(e.$t("stock-items-count",{count:t.row.total_stock_quantity}))+") ")]):e._e()],1)}},{key:"totalAmount",fn:function(t){return t.row.total_items>0?a("ParkTotalAmount",{attrs:{parkId:t.row.id}}):e._e()}},{key:"note",fn:function(t){return a("div",{},[a("pre",[e._v(e._s(t.row.note))])])}},{key:"events",fn:function(t){return a("div",{},[e.parksCount>1&&t.row.total_items>0?a("router-link",{attrs:{to:"/?park="+t.row.id}},[e._v(" "+e._s(e.$t("page-parks.display-events-for-park"))+" ")]):e._e()],1)}},{key:"actions",fn:function(t){return[t.row.total_stock_quantity>0?a("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("page-parks.print-materials-of-this-park"),expression:"$t('page-parks.print-materials-of-this-park')"}],staticClass:"button item-actions__button Parks__print-button",attrs:{href:e.getDownloadListingUrl(t.row.id),target:"_blank"}},[a("i",{staticClass:"fas fa-clipboard-list"})]):e._e(),a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("inventories"),expression:"$t('inventories')"}],attrs:{to:{name:"park-inventories",params:{parkId:t.row.id}},custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button",on:{click:t}},[a("i",{staticClass:"fas fa-boxes"})])]}}],null,!0)}),e.isTrashDisplayed?e._e():a("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-edit"),expression:"$t('action-edit')"}],attrs:{to:"/parks/"+t.row.id,custom:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.navigate;return[a("button",{staticClass:"item-actions__button info",on:{click:t}},[a("i",{staticClass:"fas fa-edit"})])]}}],null,!0)}),e.isTrashDisplayed?e._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-trash"),expression:"$t('action-trash')"}],staticClass:"item-actions__button warning",on:{click:function(a){return e.deletePark(t.row.id)}}},[a("i",{staticClass:"fas fa-trash"})]),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-restore"),expression:"$t('action-restore')"}],staticClass:"item-actions__button info",on:{click:function(a){return e.restorePark(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-restore"})]):e._e(),e.isTrashDisplayed?a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("action-delete"),expression:"$t('action-delete')"}],staticClass:"item-actions__button danger",on:{click:function(a){return e.deletePark(t.row.id)}}},[a("i",{staticClass:"fas fa-trash-alt"})]):e._e()]}}],null,!0)})],1),a("div",{staticClass:"content__footer"},[a("button",{staticClass:"Parks__show-trashed",class:e.isTrashDisplayed?"info":"warning",on:{click:function(t){return e.showTrashed()}}},[e.isTrashDisplayed?e._e():a("span",[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("open-trash-bin"))+" ")]),e.isTrashDisplayed?a("span",[a("i",{staticClass:"fas fa-eye"}),e._v(" "+e._s(e.$t("display-not-deleted-items"))+" ")]):e._e()])])])},Fc=[],qc=(a("b4c1"),{name:"ParkTotalAmount",props:{parkId:Number},data:function(){return{amount:null,loading:!1,error:null}},methods:{handleCalculate:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$http.get("parks/".concat(e.parkId,"/total-amount"));case 4:a=t.sent,i=a.data,e.amount=i.totalAmount,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.error=t.t0;case 12:return t.prev=12,e.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[1,9,12,15]])})))()}},render:function(){var e=arguments[0],t=this.$t,a=this.handleCalculate,i=this.loading,s=this.error,n=this.amount;return e("div",{class:"ParkTotalAmount"},[null===n&&e("button",{class:"ParkTotalAmount__calc-button",on:{click:a},attrs:{disabled:i}},[i?e("i",{class:"fas fa-spin fa-circle-notch"}):t("calculate")]),s&&e(je,{attrs:{error:s}}),null!==n&&e("div",{class:"ParkTotalAmount__amount"},[St(n)])])}}),Pc={name:"Parks",components:{Help:Be,ParkTotalAmount:qc},data:function(){var e=this;return{help:"page-parks.help",error:null,isLoading:!1,isDisplayTrashed:!1,isTrashDisplayed:!1,columns:["name","address","opening_hours","totalItems","totalAmount","note","events","actions"],options:{columnsDropdown:!0,preserveState:!0,orderBy:{column:"name",ascending:!0},initialPage:this.$route.query.page||1,sortable:["name"],columnsDisplay:{note:"mobile",totalAmount:"desktop",events:"desktop"},headings:{name:this.$t("name"),address:this.$t("address"),opening_hours:this.$t("opening-hours"),totalItems:this.$t("page-parks.total-items"),totalAmount:this.$t("total-amount"),note:this.$t("notes"),events:"",actions:""},columnsClasses:{address:"Parks__address",opening_hours:"Parks__opening-hours",totalAmount:"Parks__total-amount",note:"Parks__note",events:"Parks__events",actions:"Parks__actions"},requestFunction:function(t){e.error=null,e.isLoading=!0;var a=Object(g["a"])(Object(g["a"])({},t),{},{deleted:e.isDisplayTrashed?"1":"0"});return e.$http.get(e.$route.meta.resource,{params:a}).catch(e.showError).finally((function(){e.isTrashDisplayed=e.isDisplayTrashed,e.isLoading=!1}))}}}},computed:{parksCount:function(){return this.$store.state.parks.list.length}},mounted:function(){this.$store.dispatch("parks/fetch")},methods:{getDownloadListingUrl:function(e){var t=_.baseUrl;return"".concat(t,"/materials/pdf?park=").concat(e)},deletePark:function(e){var t=this,a=!this.isTrashDisplayed;ut.ConfirmDelete(this.$t,"parks",a).then((function(a){a.value&&t.$http.delete("".concat(t.$route.meta.resource,"/").concat(e)).then(t.refreshTable).catch(t.showError)}))},restorePark:function(e){var t=this;ut.ConfirmRestore(this.$t,"parks").then((function(a){a.value&&(t.error=null,t.isLoading=!0,t.$http.put("".concat(t.$route.meta.resource,"/restore/").concat(e)).then(t.refreshTable).catch(t.showError))}))},refreshTable:function(){this.error=null,this.isLoading=!0,this.$refs.DataTable.refresh(),this.$store.dispatch("parks/refresh")},showTrashed:function(){this.isDisplayTrashed=!this.isDisplayTrashed,this.refreshTable()},showError:function(e){this.isLoading=!1,this.error=e}}},Bc=Pc,Rc=(a("0fc2"),Object(ge["a"])(Bc,jc,Fc,!1,null,null,null)),Uc=Rc.exports,Nc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"content__main-view"},[a("div",{staticClass:"Park"},[a("form",{staticClass:"Form",attrs:{method:"POST"},on:{submit:e.savePark}},[a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("minimal-infos"))+" "),a("span",{staticClass:"FormField__label__required"},[e._v("*")])]),a("FormField",{attrs:{name:"name",label:"name",required:"",errors:e.errors.name},model:{value:e.park.name,callback:function(t){e.$set(e.park,"name",t)},expression:"park.name"}})],1),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("contact-details"))+" ")]),a("FormField",{attrs:{name:"street",label:"street",errors:e.errors.street},model:{value:e.park.street,callback:function(t){e.$set(e.park,"street",t)},expression:"park.street"}}),a("FormField",{staticClass:"Park__postal-code",attrs:{name:"postal_code",label:"postal-code",errors:e.errors.postal_code},model:{value:e.park.postal_code,callback:function(t){e.$set(e.park,"postal_code",t)},expression:"park.postal_code"}}),a("FormField",{attrs:{name:"locality",label:"city",errors:e.errors.locality},model:{value:e.park.locality,callback:function(t){e.$set(e.park,"locality",t)},expression:"park.locality"}}),a("FormField",{attrs:{name:"country_id",label:"country",type:"select",options:e.countriesOptions,errors:e.errors.country_id},model:{value:e.park.country_id,callback:function(t){e.$set(e.park,"country_id",t)},expression:"park.country_id"}})],1),a("section",{staticClass:"Form__fieldset"},[a("h4",{staticClass:"Form__fieldset__title"},[e._v(" "+e._s(e.$t("other-infos"))+" ")]),a("FormField",{attrs:{name:"opening_hours",label:"opening-hours",errors:e.errors.opening_hours},model:{value:e.park.opening_hours,callback:function(t){e.$set(e.park,"opening_hours",t)},expression:"park.opening_hours"}}),a("FormField",{attrs:{name:"note",label:"notes",type:"textarea",errors:e.errors.note},model:{value:e.park.note,callback:function(t){e.$set(e.park,"note",t)},expression:"park.note"}})],1),a("section",{staticClass:"Form__actions"},[a("button",{staticClass:"Form__actions__save success",attrs:{type:"submit"}},[e._v(" "+e._s(e.$t("save"))+" ")])])]),a("div",{staticClass:"Park__sidebar"},[a("Help",{attrs:{message:e.help,error:e.error,isLoading:e.isLoading}}),a("div",{staticClass:"Park__totals"},[a("h3",[e._v(e._s(e.$t("page-parks.total-items")))]),e.park.total_items>0?a("div",{staticClass:"Park__totals__items"},[a("strong",[e._v(" "+e._s(e.$t("items-count",{count:e.park.total_items},e.park.total_items))+" ")]),a("span",{staticClass:"Park__totals__stock"},[e._v(" ("+e._s(e.$t("stock-items-count",{count:e.park.total_stock_quantity}))+") ")]),a("br"),a("br"),a("router-link",{attrs:{to:"/materials?park="+e.park.id}},[e._v(" "+e._s(e.$t("page-parks.display-materials-of-this-park"))+" ")])],1):e._e(),e.park.total_items>0?a("div",{staticClass:"Park__totals__amount"},[a("strong",[e._v(e._s(e.$t("total-amount"))+" "+e._s(e.totalAmount))])]):a("div",{staticClass:"Park__totals__no-items"},[e._v(e._s(e.$t("no-items")))])])],1)])])])},Vc=[],Hc={name:"Material",components:{Help:Be,FormField:ze},data:function(){return{help:"page-parks.help-edit",error:null,isLoading:!1,park:{id:this.$route.params.id||null,name:"",street:"",postal_code:"",locality:"",country_id:"",total_amount:0,note:""},errors:{name:null,street:null,postal_code:null,locality:null,country_id:null}}},computed:{countriesOptions:function(){return this.$store.getters["countries/options"]},totalAmount:function(){return St(this.park.total_amount)}},mounted:function(){this.$store.dispatch("countries/fetch"),this.getParkData()},methods:{getParkData:function(){var e=this,t=this.park.id;if(t&&"new"!==t){this.resetHelpLoading();var a=this.$route.meta.resource;this.$http.get("".concat(a,"/").concat(t)).then((function(t){var a=t.data;e.setParkData(a),e.isLoading=!1})).catch(this.displayError)}},savePark:function(e){var t=this;e.preventDefault(),this.resetHelpLoading();var a=this.park.id,i=this.$route.meta.resource,s=this.$http.post,n=i;a&&(s=this.$http.put,n="".concat(i,"/").concat(a)),s(n,Object(g["a"])({},this.park)).then((function(e){var a=e.data;t.isLoading=!1,t.help={type:"success",text:"page-parks.saved"},t.setParkData(a),t.$store.dispatch("parks/refresh"),setTimeout((function(){t.$router.push("/parks")}),300)})).catch(this.displayError)},resetHelpLoading:function(){this.help="page-parks.help-edit",this.error=null,this.isLoading=!0},displayError:function(e){var t,a;this.help="page-parks.help-edit",this.error=e,this.isLoading=!1;var i=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||{code:0,details:{}},s=i.code,n=i.details;400===s&&(this.errors=Object(g["a"])({},n))},setParkData:function(e){this.park=e,this.$store.commit("setPageSubTitle",this.park.name)}}},zc=Hc,Qc=(a("6e11"),Object(ge["a"])(zc,Nc,Vc,!1,null,null,null)),Gc=Qc.exports,Yc=(a("22e9"),["categories","sub-categories","parks","flat"]),Wc={name:"EventSummarySettingsForm",props:{settings:Object,isSaving:Boolean,errors:Object},data:function(){var e=Yc.map((function(e){return{value:e,label:"page-settings.event-summary.list-display-mode-".concat(e)}}));return{initialListModeOptions:e,defaultListMode:"sub-categories"}},computed:{listModeOptions:function(){var e=this.$store.state.parks.list;return this.initialListModeOptions.filter((function(t){return"parks"!==t.value||e.length>1}))}},mounted:function(){this.$store.dispatch("parks/fetch")},methods:{handleSubmit:function(e){e.preventDefault();var t=new FormData(e.currentTarget),a=Object.fromEntries(t);this.$emit("save",a)}},render:function(){var e=arguments[0],t=this.$t,a=this.settings,i=this.listModeOptions,s=this.defaultListMode,n=this.handleSubmit,r=this.isSaving,o=this.errors;return e("form",{class:"EventSummarySettingsForm",on:{submit:n}},[e("section",{class:"EventSummarySettingsForm__section"},[e("h3",[t("page-settings.event-summary.material-list")]),e(ze,{attrs:{type:"select",label:"page-settings.event-summary.display-mode",name:"event_summary_material_display_mode",options:i,value:(null===a||void 0===a?void 0:a.event_summary_material_display_mode)||s,errors:null===o||void 0===o?void 0:o.event_summary_material_display_mode}})]),e("section",{class:"EventSummarySettingsForm__section"},[e("h3",[t("page-settings.event-summary.custom-text")]),e(ze,{attrs:{type:"text",label:"page-settings.event-summary.custom-text-title",name:"event_summary_custom_text_title",value:(null===a||void 0===a?void 0:a.event_summary_custom_text_title)||"",errors:null===o||void 0===o?void 0:o.event_summary_custom_text_title}}),e(ze,{attrs:{type:"textarea",label:"page-settings.event-summary.custom-text-content",name:"event_summary_custom_text",value:(null===a||void 0===a?void 0:a.event_summary_custom_text)||"",errors:null===o||void 0===o?void 0:o.event_summary_custom_text}})]),e("section",{class:"EventSummarySettingsForm__actions"},[e("button",{attrs:{type:"submit",disabled:r},class:"success"},[e("i",{class:"fas fa-save"})," ",t(r?"saving":"save")])])])}},Kc={name:"EventSummarySettings",data:function(){return{help:"page-settings.event-summary.help",settings:null,isLoading:!1,error:null,errors:null}},mounted:function(){this.fetchSettings()},methods:{fetchSettings:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,e.error=null,t.prev=2,t.next=5,e.$http.get("settings");case 5:a=t.sent,i=a.data,e.settings=i,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),e.error=t.t0;case 13:return t.prev=13,e.isLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[2,10,13,16]])})))()},handleSave:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r,o,l,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isLoading=!0,t.error=null,t.errors=null,a.prev=3,a.next=6,t.$http.put("settings",e);case 6:i=a.sent,s=i.data,t.settings=s,t.help={type:"success",text:"page-settings.event-summary.saved"},a.next=17;break;case 12:a.prev=12,a.t0=a["catch"](3),t.error=a.t0,o=(null===(n=a.t0.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.error)||{code:0,details:{}},l=o.code,c=o.details,400===l&&(t.errors=Object(g["a"])({},c));case 17:return a.prev=17,t.isLoading=!1,a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[3,12,17,20]])})))()}},render:function(){var e=arguments[0],t=this.help,a=this.isLoading,i=this.error,s=this.settings,n=this.handleSave,r=this.errors;return e("div",{class:"EventSummarySettings"},[e(Be,{attrs:{message:t,error:i,isLoading:a}}),e(Wc,{attrs:{settings:s,isSaving:a,errors:r},on:{save:n}})])}},Xc={name:"Settings",render:function(){var e=arguments[0],t=this.$t;return e("div",{class:"content"},[e("div",{class:"content__main-view"},[e("div",{class:"Settings"},[e(pt["b"],{class:"Settings__body"},[e("template",{slot:"event-summary"},[e("i",{class:"fas fa-print"})," ",t("page-settings.event-summary.title")]),e("template",{slot:"material-units"},[e("i",{class:"fas fa-qrcode"})," ",t("page-settings.material-units.title")]),e(pt["a"],{attrs:{"title-slot":"event-summary"}},[e(Kc)])])])])])}},Zc=(a("bf8d"),a("c6c2"),{name:"Page",props:{name:{type:String,required:!0},title:String,actions:Array,render:Function},watch:{title:function(e){this.updateTitle(e)}},mounted:function(){this.updateTitle(this.title)},beforeDestroy:function(){this.$store.commit("setPageRawTitle",null)},methods:{updateTitle:function(e){this.$store.commit("setPageRawTitle",null!==e&&void 0!==e?e:null),document.title=[e,te].filter(Boolean).join(" - ")}},render:function(){var e=arguments[0],t=this.$props,a=t.actions,i=t.render,s=i?i():this.$slots.default;return e("div",{class:"content"},[a&&a.length>0&&e("div",{class:"content__header header-page"},[e("div",{class:"header-page__help"}),e("nav",{class:"header-page__actions"},[a])]),e("div",{class:"content__main-view"},[e("div",{class:["Page","Page--".concat(this.name)]},[s])])])}}),Jc=Zc,eu=(a("66f3"),{name:"Loading",render:function(){var e=arguments[0],t=this.$t;return e("div",{class:"Loading"},[e("svg",{class:"Loading__spinner",attrs:{viewBox:"0 0 50 50"}},[e("circle",{class:"Loading__spinner__path",attrs:{cx:"25",cy:"25",r:"20",fill:"none"}})]),e("span",{class:"Loading__text"},[t("loading")])])}}),tu=eu,au=(a("3308"),{functional:!0,render(e,t){const{_c:a,_v:i,data:s,children:n=[]}=t,{class:r,staticClass:o,style:l,staticStyle:c,attrs:u={},...d}=s;return a("svg",{class:[r,o],style:[l,c],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 18 128 92"},u),...d},n.concat([a("path",{attrs:{d:"M125 96h-6V23a5 5 0 00-5-5H14a5 5 0 00-5 5v73H3a3 3 0 00-3 3c0 5.07-.32 6.21 1 7.36a14.66 14.66 0 009.7 3.66h106.64a14.66 14.66 0 009.7-3.66c1.3-1.14 1-2.3 1-7.36a3 3 0 00-3.04-3zM11 23a3 3 0 013-3h100a3 3 0 013 3v73H11zm65.49 75l-1.18 3H52.69l-1.18-3zm49.2 6.81a12.63 12.63 0 01-8.35 3.15c-116 0-108.2.41-111.52-1a12.63 12.63 0 01-3.51-2.19C1.92 104.48 2 104.6 2 99a1 1 0 011-1h46.31c1.82 4.55 1.78 5 2.69 5 25.91 0 24.58.28 25-.64L78.69 98H125a1 1 0 011 1c0 5.41.08 5.48-.31 5.83z"}}),a("path",{attrs:{d:"M112 90V26a1 1 0 00-1-1H17a1 1 0 00-1 1v64a1 1 0 001 1h94a1 1 0 001-1zm-2-1H18V27h92z"}}),a("path",{attrs:{d:"M34.72 54.72L40 49.44l5.28 5.28a1 1 0 001.44-1.44L41.44 48l5.28-5.28a1 1 0 00-1.44-1.44L40 46.56l-5.28-5.28a1 1 0 00-1.44 1.44L38.56 48l-5.28 5.28a1 1 0 001.44 1.44zM82.72 54.72L88 49.44l5.28 5.28a1 1 0 001.44-1.44L89.44 48l5.28-5.28a1 1 0 00-1.44-1.44L88 46.56l-5.28-5.28a1 1 0 00-1.44 1.44L86.56 48l-5.28 5.28a1 1 0 001.44 1.44zM48 72h32a1 1 0 000-2H48a1 1 0 000 2z"}})]))}}),iu={name:"CriticalError",props:{message:String},render:function(){var e=arguments[0],t=this.$t,a=this.message;return e("div",{class:"CriticalError"},[e(au,{class:"CriticalError__illustration"}),e("p",{class:"CriticalError__message"},[null!==a&&void 0!==a?a:t("errors.critical")]),e("a",{class:"CriticalError__refresh button",attrs:{href:""}},[t("refresh-page")])])}},su=iu,nu=(a("daef"),a("d96e")),ru=a.n(nu),ou={name:"ParkSelector",props:{list:{type:Array,required:!0},value:function(e){return"object"===Object(Pn["a"])(e)||null===e}},methods:{handleChange:function(e){var t=e.currentTarget.value;if(""===t)return this.$emit("change",null),void this.$forceUpdate();var a=this.list.find((function(e){return e.id===parseInt(t,10)}));ru()(void 0!==a,"Park inconnu relevé lors de la sélection d'un parc dans l'inventaire (`".concat(t,"`).")),this.$emit("change",null!==a&&void 0!==a?a:null),this.$forceUpdate()}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.value,s=this.list,n=function(){var n;return 0===e.list.length?t("p",{class:"ParkSelector__empty"},[t("span",{class:"ParkSelector__empty__message"},[a("page-inventories.no-parks")]),t("router-link",{attrs:{to:"/parks/new"},class:"ParkSelector__empty__button button success"},[t("i",{class:"fas fa-plus"}),a("page-inventories.add-park")])]):t(Vn["a"],[t("p",{class:"ParkSelector__intro"},[a("page-inventories.select-park-intro")]),t("select",{class:"ParkSelector__select",on:{change:e.handleChange},domProps:{value:null!==(n=null===i||void 0===i?void 0:i.id)&&void 0!==n?n:""}},[t("option",{attrs:{value:""}},[a("please-choose")]),s.map((function(e){var a=e.id,i=e.name;return t("option",{key:a,domProps:{value:a}},[i])}))])])};return t("div",{class:"ParkSelector"},[n()])}},lu=ou,cu=(a("6b9d"),a("2f44"),{functional:!0,render(e,t){const{_c:a,_v:i,data:s,children:n=[]}=t,{class:r,staticClass:o,style:l,staticStyle:c,attrs:u={},...d}=s;return a("svg",{class:[r,o],style:[l,c],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128"},u),...d},n.concat([a("path",{attrs:{fill:"currentColor",d:"M66.3 28.1c-.8-1-2.1-1.4-3.3-.9l-48 17c-.7.2-1.2.7-1.6 1.3l-12 20c-.7 1.1-.6 2.5.2 3.4.7.7 1.5 1.1 2.4 1.1.3 0 .7-.1 1-.2l48-17c.7-.2 1.2-.7 1.6-1.3l12-20c.6-1 .5-2.4-.3-3.4z"}}),a("path",{attrs:{fill:"#151717",d:"M112 47L64 30 16 47v60l48 17 48-17z"}}),a("path",{attrs:{fill:"#151717",d:"M112 47L64 30 16 47v60l48 17 48-17zm0 0L64 30"}}),a("path",{attrs:{fill:"currentColor",d:"M64 127c-.3 0-.7-.1-1-.2l-48-17c-1.2-.4-2-1.6-2-2.8V47c0-1.3.8-2.4 2-2.8l48-17c1.6-.6 3.3.3 3.8 1.8.6 1.6-.3 3.3-1.8 3.8L19 49.1v55.8l46 16.3c1.6.6 2.4 2.3 1.8 3.8-.4 1.2-1.6 2-2.8 2z"}}),a("path",{attrs:{fill:"#151717",d:"M112 47L64 30m48 17L64 30m0 34L16 47m108 20L76 84 64 64l48-17z"}}),a("path",{attrs:{fill:"currentColor",d:"M126.6 65.5l-12-20-.1-.1c0-.1-.1-.1-.1-.2s-.1-.1-.1-.2v-.1l-.2-.2-.1-.1-.1-.1h-.1l-.1-.1c-.1-.1-.2-.1-.3-.1-.1 0-.1-.1-.2-.1l-48-17c-.2-.1-.4-.1-.6-.1h-.8c-.2 0-.4.1-.6.1l-48 17c-1.2.4-2 1.6-2 2.8v60c0 1.3.8 2.4 2 2.8l48 17c.1 0 .2.1.3.1H64.8c.1 0 .2-.1.3-.1l48-17c1.2-.4 2-1.6 2-2.8V73.4l10-3.5c.8-.3 1.5-1 1.8-1.8s.1-1.9-.3-2.6zM103 47L67 59.8V34.2L103 47zm-84 4.2l42 14.9v53.6l-42-14.9V51.2zm90 53.7l-42 14.9v-45l6.4 10.7C74 86.5 75 87 76 87c.3 0 .7-.1 1-.2l32-11.3v29.4zM77.3 80.4l-8.9-14.8 42.2-15 8.9 14.8-42.2 15z"}})]))}}),uu={name:"EmptyMessage",props:{message:String,action:Object},render:function(){var e=arguments[0],t=this.$t,a=this.message,i=this.action,s=function(){if(!i)return null;var t=i.url?"router-link":"a";return e(t,{class:"EmptyMessage__action button success",on:{click:i.onClick},attrs:{to:i.url}},[i.label])};return e("div",{class:"EmptyMessage"},[e(cu,{class:"EmptyMessage__illustration"}),e("p",{class:"EmptyMessage__message"},[null!==a&&void 0!==a?a:t("empty-state")]),s()])}},du=uu,mu={name:"Inventories",props:{parkId:{type:Number,required:!0}},data:function(){var e=this;this.$createElement;return{isLoading:!0,hasCriticalError:!1,inventories:[],columns:["date","author","actions"],tableOptions:{columnsDropdown:!1,preserveState:!0,orderBy:{column:"date",ascending:!1},initialPage:1,perPage:_.defaultPaginationLimit,sortable:["date"],headings:{date:this.$t("page-inventories.date"),author:this.$t("page-inventories.author"),actions:null},columnsClasses:{actions:"Inventories__actions"},templates:{date:function(e,t){var a=t.date;return r()(a).format("L")},author:function(e,t){var a,i=t.author;return(null===i||void 0===i||null===(a=i.person)||void 0===a?void 0:a.full_name)||""},actions:function(t,a){return t("a",{attrs:{href:e.getDownloadUrl(a.id),download:!0},directives:[{name:"tooltip",value:e.$t("print")}],class:"button"},[t("i",{class:"fas fa-print"})])}}}}},computed:{isEmpty:function(){return 0===this.inventories.length}},mounted:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchData();case 2:case"end":return t.stop()}}),t)})))()},methods:{handleAddClick:function(){this.$emit("addClick")},fetchData:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.prev=1,t.next=4,e.$http.get("parks/".concat(e.parkId,"/inventories"));case 4:a=t.sent,i=a.data,e.inventories=i,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.hasCriticalError=!0;case 12:return t.prev=12,e.isLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[1,9,12,15]])})))()},getDownloadUrl:function(e){var t=_.baseUrl;return"".concat(t,"/inventories/").concat(e,"/pdf")}},render:function(){var e=arguments[0],t=this.$t,a=this.isEmpty,i=this.isLoading,s=this.hasCriticalError,n=this.inventories,r=this.columns,o=this.tableOptions,l=this.handleAddClick,c=function(){return s?e(su):i?e(tu):a?e(du,{attrs:{message:t("page-inventories.empty"),action:{label:t("page-inventories.add"),onClick:l}}}):e("v-client-table",{attrs:{name:"inventoriesTable",data:n,columns:r,options:o}})};return e("div",{class:"Inventories"},[c()])}},pu=mu,hu={name:"InventoriesPage",data:function(){return{isLoading:!0,hasError:!1,parks:[],park:null}},mounted:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("parks/fetch",!0);case 3:e.parks=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.hasError=!0;case 9:return t.prev=9,e.isLoading=!1,t.finish(9);case 12:if(e.hasError){t.next=22;break}if(!("parkId"in e.$route.params)){t.next=21;break}if(a=parseInt(e.$route.params.parkId,10),i=!!e.parks.find((function(e){return e.id===a})),i){t.next=19;break}return e.$router.replace({name:"inventories"}),t.abrupt("return");case 19:return e.setPark(a),t.abrupt("return");case 21:1===e.parks.length&&(s=e.parks.slice(0,1).shift(),e.handleParkChange(s));case 22:case"end":return t.stop()}}),t,null,[[0,6,9,12]])})))()},methods:{handleParkChange:function(e){this.$router.replace({name:"park-inventories",params:{parkId:e.id}})},handleAddClick:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.park,i=a.has_ongoing_event,s=void 0!==i&&i,n=a.has_ongoing_inventory,r=void 0!==n&&n,r||!s){t.next=7;break}return t.next=4,Ln({title:e.$t("page-inventories.underway-events-alert-title"),text:e.$t("page-inventories.underway-events-alert-text"),confirmButtonText:e.$t("page-inventories.underway-events-alert-confirm")});case 4:if(o=t.sent,o.isConfirmed){t.next=7;break}return t.abrupt("return");case 7:e.$router.push({name:"park-inventories-new",params:{parkId:e.park.id}});case 8:case"end":return t.stop()}}),t)})))()},setPark:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isLoading=!0,a.prev=1,a.next=4,t.$http.get("parks/".concat(e));case 4:i=a.sent,s=i.data,t.park=s,a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.hasError=!0;case 12:return a.prev=12,t.isLoading=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[1,9,12,15]])})))()}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.handleAddClick,s=null!==this.park?a("page-inventories.title-with-park",{park:this.park.name}):a("page-inventories.title"),n=[];null!==this.park&&n.push(t("button",{class:"button info",on:{click:i}},[t("i",{class:"fas fa-plus"})," ",a("page-inventories.add")]));var r=function(){return e.isLoading?t(tu):e.hasError?t(su):null===e.park?t(lu,{attrs:{list:e.parks},on:{change:e.handleParkChange}}):t(pu,{attrs:{parkId:e.park.id},on:{addClick:i}})};return t(Jc,{attrs:{name:"inventories",title:s,actions:n,render:r}})}},fu=hu,vu=(a("f132"),a("10b1"),{name:"InventoryPageInventory",props:{materials:{type:Array,required:!0},inventory:{type:Object,required:!0}},data:function(){var e;return{isSaving:!1,isTerminating:!1,quantities:this._normalizeQuantities(null===(e=this.inventory)||void 0===e?void 0:e.materials),saveError:null,validationErrors:[]}},watch:{inventory:function(e){this.quantities=this._normalizeQuantities(null===e||void 0===e?void 0:e.materials)},saveError:function(e){null!==e&&document.querySelector(".content").scrollTo(0,0)}},computed:{awaitedMaterials:function(){return this.materials.map((function(e){return Object(g["a"])(Object(g["a"])({},e),{},{awaited_quantity:e.stock_quantity,awaited_units:e.is_unitary?e.units:[]})}))},isEmpty:function(){return 0===this.awaitedMaterials.length}},methods:{handleChange:function(e,t){var a=this.quantities.findIndex((function(t){var a=t.id;return e===a}));a<0||this.$set(this.quantities,a,Object(g["a"])({id:e},t))},handleSave:function(){this.save()},handleTerminate:function(){this.terminate()},save:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.inventory.id,a){t.next=3;break}return t.abrupt("return");case 3:if(!e.isSaving&&!e.isTerminating){t.next=5;break}return t.abrupt("return");case 5:return e.isSaving=!0,e.saveError=null,e.validationErrors=[],t.prev=8,t.next=11,e.$http.put("inventories/".concat(a),e.quantities);case 11:i=t.sent,s=i.data,e.$emit("change",s),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](8),e._setSaveError(t.t0);case 19:return t.prev=19,e.isSaving=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[8,16,19,22]])})))()},terminate:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.inventory.id,a){t.next=3;break}return t.abrupt("return");case 3:if(!e.isSaving&&!e.isTerminating){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,Ln({title:e.$t("page-inventory.confirm-terminate-title"),text:e.$t("page-inventory.confirm-terminate-text"),confirmButtonText:e.$t("terminate-inventory")});case 7:if(i=t.sent,i.isConfirmed){t.next=10;break}return t.abrupt("return");case 10:return e.isTerminating=!0,e.saveError=null,e.validationErrors=[],t.prev=13,t.next=16,new Promise((function(e){setTimeout(e,5e3)}));case 16:return t.next=18,e.$http.put("inventories/".concat(a,"/terminate"),e.quantities);case 18:s=t.sent,n=s.data,e.$emit("finished",n),t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](13),e._setSaveError(t.t0);case 26:return t.prev=26,e.isTerminating=!1,t.finish(26);case 29:case"end":return t.stop()}}),t,null,[[13,23,26,29]])})))()},_normalizeQuantities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.materials.map((function(t){var a,i,s=e.find((function(e){var a=e.material_id;return t.id===a})),n={id:t.id,actual:null!==(a=null===s||void 0===s?void 0:s.stock_quantity_current)&&void 0!==a?a:0,broken:null!==(i=null===s||void 0===s?void 0:s.out_of_order_quantity_current)&&void 0!==i?i:0,units:[]};return t.is_unitary&&(n.units=t.units.map((function(e){var t,a,i,n=e.id,r=e.state,o=null===s||void 0===s?void 0:s.units.find((function(e){return e.material_unit_id===n})),l=null===(t=null===o||void 0===o?void 0:o.is_lost_current)||void 0===t||t,c=null!==(a=null===o||void 0===o?void 0:o.is_broken_current)&&void 0!==a&&a,u=null!==(i=null===o||void 0===o?void 0:o.state_current)&&void 0!==i?i:r;return{id:n,isBroken:c,isLost:l,state:u}}))),n}))},_setSaveError:function(e){var t,a,i,s,n=e.response;if(!n||400!==(null===n||void 0===n?void 0:n.status))return this.saveError=e,void(this.validationErrors=[]);this.saveError=new Error(this.$t("inventory-validation-error")),this.validationErrors=null!==(t=null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i||null===(s=i.error)||void 0===s?void 0:s.details)&&void 0!==t?t:[]}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.isEmpty,s=this.isSaving,n=this.isTerminating,r=this.quantities,o=this.awaitedMaterials,l=this.saveError,c=this.validationErrors,u=this.handleTerminate,d=this.handleChange,m=this.handleSave,p=["InventoryPageInventory",{"InventoryPageInventory--empty":i}],h=function(){return i?t(du,{attrs:{message:a("page-inventory.no-materials"),action:{label:a("page-inventory.add-material"),url:{name:"addMaterial",query:{parkId:e.inventory.park_id}}}}}):t(Vn["a"],[l&&t(je,{attrs:{error:e.saveError}}),t(Xn,{attrs:{locked:n,errors:c,quantities:r,materials:o},on:{change:d}}),t("footer",{class:"InventoryPageInventory__footer"},[t("button",{attrs:{type:"button",disabled:s||n},class:"InventoryPageInventory__footer__action success",on:{click:m}},[s&&t(Vn["a"],[t("i",{class:"fas fa-circle-notch fa-spin"})," ",a("saving")]),!s&&t(Vn["a"],[t("i",{class:"fas fa-save"})," ",a("save-draft")])]),t("button",{attrs:{type:"button",disabled:s||n,title:a("warning-terminate-inventory")},class:"InventoryPageInventory__footer__action info",on:{click:u}},[n&&t(Vn["a"],[t("i",{class:"fas fa-circle-notch fa-spin"})," ",a("saving")]),!n&&t(Vn["a"],[t("i",{class:"fas fa-check"})," ",a("terminate-inventory")])])])])};return t("div",{class:p},[h()])}}),_u=vu,gu=(a("f41e"),{functional:!0,render(e,t){const{_c:a,_v:i,data:s,children:n=[]}=t,{class:r,staticClass:o,style:l,staticStyle:c,attrs:u={},...d}=s;return a("svg",{class:[r,o],style:[l,c],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},u),...d},n.concat([a("path",{attrs:{fill:"#131313",d:"M10 8a4 4 0 000-8 4 4 0 000 8z"}}),a("path",{attrs:{fill:"#131313",d:"M7.5 64a3.5 3.5 0 100-7 3.5 3.5 0 100 7z"}}),a("path",{attrs:{fill:"#131313",d:"M62 20.5a4.5 4.5 0 00-4.5-4.5H44a4 4 0 010-8h2a4 4 0 000-8H22a4 4 0 000 8h2a3 3 0 110 6H10.5a3.5 3.5 0 100 7H13a3 3 0 110 6H8a5 5 0 000 10h5.5a3.5 3.5 0 110 7H9a4 4 0 000 8h8.5a2.5 2.5 0 110 5 3.5 3.5 0 100 7h30a3.5 3.5 0 100-7H47a2 2 0 110-4h7a4 4 0 000-8h-6.5a2.5 2.5 0 110-5h.5a4 4 0 000-8h-1.5a3.5 3.5 0 110-7h11a4.5 4.5 0 004.5-4.5z"}}),a("path",{attrs:{fill:"#131313",d:"M59 40a4 4 0 010-8 4 4 0 010 8z"}}),a("linearGradient",{attrs:{id:"e",x1:"32",x2:"32",y1:"6",y2:"29",gradientUnits:"userSpaceOnUse",spreadMethod:"reflect"}},[a("stop",{attrs:{offset:"0","stop-color":"#a4a4a4"}}),a("stop",{attrs:{offset:".63","stop-color":"#7f7f7f"}}),a("stop",{attrs:{offset:"1","stop-color":"#6f6f6f"}}),a("stop",{attrs:{offset:"1","stop-color":"#6f6f6f"}})]),a("path",{attrs:{fill:"url(#e)",d:"M32 6c-7.18 0-13 5.82-13 13v10h5V19c0-4.411 3.589-8 8-8s8 3.589 8 8v10h5V19c0-7.18-5.82-13-13-13z"}}),a("path",{attrs:{fill:"currentColor",d:"M49 57H15a3 3 0 01-3-3V35c0-5.523 4.477-10 10-10h20c5.523 0 10 4.477 10 10v19a3 3 0 01-3 3z"}}),a("path",{attrs:{fill:"#131313",d:"M37 39a5 5 0 00-10 0 4.998 4.998 0 003 4.578V48a2 2 0 104 0v-4.422A4.998 4.998 0 0037 39z"}})]))}}),bu={name:"InventoryLock",props:{parkId:{type:Number,required:!0}},data:function(){return{isDataLoaded:!1,hasCriticalError:!1,inventory:null}},mounted:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchData();case 2:case"end":return t.stop()}}),t)})))()},computed:{createDate:function(){var e=this.inventory.created_at;return e?r()(e).format("L LT"):null},author:function(){var e,t;return null!==(e=null===(t=this.inventory)||void 0===t?void 0:t.author)&&void 0!==e?e:null},isUnlockable:function(){var e=this.$store.state.auth.user;return!this.author||this.author.id===e.id||this.$store.getters["auth/is"]("admin")}},methods:{handleUnlock:function(){this.isUnlockable&&this.$emit("unlock")},fetchData:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/parks/".concat(e.parkId,"/inventories/ongoing"));case 3:a=t.sent,i=a.data,e.inventory=i,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.hasCriticalError=!0;case 11:return t.prev=11,e.isDataLoaded=!0,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()}},render:function(){var e=arguments[0];if(this.hasCriticalError)return e(su);if(!this.isDataLoaded)return e(tu);var t=this.$t,a=this.author,i=this.createDate,s=this.isUnlockable,n=this.handleUnlock,r=null!=a?"locked-message":"locked-message-no-author",o={author:null===a||void 0===a?void 0:a.pseudo,email:null===a||void 0===a?void 0:a.email,date:i};return e("div",{class:"InventoryLock"},[e(gu,{class:"InventoryLock__illustration"}),e("p",{class:"InventoryLock__message"},[t("page-inventory.".concat(r),o)]),s&&!!a&&e("p",{class:"InventoryLock__message"},[t("page-inventory.locked-message-unlock-warning")]),s&&e("button",{class:"InventoryLock__action button warning",on:{click:n}},[t("take-control")]),!s&&e("router-link",{class:"InventoryLock__action button",attrs:{to:{name:"park-inventories",params:{parkId:this.parkId}}}},[t("page-inventory.back-to-inventories-list")])])}},yu=bu,ku={name:"InventoryPage",data:function(){return{isDataLoaded:!1,isAlreadyLocked:!1,isLockAcquired:!1,hasCriticalError:!1,parkId:parseInt(this.$route.params.parkId,10),park:null,materials:[],inventory:null}},mounted:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchData();case 2:if(e.hasCriticalError){t.next=5;break}return t.next=5,e.acquireLock();case 5:case"end":return t.stop()}}),t)})))()},methods:{handleChange:function(e){this.inventory=e},handleFinished:function(e){this.inventory=e,this.$router.replace({name:"park-inventories",params:{parkId:this.parkId}})},handleUnlock:function(){this.acquireLock(!0)},acquireLock:function(){var e=arguments,t=this;return Object(I["a"])(regeneratorRuntime.mark((function a(){var i,s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],!t.isLockAcquired){a.next=3;break}return a.abrupt("return");case 3:return a.prev=3,s={force:i||void 0},a.next=7,t.$http.post("parks/".concat(t.parkId,"/inventories"),{},{params:s});case 7:n=a.sent,r=n.data,t.isLockAcquired=!0,t.isAlreadyLocked=!1,t.inventory=r,a.next=20;break;case 14:if(a.prev=14,a.t0=a["catch"](3),423!==a.t0.response.status){a.next=19;break}return t.isAlreadyLocked=!0,a.abrupt("return");case 19:t.hasCriticalError=!0;case 20:case"end":return a.stop()}}),a,null,[[3,14]])})))()},fetchData:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([e.$http.get("parks/".concat(e.parkId)),e.$http.get("parks/".concat(e.parkId,"/materials"))]);case 3:a=t.sent,i=Object(T["a"])(a,2),s=i[0].data,n=i[1].data,e.park=s,e.materials=n,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),e.hasCriticalError=!0;case 14:return t.prev=14,e.isDataLoaded=!0,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[0,11,14,17]])})))()}},render:function(){var e=this,t=arguments[0],a=this.$t,i=this.materials,s=this.park,n=this.parkId,r=this.inventory,o=this.handleUnlock,l=this.handleChange,c=this.handleFinished,u=function(){return e.hasCriticalError?t(su):e.isAlreadyLocked?t(yu,{attrs:{parkId:n},on:{unlock:o}}):e.isDataLoaded&&e.isLockAcquired?t(_u,{attrs:{inventory:r,materials:i},on:{change:l,finished:c}}):t(tu)},d=null!==s?a("page-inventory.title-with-park",{park:s.name}):a("page-inventory.title");return t(Jc,{attrs:{name:"inventory",title:d,render:u}})}},Cu=ku;s["default"].use(ee["a"]);var wu=new ee["a"]({mode:"history",routes:[{path:"/login",name:"login",component:ye,meta:{requiresAuth:!1}},{path:"/profile",name:"user-profile",component:We,meta:{resource:"users",title:"page-profile.title",requiresAuth:!0,requiresGroups:["admin","member","visitor"]}},{path:"/user-settings",name:"user-settings",component:tt,meta:{resource:"users",title:"page-user-settings.title",requiresAuth:!0,requiresGroups:["admin","member","visitor"]}},{path:"/",name:"calendar",component:mi,meta:{resource:"events",title:"page-calendar.title",requiresAuth:!0,requiresGroups:["admin","member","visitor"]}},{path:"/events/new",name:"addEvent",component:Dn,meta:{resource:"events",title:"page-events.add",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/events/:id",name:"editEvent",component:Dn,meta:{resource:"events",title:"page-events.edit",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/event-return/:id",name:"eventReturnMaterial",component:ir,meta:{resource:"events",title:"page-event-return.title",readableName:"page-event-return.title",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/users",name:"users",component:cr,meta:{resource:"users",title:"page-users.title",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/users/new",name:"addUser",component:kr,meta:{resource:"users",title:"page-users.add",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/users/:id",name:"editUser",component:kr,meta:{resource:"users",title:"page-users.edit",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/beneficiaries",name:"beneficiaries",component:Dr,meta:{resource:"persons",title:"page-beneficiaries.title",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/beneficiaries/new",name:"addBeneficiary",component:Br,meta:{resource:"persons",title:"page-beneficiaries.add",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/beneficiaries/:id",name:"editBeneficiary",component:Br,meta:{resource:"persons",title:"page-beneficiaries.edit",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/companies/new",name:"addCompany",component:Qr,meta:{resource:"companies",title:"page-companies.add",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/companies/:id",name:"editCompany",component:Qr,meta:{resource:"companies",title:"page-companies.edit",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/materials/:materialId/units/new",name:"addMaterialUnit",component:Go,meta:{title:"page-material-units.add",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/materials/:materialId/units/:id",name:"editMaterialUnit",component:Go,meta:{title:"page-material-units.edit",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/materials",name:"materials",component:go,meta:{resource:"materials",title:"page-materials.title",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/materials/new",name:"addMaterial",component:Ro,meta:{resource:"materials",title:"page-materials.add",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/materials/:id",name:"editMaterial",component:Ro,meta:{resource:"materials",title:"page-materials.edit",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/materials/:id/view",name:"viewMaterial",component:Zl,meta:{resource:"materials",title:"page-materials-view.title",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/attributes",name:"attributes",component:uc,meta:{resource:"attributes",title:"page-attributes.title",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/categories",name:"categories",component:Oc,meta:{resource:"categories",title:"page-categories.title",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/technicians",name:"technicians",component:Cc,meta:{resource:"persons",title:"page-technicians.title",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/technicians/new",name:"addTechnician",component:Mc,meta:{resource:"persons",title:"page-technicians.add",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/technicians/:id",name:"editTechnician",component:Mc,meta:{resource:"persons",title:"page-technicians.edit",requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/tags",name:"tags",component:vc,meta:{resource:"tags",title:"page-tags.title",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/inventories",name:"inventories",component:fu,meta:{requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/parks",name:"parks",component:Uc,meta:{resource:"parks",title:"page-parks.title",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/parks/new",name:"addPark",component:Gc,meta:{resource:"parks",title:"page-parks.add",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/parks/:id",name:"editPark",component:Gc,meta:{resource:"parks",title:"page-parks.edit",requiresAuth:!0,requiresGroups:["admin"]}},{path:"/parks/:parkId(\\d+)/inventories",name:"park-inventories",component:fu,meta:{requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/parks/:parkId(\\d+)/inventories/new",name:"park-inventories-new",component:Cu,meta:{requiresAuth:!0,requiresGroups:["admin","member"]}},{path:"/settings",name:"settings",component:Xc,meta:{resource:"settings",title:"page-settings.title",readableName:"page-settings.title",requiresAuth:!0,requiresGroups:["admin"]}},{path:"*",redirect:"/"}]});wu.beforeEach((function(e,t,a){var i=!1,n=e.matched.reduce((function(e,t){var a=t.meta;return null==a.requiresAuth?e:!!a.requiresAuth||!(null===e&&!a.requiresAuth)&&e}),null),r=e.matched[0].meta,o=r.title,l=r.requiresGroups;if(o){var c=s["default"].i18n.translate(o,{pageSubTitle:""});document.title="".concat(c," − ").concat(te)}else document.title=te;var u=U.getters["auth/isLogged"];if(!n||u){if(!n)return!1===n&&u?void a("/"):void a();if(l&&l.length){if(!u)return void a("/login");var d=U.state.auth.user.groupId;l.includes(d)||(i=!0)}i?U.dispatch("auth/logout").then((function(){a({path:"/login",hash:"restricted"})})):a()}else a("/login")})),wu.afterEach((function(e){var t=e.name,a=e.matched;if("login"!==t){var i=a[0].meta.title;U.commit("setPageTitle",null!==i&&void 0!==i?i:"")}}));var $u=wu,Eu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"main"},[e.isLogged?a("MainHeader",{on:{toggleMenu:e.toggleSideNav}}):e._e(),a("div",{staticClass:"main__body"},[e.isLogged?a("SideNav",{attrs:{isOpen:e.isOpenedSideNav}}):e._e(),a("router-view",{key:e.$route.path})],1)],1)])},xu=[],Du=(a("65bb"),a("ebc6"),{name:"TopMenu",computed:{pseudo:function(){return this.$store.state.auth.user.pseudo}},methods:{logout:function(){var e=this;this.$store.dispatch("auth/logout").then((function(){e.$router.replace({path:"/login",hash:"bye"})}))}},render:function(){var e=arguments[0],t=this.$t,a=this.pseudo,i=this.logout;return e("div",{class:"TopMenu"},[e(Fa,[e("template",{slot:"buttonText"},[t("hello-pseudo",{pseudo:a})]),e("template",{slot:"items"},[e("router-link",{attrs:{to:"/profile",custom:!0}},[function(a){var i=a.navigate,s=a.isActive;return e("li",{on:{click:i},class:ja(s)},[e("i",{class:"fas fa-user-alt"})," ",t("your-profile")])}]),e("router-link",{attrs:{to:"/user-settings",custom:!0}},[function(a){var i=a.navigate,s=a.isActive;return e("li",{on:{click:i},class:ja(s)},[e("i",{class:"fas fa-cogs"})," ",t("your-settings")])}]),e("li",{class:"Dropdown__item",on:{click:i}},[e("i",{class:"fas fa-power-off"})," ",t("logout-quit")])])])])}}),Mu={name:"MainHeader",computed:{pageTitle:function(){var e=this.$store.state,t=e.pageTitle,a=e.pageSubTitle,i=void 0===a?"":a,s=e.pageRawTitle;return null!==s?s:this.$t(t,{pageSubTitle:i})}},watch:{pageTitle:function(){this.$emit("toggleMenu",!1)}},methods:{toggleMenu:function(){this.$emit("toggleMenu","toggle")}},render:function(){var e=arguments[0],t=this.pageTitle,a=this.toggleMenu;return e("div",{class:"MainHeader"},[e("div",{class:"MainHeader__logo"},[e(he,{attrs:{minimalist:!0}})]),e("div",{class:"MainHeader__menu-toggle",on:{click:a}},[e("i",{class:"fas fa-bars fa-2x"})]),e("div",{class:"MainHeader__title"},[t]),e(Du,{class:"MainHeader__menu"})])}},Su=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"SideNav",class:{"SideNav--opened":e.isOpen}},[a("div",{staticClass:"SideNav__logo"},[a("Logo",{attrs:{minimalist:""}})],1),a("SideMenu",{staticClass:"SideNav__menu"}),a("div",{staticClass:"SideNav__footer"},[e._v(" © 2017-"+e._s(e.year)),a("br"),e._v(" v. "+e._s(e.apiVersion)+" ")])],1)},Lu=[],Iu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"SideMenu"},[a("router-link",{attrs:{to:"/",exact:"",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-calendar-alt"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-calendar.title")))])])]}}])}),e.isAdmin||e.isMember?a("router-link",{attrs:{to:"/materials",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-box"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-materials.title")))])])]}}],null,!1,25090697)}):e._e(),e.isAdmin||e.isMember?a("router-link",{attrs:{to:"/technicians",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-people-carry"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-technicians.title")))])])]}}],null,!1,1354310682)}):e._e(),e.isAdmin||e.isMember?a("router-link",{attrs:{to:"/beneficiaries",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-address-book"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-beneficiaries.title")))])])]}}],null,!1,997980499)}):e._e(),e.isAdmin?a("router-link",{attrs:{to:"/categories",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-sitemap"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-categories.title")))])])]}}],null,!1,1728881317)}):e._e(),e.isAdmin?a("router-link",{attrs:{to:"/tags",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-tags"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-tags.title")))])])]}}],null,!1,2681517316)}):e._e(),e.isAdmin?a("router-link",{attrs:{to:"/parks",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-industry"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-parks.title")))])])]}}],null,!1,1473083429)}):e._e(),e.isAdmin?a("router-link",{attrs:{to:"/users",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-users-cog"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("page-users.title")))])])]}}],null,!1,1732644290)}):e._e(),e.isAdmin?a("router-link",{attrs:{to:"/settings",custom:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.navigate,s=t.isActive;return[a("li",{staticClass:"SideMenu__item",class:{"SideMenu__item--active":s},on:{click:i}},[a("i",{staticClass:"fas fa-sliders-h"}),a("br"),a("span",{staticClass:"SideMenu__item__title"},[e._v(e._s(e.$t("settings")))])])]}}],null,!1,3084128738)}):e._e()],1)},Tu=[],Au={name:"SideMenu",computed:{isAdmin:function(){return this.$store.getters["auth/is"]("admin")},isMember:function(){return this.$store.getters["auth/is"]("member")}}},Ou=Au,ju=(a("268d"),Object(ge["a"])(Ou,Iu,Tu,!1,null,null,null)),Fu=ju.exports,qu={name:"SideNav",props:{isOpen:Boolean},components:{SideMenu:Fu,Logo:he},data:function(){var e=(new Date).getFullYear(),t=_.api.version;return{year:e,apiVersion:t}}},Pu=qu,Bu=(a("ca61"),Object(ge["a"])(Pu,Su,Lu,!1,null,null,null)),Ru=Bu.exports,Uu={name:"App",components:{MainHeader:Mu,SideNav:Ru},data:function(){return{isOpenedSideNav:!1}},created:function(){var e=this;this.$http.interceptors.response.use((function(e){return e}),(function(t){var a=t.response||{status:0},i=a.status;return 401===i&&e.$store.dispatch("auth/logout").then((function(){e.$router.replace({path:"/login",hash:"expired"}).catch((function(){}))})),Promise.reject(t)}))},watch:{$route:function(){s["default"].prototype.$modal.hide("defaultModal")}},computed:{isLogged:function(){return this.$store.getters["auth/isLogged"]}},methods:{toggleSideNav:function(e){this.isOpenedSideNav="toggle"!==e?e:!this.isOpenedSideNav}}},Nu=Uu,Vu=(a("5c0b"),Object(ge["a"])(Nu,Eu,xu,!1,null,null,null)),Hu=Vu.exports;a("7ddb");a("15f5"),s["default"].config.productionTip=!1,s["default"].prototype.$http=x,s["default"].use(c.a,{dialog:!0,dynamic:!0,dynamicDefaults:{}}),u["a"].options.defaultContainer="#app",u["a"].options.disposeTimeout=1e3,u["a"].options.defaultDelay=100,s["default"].directive("tooltip",u["a"]),s["default"].use(o["a"].plugin,U),Object.keys(K).forEach((function(e){s["default"].i18n.add(e,K[e])}));var zu=_.defaultLang;s["default"].i18n.set(zu);var Qu=localStorage.getItem("userLocale");Qu&&s["default"].i18n.localeExists(Qu)&&(s["default"].i18n.set(Qu),zu=Qu),s["default"].i18n.fallback(zu),r.a.locale(zu);var Gu={columnsClasses:{actions:"VueTables__actions"},sortIcon:{base:"fas",up:"fa-sort-up",down:"fa-sort-down",is:"fa-sort"},texts:J[zu],requestKeys:{query:"search"},perPage:_.defaultPaginationLimit,perPageValues:[_.defaultPaginationLimit],responseAdapter:function(e){if(!e)return{data:[],count:0};var t=e.data,a=t.data,i=t.pagination;return{data:a,count:i?i.total:0}}};s["default"].use(d["ClientTable"],Gu),s["default"].use(d["ServerTable"],Gu,!0),U.dispatch("auth/fetch").then((function(){new s["default"]({el:"#app",store:U,router:$u,components:{App:Hu},template:"<App/>"})}))},"56e7":function(e,t,a){"use strict";a("4d37")},5857:function(e,t,a){},"5ac8":function(e,t,a){},"5afa":function(e,t,a){"use strict";a("ce8b")},"5b9a":function(e,t,a){"use strict";a("c194")},"5bd0":function(e,t,a){"use strict";a("42db")},"5bf9":function(e,t,a){},"5c0b":function(e,t,a){"use strict";a("9c0c")},"5f98":function(e,t,a){"use strict";a("60f9")},"60f9":function(e,t,a){},"61c1":function(e,t,a){"use strict";a("1815")},6348:function(e,t,a){},6564:function(e,t,a){"use strict";a("09db")},6580:function(e,t,a){},"65bb":function(e,t,a){},"66f3":function(e,t,a){},"69fa":function(e,t,a){},"6aae":function(e,t,a){"use strict";a("53c4")},"6b9d":function(e,t,a){},"6bf3":function(e,t,a){},"6c54":function(e,t,a){},"6e11":function(e,t,a){"use strict";a("1afd")},"6e2a":function(e,t,a){},"6ead":function(e,t,a){},"6f18":function(e,t,a){"use strict";a("4f3e")},"6f5b":function(e,t,a){"use strict";a("b6e4")},"6f91":function(e,t,a){},"704a":function(e,t,a){"use strict";a("0e51")},"756f":function(e,t,a){},"75db":function(e,t,a){"use strict";a("a549")},7794:function(e,t,a){"use strict";a("6348")},"79bd":function(e,t,a){},"7f15":function(e,t,a){"use strict";a("15d2")},"7f42":function(e,t,a){},"7fa5":function(e,t,a){},8866:function(e,t,a){},"88fc":function(e,t,a){},"8a72":function(e,t,a){},"8d7f":function(e,t,a){"use strict";a("55e1")},"8ed0":function(e,t,a){"use strict";a("4e8b")},9041:function(e,t,a){},9264:function(e,t,a){},9353:function(e,t,a){},9598:function(e,t,a){},"95a4":function(e,t,a){"use strict";a("5321")},"95f8":function(e,t,a){"use strict";a("5ac8")},"9c0c":function(e,t,a){},a10b:function(e,t,a){"use strict";a("b710")},a245:function(e,t,a){"use strict";a("5100")},a370:function(e,t,a){},a549:function(e,t,a){},a77e:function(e,t,a){},a8d7:function(e,t,a){"use strict";a("a77e")},a993:function(e,t,a){"use strict";a("9598")},ae27:function(e,t,a){"use strict";a("2475")},b0b8:function(e,t,a){"use strict";a("42f0")},b0bc:function(e,t,a){"use strict";a("fd39")},b3cc:function(e,t,a){},b3f1:function(e,t,a){},b4c1:function(e,t,a){},b574:function(e,t,a){"use strict";a("79bd")},b6e4:function(e,t,a){},b710:function(e,t,a){},bf6b:function(e,t,a){e.exports=a.p+"img/logo-R.svg"},bf8d:function(e,t,a){},c194:function(e,t,a){},c5a4:function(e,t,a){},c6c2:function(e,t,a){},c6d1:function(e,t,a){},ca61:function(e,t,a){"use strict";a("cd50")},cb24:function(e,t,a){"use strict";a("43fc")},cd50:function(e,t,a){},ce8b:function(e,t,a){},d0bc:function(e,t,a){"use strict";a("7fa5")},d928:function(e,t,a){},da3a:function(e,t,a){},daef:function(e,t,a){},dbf0:function(e,t,a){},de23:function(e,t,a){},de98:function(e,t,a){"use strict";a("1087")},e3e6:function(e,t,a){"use strict";a("9353")},e517:function(e,t,a){},ebc6:function(e,t,a){},ebe1:function(e,t,a){},ec09:function(e,t,a){},ed21:function(e,t,a){},ef5b:function(e,t,a){"use strict";a("1eb7")},f0d4:function(e,t,a){"use strict";a("da3a")},f132:function(e,t,a){},f1b2:function(e,t,a){},f41e:function(e,t,a){},f44c:function(e,t,a){},f4b6:function(e,t,a){},f59e:function(e,t,a){"use strict";a("3010")},f774:function(e,t,a){"use strict";a("0816")},f8c6:function(e,t,a){"use strict";a("d928")},f974:function(e,t,a){"use strict";a("a370")},fbc1:function(e,t,a){},fd39:function(e,t,a){}});